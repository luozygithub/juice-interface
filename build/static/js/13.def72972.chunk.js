(this["webpackJsonp@jbox/app"]=this["webpackJsonp@jbox/app"]||[]).push([[13],{1174:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(261),o=n(0),r=n(662),c=n(136);function s({contract:e,functionName:t,args:n,updateOn:s,formatter:l,callback:d,valueDidChange:j}){const[u,b]=Object(o.useState)(),[O,x]=Object(o.useState)(!0),{contracts:p}=Object(o.useContext)(i.a),m=Object(o.useCallback)((e=>l?l(e):e),[l]),v=Object(o.useCallback)((e=>d?d(e):e),[d]),h=Object(o.useCallback)(((e,t)=>j?j(e,t):e!==t),[j]);return Object(r.a)((()=>{async function i(){const i=a(e,p);if(console.info(i,t,n,e,p),i&&t&&null!==n)try{console.info("\ud83d\udcda Read >",t),x(!0);const e=await i[t](...null!==n&&void 0!==n?n:[]),o=m(e);h(u,o)&&(console.info("\ud83d\udcd7 New >",t,{args:n},{newValue:o},{contract:i.address}),b(o),v(o))}catch(o){console.error("\ud83d\udcd5 Read error >",t,{args:n},{err:o},{contract:i.address},p),c.a(o,{tags:{contract:"string"===typeof e?e:void 0,contract_function:t}}),b(m(void 0)),v(m(void 0))}finally{x(!1)}}i();const o=()=>i(),r=[];if(null!==s&&void 0!==s&&s.length)try{s.forEach((e=>{var t;const n=a(e.contract,p);if(!e.eventName||!n)return;const i=n.filters[e.eventName](...null!==(t=e.topics)&&void 0!==t?t:[]);null===n||void 0===n||n.on(i,o),r.push({contract:n,filter:i})}))}catch(l){console.error("Read contract >",{functionName:t,error:l})}return()=>r.forEach((e=>e.contract.off(e.filter,o)))}),[e,p,t,s,n,m,v,h]),{data:u,loading:O}}function a(e,t){if(e)return"string"===typeof e?t?t[e]:void 0:e}},1207:function(e,t,n){"use strict";n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return v}));var i=n(180),o=n(16),r=n(53),c=n(86),s=n(619),a=n(11),l=n(519),d=n(182);const j=e=>Boolean((null===e||void 0===e?void 0:e.distributionLimit)&&!Object(a.f)(e.distributionLimit).eq(d.c)),u=e=>Boolean((null===e||void 0===e?void 0:e.duration)&&"0"!==(null===e||void 0===e?void 0:e.duration));function b(e){return e[0]}const O=e=>Boolean(e.toNumber()),x=[{name:"version",bits:8,parser:e=>e.toNumber()},{name:"global",bits:16,parser:e=>({allowSetTerminals:O(o.a.from(e).shr(1)),allowSetController:O(o.a.from(e).shr(2))})},{name:"reservedRate",bits:16},{name:"redemptionRate",bits:16,parser:c.c},{name:"ballotRedemptionRate",bits:16,parser:c.c},{name:"pausePay",bits:1,parser:O},{name:"pauseDistributions",bits:1,parser:O},{name:"pauseRedeem",bits:1,parser:O},{name:"pauseBurn",bits:1,parser:O},{name:"allowMinting",bits:1,parser:O},{name:"allowChangeToken",bits:1,parser:O},{name:"allowTerminalMigration",bits:1,parser:O},{name:"allowControllerMigration",bits:1,parser:O},{name:"holdFees",bits:1,parser:O},{name:"useTotalOverflowForRedemptions",bits:1,parser:O},{name:"useDataSourceForPay",bits:1,parser:O},{name:"useDataSourceForRedeem",bits:1,parser:O},{name:"dataSource",bits:0,parser:e=>{const t=e.toHexString();return t===o.a.from("0").toHexString()?i.a:Object(r.getAddress)(t)}}],p=e=>x.reduce(((t,n,i)=>{var o,r;const c=16===n.bits?65535:8===n.bits?255:1===n.bits?1:0,s=0===i?0:x.slice(0,i).reduce(((e,t)=>e+t.bits),0);let a;return a=0===c?e.shr(s):e.shr(s).and(c),{...t,[n.name]:null!==(o=null===(r=n.parser)||void 0===r?void 0:r.call(n,a))&&void 0!==o?o:a}}),{}),m=e=>{var t;const n=p(e.metadata),i=Object(l.a)(e.ballot).address,o=parseFloat(Object(a.e)(null===n||void 0===n?void 0:n.reservedRate)),r=Boolean(null===n||void 0===n?void 0:n.allowMinting);return Object(s.a)({ballotAddress:i,reservedRatePercentage:o,hasFundingDuration:null===(t=e.duration)||void 0===t?void 0:t.gt(0),allowMinting:r})},v=e=>Object.values(m(e)).filter((e=>!0===e)).length},1269:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="0x000000000000000000000000000000000000eeee"},1330:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(324),o=n(1269),r=n(1174);function c({projectId:e,configuration:t,terminal:n,useDeprecatedContract:c}){return Object(r.a)({contract:c?i.a.DeprecatedJBController:i.a.JBController,functionName:"distributionLimitOf",args:e&&t&&n?[e,t,n,o.a]:null})}},1331:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return a}));var i=n(182);function o({percent:e,amount:t}){return e/100*parseFloat(t)}function r({amount:e,distributionLimit:t}){return Object(i.t)(e/t*100).toNumber()}function c(e){return e.reduce(((e,t)=>e+Object(i.q)(t.percent)),0)}function s({splits:e,oldDistributionLimit:t,newDistributionLimit:n}){const c=[];return e.forEach((e=>{const s=r({amount:o({percent:Object(i.q)(e.percent),amount:t}),distributionLimit:parseFloat(n)}),a={beneficiary:e.beneficiary,percent:s,preferClaimed:e.preferClaimed,lockedUntil:e.lockedUntil,projectId:e.projectId,allocator:e.allocator};null===c||void 0===c||c.push(a)})),c}function a({editingSplitPercent:e,newSplitAmount:t,currentDistributionLimit:n}){const r=o({percent:Object(i.q)(e),amount:n}),c=parseFloat(n)-r+t;return parseFloat(c.toFixed(4))}},1355:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={placement:"right",width:Math.min(640,.9*window.innerWidth)}},1356:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(324),o=n(517),r=n.n(o),c=n(0),s=n(1174);function a({projectId:e,splitGroup:t,domain:n,useDeprecatedContract:o}){return Object(s.a)({contract:o?i.a.DeprecatedJBSplitsStore:i.a.JBSplitsStore,functionName:"splitsOf",args:e&&n?[e,n,t]:null,formatter:Object(c.useCallback)((e=>(null!==e&&void 0!==e?e:[]).map((e=>({percent:e.percent.toNumber(),lockedUntil:e.lockedUntil.toNumber(),projectId:e.projectId.toHexString(),beneficiary:e.beneficiary,allocator:e.allocator,preferClaimed:e.preferClaimed})))),[]),valueDidChange:Object(c.useCallback)(((e,t)=>!r()(e,t)),[])})}},1357:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n(16),o=n(180),r=n(11),c=n(182);const s=e=>{var t;return{percent:Object(c.t)(parseFloat(Object(r.l)(e.percent))).toNumber(),lockedUntil:e.lockedUntil,beneficiary:e.beneficiary,projectId:null===(t=e.projectId)||void 0===t?void 0:t.toHexString(),allocator:e.allocator,preferClaimed:e.preferUnstaked}},a=e=>({percent:Object(r.j)(Object(c.o)(i.a.from(e.percent))).toNumber(),lockedUntil:e.lockedUntil,beneficiary:e.beneficiary,projectId:e.projectId?i.a.from(e.projectId):void 0,allocator:e.allocator,preferUnstaked:e.preferClaimed}),l=e=>{var t,n,r;return{lockedUntil:null!==(t=e.lockedUntil)&&void 0!==t?t:0,projectId:null!==(n=e.projectId)&&void 0!==n?n:i.a.from(0).toHexString(),beneficiary:null!==(r=e.beneficiary)&&void 0!==r?r:o.a,allocator:o.a,preferClaimed:!1,percent:e.percent}}},1426:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n(182),o=n(3),r=n(975),c=n(511),s=n(101),a=n(13),l=n(0),d=n(82),j=n(78),u=n(51),b=n(11),O=n(16),x=n(47),p=n(358),m=n(129),v=n(85),h=n(264),f=n(222),y=n(1);function g({split:e,showSplitValue:t,currency:n,totalValue:g,projectOwnerAddress:C,valueSuffix:k,valueFormatProps:w,reservedRate:S}){const{theme:{colors:T}}=Object(l.useContext)(a.a),I=C===e.beneficiary,R=!!e.projectId&&O.a.from(e.projectId).gt(0),P=({lockedUntil:e})=>{const t=Object(d.a)(1e3*e,"yyyy-MM-DD");return Object(y.jsxs)("div",{style:{fontSize:".8rem",color:T.text.secondary},children:[Object(y.jsx)(r.a,{})," ",Object(y.jsx)(o.b,{id:"locked until {lockedUntilFormatted}",values:{lockedUntilFormatted:t}})]})},E=Object(m.a)()?"0.9rem":"unset",D=()=>Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{style:{fontWeight:500},children:[Object(y.jsx)(s.a,{title:Object(y.jsx)(o.b,{id:"Juicebox V2 project with ID {0}",values:{0:e.projectId}}),children:Object(y.jsxs)(v.b,{to:Object(f.a)({projectId:e.projectId}),target:"_blank",className:"text-primary hover-text-action-primary hover-text-decoration-underline",children:["@",e.projectId]})}),":"]}),Object(y.jsxs)("div",{style:{fontSize:".8rem",color:T.text.secondary,marginLeft:10},children:[Object(y.jsx)(j.a,{label:Object(y.jsx)(o.b,{id:"Tokens:"}),tip:Object(y.jsx)(o.b,{id:"This address will receive any tokens minted when the recipient project gets paid."})})," ",Object(y.jsx)(u.a,{address:e.beneficiary})," ",I&&Object(y.jsx)(s.a,{title:Object(y.jsx)(o.b,{id:"Project owner"}),children:Object(y.jsx)(c.a,{})})]})]}),L=()=>Object(y.jsxs)("div",{style:{fontWeight:500,fontSize:E,display:"flex",alignItems:"baseline"},children:[e.beneficiary?Object(y.jsx)(u.a,{address:e.beneficiary}):null,!e.beneficiary&&I?Object(y.jsx)(o.b,{id:"Project owner (you)"}):null,I&&Object(y.jsx)("span",{style:{marginLeft:5},children:Object(y.jsx)(s.a,{title:Object(y.jsx)(o.b,{id:"Project owner"}),children:Object(y.jsx)(c.a,{})})}),":"]}),A=()=>{const t=null===g||void 0===g?void 0:g.mul(e.percent).div(i.f),o=Object(b.b)(t,{...w});return Object(y.jsxs)("span",{style:{fontSize:E},children:["(",Object(y.jsx)(x.a,{currency:Object(p.b)(null===n||void 0===n?void 0:n.toNumber())}),o,k?Object(y.jsxs)("span",{children:[" ",k]}):null,")"]})},F=Object(i.o)(O.a.from(e.percent));return Object(y.jsxs)("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",marginBottom:5},children:[Object(y.jsxs)("div",{style:{lineHeight:1.4},children:[Object(y.jsx)("div",{style:{display:"flex",alignItems:"baseline"},children:R?Object(y.jsx)(D,{}):Object(y.jsx)(L,{})}),e.lockedUntil?Object(y.jsx)(P,{lockedUntil:e.lockedUntil}):null]}),Object(y.jsxs)("div",{children:[Object(y.jsxs)("span",{children:[F,"%"]}),null!==g&&void 0!==g&&g.gt(0)&&t?Object(y.jsxs)("span",{style:{marginLeft:"0.2rem"},children:[" ",Object(y.jsx)(A,{})]}):null,S?Object(y.jsx)(h.a,{iconStyle:{marginLeft:7},tip:Object(y.jsx)(o.b,{id:"{0}% of all newly minted tokens.",values:{0:S*parseFloat(F)/100}})}):null]})]})}function C({splits:e,showSplitValues:t=!1,currency:n,totalValue:o,projectOwnerAddress:r,valueSuffix:c,valueFormatProps:s,reservedRate:a}){var l;const d=null!==(l=null===e||void 0===e?void 0:e.reduce(((e,t)=>e+t.percent),0))&&void 0!==l?l:0,j=i.f-d;return Object(y.jsxs)("div",{children:[[...e].sort(((e,t)=>e.percent<t.percent?1:-1)).map((e=>Object(y.jsx)("div",{style:{marginBottom:5},children:Object(y.jsx)(g,{split:e,showSplitValue:t,currency:n,totalValue:o,projectOwnerAddress:r,valueSuffix:c,valueFormatProps:s,reservedRate:a})},`${e.beneficiary}-${e.percent}`))),j?Object(y.jsx)(g,{split:{beneficiary:r,percent:j,preferClaimed:void 0,lockedUntil:void 0,projectId:void 0,allocator:void 0},showSplitValue:t,currency:n,totalValue:o,projectOwnerAddress:r,valueSuffix:c,valueFormatProps:s,reservedRate:a}):null]})}},1427:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(3),o=n(7),r=n(106),c=n(181),s=n(90),a=n(73),l=n(272),d=n(363),j=n(1);function u({form:e,onFinish:t,hideProjectHandle:n=!1,saveButton:u,style:b,loading:O,onValuesChange:x}){return Object(j.jsx)(r.a,{scrollToFirstError:{behavior:"smooth"},form:e,layout:"vertical",onFinish:t,style:b,onValuesChange:()=>null===x||void 0===x?void 0:x(),children:Object(j.jsxs)(c.b,{direction:"vertical",size:"large",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)(a.a.ProjectName,{name:"name",formItemProps:{rules:[{required:!0}]},onChange:t=>{const n=t?Object(l.a)(t):"";e.setFieldsValue({handle:n})}}),!n&&Object(j.jsx)(a.a.ProjectHandleFormItem,{name:"handle",initialValue:e.getFieldValue("handle"),requireState:"notExist",formItemProps:{dependencies:["name"],extra:o.a._("Project handle must be unique.")},required:!0}),Object(j.jsx)(a.a.ProjectDescription,{name:"description"}),Object(j.jsx)(a.a.ProjectLogoUri,{name:"logoUri",initialUrl:e.getFieldValue("logoUri"),onSuccess:t=>{e.setFieldsValue({logoUri:t})}})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:Object(j.jsx)(i.b,{id:"Links"})}),Object(j.jsx)(a.a.ProjectLink,{name:"infoUri"}),Object(j.jsx)(a.a.ProjectTwitter,{name:"twitter"}),Object(j.jsx)(a.a.ProjectDiscord,{name:"discord"})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:Object(j.jsx)(i.b,{id:"Project page customizations"})}),Object(j.jsx)(a.a.ProjectPayButton,{name:"payButton"}),Object(j.jsx)(a.a.ProjectPayDisclosure,{name:"payDisclosure"})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)(r.a.Item,{children:null!==u&&void 0!==u?u:Object(j.jsx)(s.a,{htmlType:"submit",loading:O,type:"primary",children:Object(j.jsx)("span",{children:Object(j.jsx)(i.b,{id:"Save project details"})})})}),Object(j.jsx)(d.a,{children:Object(j.jsx)(i.b,{id:"You can edit your project details after creation at any time, but the transaction will cost gas."})})]})]})})}},1428:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(3),o=n(7),r=n(510),c=n(1);function s({visible:e,onOk:t,onCancel:n}){return Object(c.jsx)(r.a,{title:o.a._("Unsaved changes"),okText:o.a._("Discard"),visible:e,onOk:t,onCancel:n,destroyOnClose:!0,children:Object(c.jsx)(i.b,{id:"You have unsaved changes. Are you sure you want to discard them?"})})}},1429:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(969),o=n(1355),r=n(1);function c({title:e,visible:t,onClose:n,children:c}){return Object(r.jsxs)(i.a,{...o.a,visible:t,onClose:n,destroyOnClose:!0,children:[Object(r.jsx)("h1",{children:e}),c]})}},1480:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=0},1481:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="juicebox_project_id"},1482:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(261),o=n(0);function r(){const[e,t]=Object(o.useState)(),{contracts:n}=Object(o.useContext)(i.a);return Object(o.useEffect)((()=>{!async function(){const e=await(null===n||void 0===n?void 0:n.JBETHPaymentTerminal.functions.fee());e&&t(e[0])}()}),[n]),e}},1483:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var i=n(3),o=n(7),r=n(16),c=n(510),s=n(106),a=n(2848),l=n(711),d=n(1126),j=n(98),u=n(632),b=n(47),O=n(73),x=n(157),p=n(108),m=n(97),v=n(196),h=n(264),f=n(78),y=n(13),g=n(1482),C=n(325),k=n(127),w=n.n(k),S=n(0),T=n(11),I=n(91),R=n(1331),P=n(182),E=n(180),D=n(1);function L({visible:e,mode:t,overrideDistTypeWithPercentage:n=!1,splits:k,editingSplit:L,onSplitsChanged:A,distributionLimit:F,setDistributionLimit:N,onClose:B,currencyName:M,onCurrencyChange:_}){var H;const{theme:{colors:V}}=Object(S.useContext)(y.a),[U]=Object(j.useForm)(),J=Object(S.useMemo)((()=>!F||Object(T.f)(F).eq(P.c)),[F]),z=Object(S.useMemo)((()=>!k.length||1===k.length&&void 0!==L),[L,k.length]),[W,q]=Object(S.useState)("address"),[G,Y]=Object(S.useState)(J?"percent":"amount"),[$,X]=Object(S.useState)(),[K,Q]=Object(S.useState)(),[Z,ee]=Object(S.useState)(),[te,ne]=Object(S.useState)(),ie=Object(g.a)(),oe=ie?Object(P.k)(ie):void 0;Object(S.useEffect)((()=>U.setFieldsValue({projectId:$,lockedUntil:te}))),Object(S.useEffect)((()=>{"address"===W&&(U.setFieldsValue({projectId:void 0}),X(void 0))}),[W,U]),Object(S.useEffect)((()=>{Y(n||J?"percent":"amount")}),[J,n,e]),Object(S.useEffect)((()=>{if(!L)return;q("address");var e;L.projectId&&!r.a.from(L.projectId).eq(r.a.from(E.a))&&(q("project"),X(null===(e=L.projectId)||void 0===e?void 0:e.toString()));if(ne(L.lockedUntil?w.a(1e3*L.lockedUntil):void 0),U.setFieldsValue({beneficiary:L.beneficiary,percent:Object(P.q)(L.percent)}),J)ee(Object(R.b)({percent:Object(P.q)(L.percent),amount:null!==F&&void 0!==F?F:"0"}));else if(F){const e=L.percent,t=Object(R.b)({percent:Object(P.q)(e),amount:F});ee(t)}else ee(void 0)}),[F,J,L,U,e]);const re=()=>{X(void 0),ee(void 0),ne(void 0)},ce=async()=>{await U.validateFields();const e=te?Math.round(te.valueOf()/1e3):void 0,n={beneficiary:U.getFieldValue("beneficiary"),percent:Object(P.t)(U.getFieldValue("percent")).toNumber(),lockedUntil:e,preferClaimed:!0,projectId:$,allocator:void 0};let i=k;K&&!J&&(i=Object(R.a)({splits:k,oldDistributionLimit:null!==F&&void 0!==F?F:"0",newDistributionLimit:K}),null===N||void 0===N||N(K));const o="Edit"===t?i.map((e=>e.beneficiary===(null===L||void 0===L?void 0:L.beneficiary)&&e.projectId===(null===L||void 0===L?void 0:L.projectId)?{...e,...n}:e)):[...i,n];null===A||void 0===A||A(o),re(),U.resetFields(),B()},se=()=>{var e;return Object(x.e)(Object(P.q)(null!==(e=U.getFieldValue("percent"))&&void 0!==e?e:0))},ae=Z?Z-Z*parseFloat(null!==oe&&void 0!==oe?oe:"0")/100:void 0;function le(){return ae&&ae>0?Object(D.jsx)(f.a,{label:Object(D.jsx)(i.b,{id:"<0/>{0} after {feePercentage}% JBX membership fee",values:{0:Object(C.round)(ae,4),feePercentage:oe},components:{0:Object(D.jsx)(b.a,{currency:M})}}),tip:Object(D.jsx)(i.b,{id:"Payouts to Ethereum addresses incur a {feePercentage}% fee. Your project will receive JBX in return at the current issuance rate.",values:{feePercentage:oe}})}):null}return Object(D.jsx)(c.a,{title:"Edit"===t?o.a._("Edit payout"):o.a._("Add new payout"),visible:e,onOk:ce,okText:"Edit"===t?o.a._("Save payout"):o.a._("Add payout"),onCancel:()=>{re(),U.resetFields(),B()},destroyOnClose:!0,children:Object(D.jsxs)(s.a,{form:U,layout:"vertical",scrollToFirstError:{behavior:"smooth"},onKeyDown:e=>{"Enter"===e.key&&ce()},children:[Object(D.jsx)(s.a.Item,{label:o.a._("Recipient"),children:Object(D.jsxs)(a.a.Group,{value:W,onChange:e=>q(e.target.value),children:[Object(D.jsx)(a.a,{value:"address",style:{fontWeight:400},children:Object(D.jsx)(i.b,{id:"Wallet address"})}),Object(D.jsx)(a.a,{value:"project",style:{fontWeight:400},children:Object(D.jsx)(i.b,{id:"Juicebox project"})})]})}),"address"===W?Object(D.jsx)(O.a.EthAddress,{name:"beneficiary",defaultValue:U.getFieldValue("beneficiary"),formItemProps:{label:o.a._("Address"),rules:[{validator:()=>{const e=U.getFieldValue("beneficiary");return(null===L||void 0===L?void 0:L.beneficiary)===e?Promise.resolve():Object(x.d)(null!==e&&void 0!==e?e:"",k,t,Object(C.findIndex)(k,(e=>e.beneficiary===(null===L||void 0===L?void 0:L.beneficiary)&&e.projectId===(null===L||void 0===L?void 0:L.projectId))))}}],required:!0},onAddressChange:e=>U.setFieldsValue({beneficiary:e})}):Object(D.jsx)(s.a.Item,{name:"projectId",rules:[{validator:()=>Object(I.d)(U.getFieldValue("projectId"))?Promise.resolve():Promise.reject(o.a._("Project ID must be a number."))}],label:o.a._("Juicebox Project ID"),required:!0,children:Object(D.jsx)(l.a,{value:parseInt(null!==$&&void 0!==$?$:""),style:{width:"100%"},placeholder:o.a._("ID"),onChange:e=>{X(null===e||void 0===e?void 0:e.toString())}})}),"project"===W?Object(D.jsx)(O.a.EthAddress,{name:"beneficiary",defaultValue:U.getFieldValue("beneficiary"),formItemProps:{label:o.a._("Token beneficiary address"),required:!0,extra:o.a._("The address that should receive the tokens minted from paying this project.")},onAddressChange:e=>{U.setFieldsValue({beneficiary:e})}}):null,F&&"amount"===G?Object(D.jsx)(s.a.Item,{className:"ant-form-item-extra-only",label:o.a._("Distribution"),required:!0,extra:oe&&U.getFieldValue("percent")<=100?Object(D.jsx)(D.Fragment,{children:"address"===W?Object(D.jsx)("div",{children:Object(D.jsx)(le,{})}):Object(D.jsx)(i.b,{id:"Distributing funds to Juicebox projects won't incur fees."})}):null,children:Object(D.jsxs)("div",{style:{display:"flex",color:V.text.primary,alignItems:"center"},children:[Object(D.jsx)(m.a,{value:null===Z||void 0===Z?void 0:Z.toFixed(4),placeholder:"0",onChange:e=>(e=>{var n;if(J||!e)return;const i=Object(R.d)({currentDistributionLimit:null!==F&&void 0!==F?F:"0",newSplitAmount:e,editingSplitPercent:"Add"===t?0:null!==(n=null===L||void 0===L?void 0:L.percent)&&void 0!==n?n:0}),o=Object(R.c)({amount:e,distributionLimit:i});Q(i.toString()),ee(e),U.setFieldsValue({percent:Object(P.q)(o)})})(parseFloat(e||"0")),formItemProps:{rules:[{validator:se}],required:!0},accessory:z&&_?Object(D.jsx)(u.a,{onCurrencyChange:_,currency:M}):Object(D.jsx)(p.a,{content:M})}),Object(D.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:10},children:[Object(D.jsx)(i.b,{id:"{0}%",values:{0:U.getFieldValue("percent")}}),Object(D.jsx)(h.a,{tip:Object(D.jsx)(i.b,{id:"If you don't raise the sum of all your payouts (<0/>{distributionLimit}), this address will receive {0}% of all the funds you raise.",values:{0:U.getFieldValue("percent"),distributionLimit:F},components:{0:Object(D.jsx)(b.a,{currency:M})}}),placement:"topLeft",iconStyle:{marginLeft:5}})]})]})}):Object(D.jsx)(s.a.Item,{children:Object(D.jsx)("div",{style:{display:"flex",alignItems:"center"},children:Object(D.jsx)("span",{style:{flex:1},children:Object(D.jsx)(v.a,{onChange:e=>{U.setFieldsValue({percent:e})},step:.01,defaultValue:0,sliderValue:null!==(H=U.getFieldValue("percent"))&&void 0!==H?H:0,suffix:"%",name:"percent",formItemProps:{rules:[{validator:se}]}})})})}),Object(D.jsx)(s.a.Item,{name:"lockedUntil",label:o.a._("Lock until"),extra:Object(D.jsx)(i.b,{id:"If locked, this split can't be edited or removed until the lock expires or the funding cycle is reconfigured."}),children:Object(D.jsx)(d.a,{disabledDate:e=>e&&e<w()().endOf("day"),onChange:e=>ne(e)})})]})})}},1484:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(0);function o(e){const[t,n]=Object(i.useState)(!1),[o,r]=Object(i.useState)(!1),c=e,s=()=>n(!0),a=Object(i.useCallback)((()=>{if(!o)return c();s()}),[o,c]);return{emitDrawerClose:c,formUpdated:o,setFormUpdated:r,unsavedChangesModalVisible:t,openModal:s,closeModal:()=>n(!1),handleDrawerCloseClick:a}}},1697:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(152),o=n(324),r=n(0),c=n(1174);function s(e){const{isPreviewMode:t}=Object(r.useContext)(i.a);return Object(c.a)({contract:o.a.JBProjects,functionName:"ownerOf",args:e&&!t?[e]:null})}},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(324),o=n(1174);function r({projectId:e,useDeprecatedContract:t}){return Object(o.a)({contract:t?i.a.DeprecatedJBDirectory:i.a.JBDirectory,functionName:"terminalsOf",args:e?[e]:null})}},1699:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(324),o=n(1174);function r({projectId:e,useDeprecatedContract:t}){return Object(o.a)({contract:t?i.a.DeprecatedJBController:i.a.JBController,functionName:"currentFundingCycleOf",args:e?[e]:null})}},1700:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"l",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return y})),n.d(t,"b",(function(){return g})),n.d(t,"j",(function(){return C})),n.d(t,"h",(function(){return k})),n.d(t,"a",(function(){return w})),n.d(t,"i",(function(){return S})),n.d(t,"d",(function(){return T})),n.d(t,"k",(function(){return I}));var i=n(3),o=n(7),r=n(1133),c=n(47),s=n(78),a=n(11),l=n(182),d=n(250),j=n(466),u=n(526),b=n(1426),O=n(519),x=n(165),p=n(1);function m({distributionLimit:e,currencyName:t,showDetail:n}){const d=e&&!e.eq(l.c);return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Distribution limit"),tip:o.a._("The maximum amount of funds allowed to be distributed from the project's treasury each funding cycle.")}),valueRender:()=>d?e.eq(0)?Object(p.jsx)("span",{children:n?Object(p.jsx)(i.b,{id:"Distribution limit is 0: All funds will be considered overflow and can be redeemed by token holders."}):Object(p.jsx)(i.b,{id:"Zero"})}):Object(p.jsxs)("span",{children:[Object(p.jsx)(c.a,{currency:t}),Object(a.b)(e)," "]}):Object(p.jsx)("span",{children:n?Object(p.jsx)(i.b,{id:"Distribution limit is infinite. <0>The project will control how all funds are distributed, and none can be redeemed by token holders.</0>",components:{0:Object(p.jsx)("p",{style:{fontSize:"1rem"}})}}):Object(p.jsx)(i.b,{id:"Infinite (no limit)"})})})}function v({duration:e,showWarning:t}){const n=Object(j.b)({timeSeconds:null===e||void 0===e?void 0:e.toNumber()}),i=null===e||void 0===e?void 0:e.gt(0);return Object(p.jsx)(r.a,{title:o.a._("Duration"),valueRender:()=>Object(p.jsx)(d.a,{showWarning:t,tooltipTitle:Object(x.a)().duration,children:i?n:o.a._("Not set")})})}function h({reservedRate:e,reservedPercentage:t}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Reserved tokens"),tip:Object(p.jsx)(i.b,{id:"Amount of newly minted project tokens <0>reserved for the project</0> when 1 ETH is contributed. Reserve tokens are reserved for the project owner by default, but can also be allocated to other wallet addresses by the owner.",components:{0:Object(p.jsx)("strong",{})}})}),value:`${e} (${t}`,suffix:Object(p.jsx)(d.a,{showWarning:t>x.b,tooltipTitle:Object(x.a)().metadataReservedRate,children:"%)"})})}function f({issuanceRate:e,isInitial:t}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:t?o.a._("Initial issuance rate"):o.a._("Contributor rate"),tip:o.a._("Contributors will be rewarded this amount of your project's tokens per ETH contributed.")}),value:o.a._("{issuanceRate} tokens / ETH",{issuanceRate:e})})}function y({inflationRate:e,isInitial:t}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:t?o.a._("Initial mint rate"):o.a._("Mint rate"),tip:Object(p.jsx)(i.b,{id:"<0>Total project tokens minted</0> when 1 ETH is contributed. This can change over time according to the discount rate and reserved tokens amount of future funding cycles.",components:{0:Object(p.jsx)("strong",{})}})}),value:o.a._("{inflationRate} tokens / ETH",{inflationRate:e})})}function g({discountRate:e}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Discount rate"),tip:u.a}),value:Object(l.j)(e),suffix:"%"})}function C({redemptionRate:e}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Redemption rate"),tip:u.b}),value:Object(l.m)(e),suffix:"%"})}function k({pausePay:e}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Payments paused"),tip:e?o.a._("Project is not accepting payments this funding cycle."):o.a._("Project is accepting payments this funding cycle.")}),value:e?o.a._("Yes"):o.a._("No")})}function w({allowMinting:e}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Allow token minting"),tip:e?o.a._("Owner can mint tokens at any time."):o.a._("Owner is not allowed to mint tokens.")}),valueRender:()=>Object(p.jsxs)(d.a,{showWarning:e,tooltipTitle:Object(x.a)().allowMinting,children:[e?o.a._("Allowed"):o.a._("Disabled")," "]})})}function S({ballotAddress:e}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Reconfiguration rules"),tip:o.a._("How long before your next funding cycle must you reconfigure in order for changes to take effect.")}),valueRender:()=>{const t=Object(O.a)(e);return Object(p.jsx)(d.a,{showWarning:!t.durationSeconds||0===t.durationSeconds,tooltipTitle:Object(x.a)().ballot,children:Object(p.jsxs)("div",{children:[t.name," ",Object(p.jsx)("div",{style:{fontSize:"0.7rem"},children:t.address})]})})}})}function T({splits:e,currency:t,totalValue:n,projectOwnerAddress:c,showSplitValues:a,fundingCycleDuration:l}){const d=Object(j.b)({timeSeconds:null===l||void 0===l?void 0:l.toNumber(),fullWords:!0}),u=null===l||void 0===l?void 0:l.gt(0);return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Payouts"),tip:Object(p.jsx)(i.b,{id:"Available funds can be distributed according to the payouts below{0}.",values:{0:u?` every ${d}`:null}})}),valueRender:()=>Object(p.jsx)(b.a,{splits:e,currency:t,totalValue:n,projectOwnerAddress:c,showSplitValues:a})})}function I({splits:e,reservedPercentage:t,projectOwnerAddress:n}){return Object(p.jsx)(r.a,{title:Object(p.jsx)(s.a,{label:o.a._("Reserved token allocation"),tip:o.a._("How the {reservedPercentage}% of your project's reserved tokens will be split.",{reservedPercentage:t})}),valueRender:()=>Object(p.jsx)(b.a,{splits:e,projectOwnerAddress:n,totalValue:void 0})})}},1701:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(324),o=n(1174);function r({terminal:e,projectId:t}){return Object(o.a)({contract:i.a.JBSingleTokenPaymentTerminalStore,functionName:"currentOverflowOf",args:e&&t?[e,t]:null})}},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(324),o=n(1174);function r({projectId:e}){return Object(o.a)({contract:i.a.JBTokenStore,functionName:"tokenOf",args:e?[e]:null})}},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i=n(3),o=n(47),r=n(11),c=n(182),s=n(264),a=n(0),l=n(13),d=n(1);function j({distributionLimit:e,currencyName:t,showTooltip:n}){const{theme:{colors:j}}=Object(a.useContext)(l.a),u=null===e||void 0===e?void 0:e.eq(c.c),b=null===e||void 0===e?void 0:e.eq(0),O=n?Object(d.jsx)(s.a,{tip:u?Object(d.jsx)(i.b,{id:"All funds received by the treasury will be distributed. Token holders will receive <0>no ETH</0> when burning their tokens.",components:{0:Object(d.jsx)("strong",{})}}):b?Object(d.jsx)(i.b,{id:"No funds can be distributed out of the treasury. Funds can only be accessed by token holders redeeming their tokens."}):Object(d.jsx)(i.b,{id:"If you don't raise this amount, your splits will receive their percentage of whatever you raise."}),placement:"topLeft",iconStyle:{marginLeft:5}}):null,x=u?Object(d.jsx)(i.b,{id:"No limit (infinite)"}):b?Object(d.jsx)(i.b,{id:"Zero"}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(o.a,{currency:t}),Object(r.b)(e)]});return Object(d.jsxs)("span",{style:{color:j.text.primary},children:[x,O]})}},1704:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var i=n(3),o=n(7),r=n(181),c=n(964),s=n(705),a=n(101),l=n(90),d=n(13),j=n(0),u=n(11),b=n(51),O=n(16),x=n(82),p=n(511),m=n(975),v=n(702),h=n(152),f=n(182),y=n(47),g=n(1331),C=n(264),k=n(1483),w=n(1);const S=({withParens:e=!1,children:t})=>e?Object(w.jsxs)(w.Fragment,{children:["(",t,")"]}):Object(w.jsx)(w.Fragment,{children:t});function T({split:e,splits:t,distributionLimit:n,currencyName:T,isLocked:I,isProjectOwner:R,editInputMode:P,onSplitsChanged:E,onSplitDelete:D,setDistributionLimit:L,onCurrencyChange:A}){var F,N,B,M;const{theme:{colors:_,radii:H}}=Object(j.useContext)(d.a),{projectOwnerAddress:V}=Object(j.useContext)(h.a),[U,J]=Object(j.useState)(!1),z=parseInt(null!==(F=e.projectId)&&void 0!==F?F:"0")>0,W=V===e.beneficiary&&!z||R,q=!n||Object(u.f)(n).eq(f.c),G=e.percent!==f.f&&(null===(N=(e.percent/f.f).toString().split(".")[1])||void 0===N?void 0:N.length)>4,Y=I?"default":"pointer";return Object(w.jsxs)("div",{style:{display:"flex",padding:10,border:"1px solid "+(I?_.stroke.disabled:_.stroke.tertiary),borderRadius:H.md},children:[Object(w.jsxs)(r.b,{direction:"vertical",style:{width:"100%",color:_.text.primary,cursor:Y},onClick:I?void 0:()=>J(!0),children:[e.projectId&&parseInt(e.projectId)>0?Object(w.jsxs)(c.a,{gutter:10,style:{width:"100%"},align:"middle",children:[Object(w.jsxs)(s.a,{span:9,children:[Object(w.jsx)("label",{style:{cursor:Y},children:Object(w.jsx)(i.b,{id:"Project ID:"})})," "]}),Object(w.jsx)(s.a,{span:15,children:Object(w.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:Object(w.jsx)("span",{style:{cursor:Y},children:e.projectId})})})]}):Object(w.jsxs)(c.a,{gutter:10,style:{width:"100%"},align:"middle",children:[Object(w.jsxs)(s.a,{span:9,children:[Object(w.jsx)("label",{style:{cursor:Y},children:Object(w.jsx)(i.b,{id:"Address:"})})," "]}),Object(w.jsx)(s.a,{span:15,children:Object(w.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[W&&!e.beneficiary?Object(w.jsx)("span",{style:{cursor:Y},children:Object(w.jsx)(i.b,{id:"Project owner (you)"})}):Object(w.jsx)("span",{style:{cursor:"pointer"},children:Object(w.jsx)(b.a,{address:e.beneficiary})}),W&&Object(w.jsx)(a.a,{title:o.a._("Project owner"),children:Object(w.jsx)(p.a,{})})]})})]}),parseInt(null!==(B=e.projectId)&&void 0!==B?B:"0")>0?Object(w.jsxs)(c.a,{children:[Object(w.jsx)(s.a,{span:9,children:Object(w.jsx)("label",{style:{cursor:Y},children:Object(w.jsx)(i.b,{id:"Token beneficiary:"})})}),Object(w.jsx)(s.a,{span:15,children:Object(w.jsx)("span",{style:{cursor:"pointer"},children:Object(w.jsx)(b.a,{address:e.beneficiary})})})]}):null,Object(w.jsxs)(c.a,{gutter:10,style:{width:"100%"},align:"middle",children:[Object(w.jsx)(s.a,{span:9,children:Object(w.jsx)("label",{style:{cursor:Y},children:q?Object(w.jsx)(i.b,{id:"Percentage:"}):Object(w.jsx)(i.b,{id:"Amount:"})})}),Object(w.jsx)(s.a,{span:15,children:Object(w.jsx)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center"},children:Object(w.jsx)("span",{style:{marginRight:10,width:100,maxWidth:100},children:Object(w.jsxs)(r.b,{size:"small",direction:"horizontal",children:[!q&&Object(w.jsxs)("span",{children:[Object(w.jsx)(y.a,{currency:T}),parseFloat(Object(g.b)({percent:Object(f.q)(e.percent),amount:n}).toFixed(4))]}),Object(w.jsx)("span",{children:Object(w.jsxs)(S,{withParens:!q,children:[G?"~":null,Object(f.o)(O.a.from(e.percent)),"%"]})})]})})})})]}),e.lockedUntil?Object(w.jsxs)(c.a,{gutter:10,style:{width:"100%"},align:"middle",children:[Object(w.jsx)(s.a,{span:9,children:Object(w.jsx)("label",{style:{cursor:Y},children:Object(w.jsx)(i.b,{id:"Locked:"})})}),Object(w.jsxs)(s.a,{span:15,children:["until ",Object(x.a)(1e3*(null!==(M=e.lockedUntil)&&void 0!==M?M:0),"yyyy-MM-DD")]})]}):null]}),I?Object(w.jsx)(w.Fragment,{children:W?Object(w.jsx)(C.a,{iconStyle:{paddingTop:"4px"},tip:Object(w.jsx)(i.b,{id:"You have configured for all funds to be distributed from the treasury. Your current payouts do not sum to 100%, so the remainder will go to the project owner."})}):Object(w.jsx)(a.a,{title:Object(w.jsx)(i.b,{id:"Payout is locked"}),children:Object(w.jsx)(m.a,{style:{color:_.icon.disabled,paddingTop:"4px"}})})}):Object(w.jsx)(a.a,{title:Object(w.jsx)(i.b,{id:"Delete payout"}),children:Object(w.jsx)(l.a,{type:"text",onClick:t=>{null===D||void 0===D||D(e),t.stopPropagation()},icon:Object(w.jsx)(v.a,{}),style:{height:16}})}),I?null:Object(w.jsx)(k.a,{visible:U,overrideDistTypeWithPercentage:"Percentage"===P,onSplitsChanged:E,mode:"Edit",splits:t,editingSplit:e,distributionLimit:n,setDistributionLimit:L,onClose:()=>J(!1),currencyName:T,onCurrencyChange:A})]})}},1705:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(324),o=n(1174);function r({projectId:e,terminal:t,fundingCycleNumber:n}){return Object(o.a)({contract:i.a.JBSingleTokenPaymentTerminalStore,functionName:"usedDistributionLimitOf",args:t&&e&&n?[t,e,n]:null})}},1977:function(e,t,n){"use strict";n.d(t,"a",(function(){return fi}));var i=n(3),o=n(1143),r=n(181),c=n(964),s=n(705),a=n(659),l=n(660),d=n(152),j=n(0),u=n(13),b=n(129),O=n(31),x=n(324),p=n(1697),m=n(1174);let v;function h(e){const{userAddress:t}=Object(j.useContext)(O.a),{projectId:n,isPreviewMode:i}=Object(j.useContext)(d.a),{data:o}=Object(p.a)(n),r=Object(m.a)({contract:x.a.JBOperatorStore,functionName:"hasPermissions",args:t&&o&&n&&!i?[t,o,n,Array.isArray(e)?e:[e]]:null});if(i)return!1;return t&&o&&t.toLowerCase()===o.toLowerCase()||r.data||!1}function f({projectId:e}){return Object(m.a)({contract:x.a.JBController,functionName:"queuedFundingCycleOf",args:e?[e]:null})}!function(e){e[e.RECONFIGURE=1]="RECONFIGURE",e[e.REDEEM=2]="REDEEM",e[e.MIGRATE_CONTROLLER=3]="MIGRATE_CONTROLLER",e[e.MIGRATE_TERMINAL=4]="MIGRATE_TERMINAL",e[e.PROCESS_FEES=5]="PROCESS_FEES",e[e.SET_METADATA=6]="SET_METADATA",e[e.ISSUE=7]="ISSUE",e[e.CHANGE_TOKEN=8]="CHANGE_TOKEN",e[e.MINT=9]="MINT",e[e.BURN=10]="BURN",e[e.CLAIM=11]="CLAIM",e[e.TRANSFER=12]="TRANSFER",e[e.REQUIRE_CLAIM=13]="REQUIRE_CLAIM",e[e.SET_CONTROLLER=14]="SET_CONTROLLER",e[e.SET_TERMINALS=15]="SET_TERMINALS",e[e.SET_PRIMARY_TERMINAL=16]="SET_PRIMARY_TERMINAL",e[e.USE_ALLOWANCE=17]="USE_ALLOWANCE",e[e.SET_SPLITS=18]="SET_SPLITS"}(v||(v={}));var y=n(261),g=n(1480);function C(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({cid:i},o)=>{var r;return e&&n&&null!==t&&void 0!==t&&t.JBProjects?e(t.JBProjects,"setMetadataOf",[n,[i,g.a]],o):(null===o||void 0===o||null===(r=o.onDone)||void 0===r||r.call(o),Promise.resolve(!1))}}var k=n(92),w=n(182),S=n(393),T=n(222),I=n(1);function R(){const{theme:{colors:e}}=Object(j.useContext)(u.a);return Object(I.jsxs)("div",{style:{padding:20,color:e.text.warn,border:`1px solid ${e.stroke.warn}`},children:[Object(I.jsx)("h2",{style:{color:e.text.warn},children:"Heads up"}),Object(I.jsxs)("p",{children:["A minor bug has been found in the V2 Juicebox protocol contracts. The contracts have been fixed and will be redeployed soon."," ",Object(I.jsx)("b",{children:"No funds are in danger"})," and projects are unlikely to be affected."]}),Object(I.jsxs)("p",{children:["While the current V2 contracts are being deprecated, creating new Juicebox projects has been temporarily disabled on the juicebox.money app. Payments to V2 projects with a 0 treasury balance have also been disabled. ",Object(I.jsx)("a",{href:"/#/v2-bug-updates",children:"More details"})]})]})}var P=n(209),E=n(532),D=n(90),L=n(106),A=n(458),F=n(258);function N({title:e,body:t,actions:n}){const{theme:{colors:i}}=Object(j.useContext)(u.a);return Object(I.jsxs)("div",{style:{padding:"1rem 3.3rem",backgroundColor:i.background.l2,position:"relative"},children:[Object(I.jsx)(F.a,{style:{position:"absolute",left:20,top:18}}),Object(I.jsx)("h2",{style:{color:i.text.primary,fontSize:14,fontWeight:600},children:e}),Object(I.jsx)("p",{children:t}),Object(I.jsx)("div",{children:n})]})}var B=n(362),M=n(16),_=n(1698),H=n(1330),V=n(1699),U=n(1356);var J=n(464),z=n(1700),W=n(1207),q=n(358),G=n(11),Y=n(366);function $({payoutSplits:e,reserveSplits:t,fundingCycleMetadata:n,fundingCycleData:i,fundAccessConstraints:o}){var r,a,l,d;const{userAddress:u}=Object(j.useContext)(O.a),b={...i,number:M.a.from(1),configuration:M.a.from(0),basedOn:M.a.from(0),start:M.a.from(Date.now()).div(1e3),metadata:M.a.from(0)},x=Object(W.c)(o),p=Object(q.b)(null===x||void 0===x?void 0:x.distributionLimitCurrency.toNumber()),m=null===x||void 0===x?void 0:x.distributionLimit,v=Boolean(m&&!m.gte(w.c)),h=b.duration,f=null===h||void 0===h?void 0:h.gt(0),y=null!==(r=Object(G.c)(Object(w.l)(Object(w.u)(null===b||void 0===b?void 0:b.weight,null===n||void 0===n?void 0:n.reservedRate.toNumber(),Object(Y.parseEther)("1"),"payer"))))&&void 0!==r?r:"0",g=parseFloat(Object(w.n)(null===n||void 0===n?void 0:n.reservedRate)),C=f&&v?8:12,k=null!==(a=Object(G.c)(Object(w.l)(null!==(l=Object(w.u)(null===b||void 0===b?void 0:b.weight,null===n||void 0===n?void 0:n.reservedRate.toNumber(),Object(Y.parseEther)("1"),"reserved"))&&void 0!==l?l:"")))&&void 0!==a?a:"0";return Object(I.jsxs)("div",{style:{padding:"0 0px"},children:[Object(I.jsxs)(c.a,{gutter:20,style:{marginBottom:20},children:[Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.e,{duration:b.duration})}),Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.c,{distributionLimit:m,currencyName:null!==p&&void 0!==p?p:"ETH"})})]}),Object(I.jsxs)(c.a,{gutter:20,style:{marginBottom:20},children:[Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.f,{inflationRate:null!==(d=Object(G.c)(Object(w.l)(null===b||void 0===b?void 0:b.weight.toString())))&&void 0!==d?d:"0"})}),Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.g,{issuanceRate:y})})]}),Object(I.jsxs)(c.a,{gutter:20,style:{marginBottom:20},children:[Object(I.jsx)(s.a,{md:C,sm:12,children:Object(I.jsx)(z.l,{reservedRate:k,reservedPercentage:g})}),f?Object(I.jsx)(s.a,{md:C,sm:12,children:Object(I.jsx)(z.b,{discountRate:b.discountRate})}):null,v?Object(I.jsx)(s.a,{md:C,sm:12,children:Object(I.jsx)(z.j,{redemptionRate:n.redemptionRate})}):null]}),Object(I.jsxs)(c.a,{gutter:20,style:{marginBottom:20},children:[Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.h,{pausePay:n.pausePay})}),Object(I.jsx)(s.a,{md:12,sm:12,children:Object(I.jsx)(z.a,{allowMinting:n.allowMinting})})]}),Object(I.jsx)(c.a,{gutter:20,style:{marginBottom:20},children:f?Object(I.jsx)(s.a,{span:24,children:Object(I.jsx)(z.i,{ballotAddress:b.ballot})}):null}),!(null!==m&&void 0!==m&&m.eq(0))&&Object(I.jsx)(z.d,{splits:e,currency:null===x||void 0===x?void 0:x.distributionLimitCurrency,totalValue:m,projectOwnerAddress:u,showSplitValues:v,fundingCycleDuration:h}),(null===n||void 0===n?void 0:n.reservedRate.gt(0))&&Object(I.jsx)(z.k,{splits:t,reservedPercentage:g,projectOwnerAddress:u})]})}var X=n(1269),K=n(382),Q=n(38);function Z(){var e,t,n,o;const{projectId:r}=Object(j.useContext)(d.a),{contracts:c}=Object(j.useContext)(y.a),[s,a]=Object(j.useState)(M.a.from(0)),[l,u]=Object(j.useState)("1"),[b,x]=Object(j.useState)(!1),[p,m]=Object(j.useState)(!1),{data:v,loading:h}=Object(V.a)({projectId:r,useDeprecatedContract:!0}),[f,g]=null!==v&&void 0!==v?v:[],{data:C,loading:k}=Object(U.a)({projectId:r,splitGroup:J.a,domain:null===f||void 0===f||null===(e=f.configuration)||void 0===e?void 0:e.toString(),useDeprecatedContract:!0}),{data:w,loading:S}=Object(U.a)({projectId:r,splitGroup:J.b,domain:null===f||void 0===f||null===(t=f.configuration)||void 0===t?void 0:t.toString(),useDeprecatedContract:!0});Object(j.useEffect)((()=>{var e;a(null!==(e=null===f||void 0===f?void 0:f.duration)&&void 0!==e?e:M.a.from(0))}),[f]);const{data:T}=Object(_.a)({projectId:r,useDeprecatedContract:!0}),R=null===T||void 0===T?void 0:T[0],{data:P,loading:E}=Object(H.a)({projectId:r,configuration:null===f||void 0===f||null===(n=f.configuration)||void 0===n?void 0:n.toString(),terminal:R,useDeprecatedContract:!0}),[F,z]=null!==P&&void 0!==P?P:[],W={terminal:null!==(o=null===c||void 0===c?void 0:c.JBETHPaymentTerminal.address)&&void 0!==o?o:"",token:X.a,distributionLimit:F,distributionLimitCurrency:z,overflowAllowance:M.a.from(0),overflowAllowanceCurrency:M.a.from(0)},q=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{userAddress:n}=Object(j.useContext)(O.a);return({projectId:i,fundingCycleData:o,fundingCycleMetadata:r,fundAccessConstraints:c,groupedSplits:s=[],mustStartAtOrAfter:a="1"},l)=>{if(!e||!n||null===t||void 0===t||!t.JBController||null===t||void 0===t||!t.JBETHPaymentTerminal)return Promise.resolve(!1);const d=[i,o,r,a,s,c,[t.JBETHPaymentTerminal.address],""];return e(t.JBController,"launchFundingCyclesFor",d,l)}}(),G=Object(j.useMemo)((()=>{if(f)return f.ballot===K.c.THREE_DAY[Q.c.name]?K.a.THREE_DAY[Q.c.name]:f.ballot}),[f]),Y=k||h||S||E;if(!r||!f||!g)return null;return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(N,{title:Object(I.jsx)(i.b,{id:"Funding cycle required."}),body:Object(I.jsx)(i.b,{id:"Your Juicebox project has no active funding cycle. Launch a funding cycle to re-enable payments on your project."}),actions:Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(D.a,{type:"primary",onClick:()=>x(!0),children:Object(I.jsx)(i.b,{id:"Review and launch funding cycle"})})})}),Object(I.jsx)(B.a,{visible:b,title:Object(I.jsx)(i.b,{id:"Launch funding cycle"}),okText:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Launch funding cycle"})}),width:700,onOk:async()=>{const e={duration:null!==s&&void 0!==s?s:f.duration,ballot:null!==G&&void 0!==G?G:f.ballot,weight:f.weight,discountRate:f.discountRate},t=g;await q({projectId:r,fundingCycleData:e,fundingCycleMetadata:t,fundAccessConstraints:[W],groupedSplits:[{group:J.a,splits:null!==C&&void 0!==C?C:[]},{group:J.b,splits:null!==w&&void 0!==w?w:[]}],mustStartAtOrAfter:l},{onDone(){console.info("Transaction executed. Awaiting confirmation..."),m(!0)},onConfirmed(){m(!1),window.location.reload()}})},onCancel:()=>x(!1),transactionPending:p,children:Y?"Loading...":Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("p",{style:{marginBottom:"2rem"},children:Object(I.jsx)(i.b,{id:"Relaunch your funding cycle on the new Juicebox V2 contracts."})}),Object(I.jsx)(L.a,{layout:"vertical",style:{marginBottom:"1rem"},children:Object(I.jsxs)("div",{style:{display:"flex",gap:20},children:[Object(I.jsx)(L.a.Item,{label:Object(I.jsx)(i.b,{id:"Duration (seconds)"}),required:!0,style:{width:"100%"},extra:s.toNumber()>0?`= ${s.toNumber()/86400} days`:"",children:Object(I.jsx)(A.a,{type:"number",min:0,value:s.toNumber(),onChange:e=>{a(M.a.from(e.target.value||0))}})}),Object(I.jsx)(L.a.Item,{label:Object(I.jsx)(i.b,{id:"Start time (seconds, Unix time)"}),style:{width:"100%"},extra:Object(I.jsx)(i.b,{id:"Leave blank to start immediately."}),children:Object(I.jsx)(A.a,{type:"number",min:0,onChange:e=>{u(e.target.value||"1")}})})]})}),Object(I.jsx)("h3",{children:Object(I.jsx)(i.b,{id:"Funding cycle preview"})}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Your funding cycle configuration has been pre-populated using the configuration you originally launched with. If you need to customize it, contact us."})}),Object(I.jsx)($,{payoutSplits:null!==C&&void 0!==C?C:[],reserveSplits:null!==w&&void 0!==w?w:[],fundingCycleMetadata:g,fundingCycleData:{...f,duration:null!==s&&void 0!==s?s:f.duration,ballot:null!==G&&void 0!==G?G:f.ballot},fundAccessConstraints:[W]})]})})]})}var ee=n(7),te=n(510),ne=n(180);function ie(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{userAddress:n}=Object(j.useContext)(O.a),{projectId:i}=Object(j.useContext)(d.a),o=[1];return({customBeneficiaryAddress:r,customMemo:c,tokenMintingEnabled:s,preferClaimed:a},l)=>{var d;return e&&i&&null!==t&&void 0!==t&&t.JBETHPaymentTerminal?e(null===t||void 0===t?void 0:t.JBETHERC20ProjectPayerDeployer,"deployProjectPayer",[i,null!==r&&void 0!==r?r:ne.a,a,null!==c&&void 0!==c?c:"",o,!s,t.JBDirectory.address,n],{...l}):(null===l||void 0===l||null===(d=l.onDone)||void 0===d||d.call(l),Promise.resolve(!1))}}function oe(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({name:i,symbol:o},r)=>{var c;return e&&n&&null!==t&&void 0!==t&&t.JBTokenStore?e(t.JBController,"issueTokenFor",[n,i,o],r):(null===r||void 0===r||null===(c=r.onDone)||void 0===c||c.call(r),Promise.resolve(!1))}}var re=n(312),ce=n(341),se=n(650),ae=n(666),le=n(969),de=n(965),je=n(98),ue=n.n(je),be=n(73);var Oe=n(1481);var xe=n(1355);function pe({visible:e,onFinish:t}){var n;const{handle:o,projectId:r}=Object(j.useContext)(d.a),[c]=Object(je.useForm)(),[s,a]=Object(j.useState)(),[l,b]=Object(j.useState)(),[O,p]=Object(j.useState)(),v=function(e){const t=e?Object(Y.namehash)(e+(e.endsWith(".eth")?"":".eth")):void 0;return Object(m.a)({contract:x.a.PublicResolver,functionName:"text",args:t?[t,Oe.a]:null,formatter:Object(j.useCallback)((e=>{try{return parseInt(e)}catch(t){console.info("Error parsing project ID from text record",t)}return 0}),[]),updateOn:Object(j.useMemo)((()=>[{contract:x.a.PublicResolver,eventName:"TextChanged",topics:[[],Oe.a]}]),[])})}(o?o+".eth":void 0),{data:h}=function({projectId:e}){return Object(m.a)({contract:x.a.JBProjectHandles,functionName:"ensNamePartsOf",args:e?[e]:null,formatter:Object(j.useCallback)((e=>e?e.join("."):void 0),[]),updateOn:Object(j.useMemo)((()=>e?[{contract:x.a.JBProjectHandles,eventName:"SetEnsNameParts",topics:[M.a.from(e).toHexString()]}]:void 0),[e])})}({projectId:r}),{colors:f}=Object(j.useContext)(u.a).theme,g=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({ensName:i},o)=>{var r;if(!e||!n||null===t||void 0===t||!t.JBProjects)return null===o||void 0===o||null===(r=o.onDone)||void 0===r||r.call(o),Promise.resolve(!1);const c=i.split(".").reverse();return e(t.JBProjectHandles,"setEnsNamePartsFor",[n,c],o)}}(),C=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({ensName:i},o)=>{var r;if(!e||!n||null===t||void 0===t||!t.JBProjects)return null===o||void 0===o||null===(r=o.onDone)||void 0===r||r.call(o),Promise.resolve(!1);const c=Object(Y.namehash)(i+(i.endsWith(".eth")?"":".eth"));return e(t.PublicResolver,"setText",[c,Oe.a,n.toString()],o)}}();Object(j.useEffect)((()=>{null!==h&&void 0!==h&&h.length&&a(!0)}),[h]);const k=Object(j.useCallback)((()=>{c.setFieldsValue({ensName:null!==h&&void 0!==h?h:""})}),[c,h]);return Object(j.useEffect)((()=>{k()}),[k]),Object(I.jsxs)(le.a,{visible:e,...xe.a,onClose:t,children:[Object(I.jsx)("h3",{children:o?Object(I.jsx)(i.b,{id:"Change project handle"}):Object(I.jsx)(i.b,{id:"Set project handle"})}),o&&Object(I.jsxs)("div",{style:{fontWeight:"bold",fontSize:"1.4rem"},children:["@",o]}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Projects with a handle:<0/><1/>1. Are included in search results on the projects page<2/>2. Can be accessed via the URL: <3>juicebox.money/#{0}</3><4/><5/>(The original URL <6>juicebox.money/#{1}</6> will continue to work.)",values:{0:Object(T.a)({handle:"handle"}),1:Object(T.a)({projectId:r})},components:{0:Object(I.jsx)("br",{}),1:Object(I.jsx)("br",{}),2:Object(I.jsx)("br",{}),3:Object(I.jsx)("b",{}),4:Object(I.jsx)("br",{}),5:Object(I.jsx)("br",{}),6:Object(I.jsx)("b",{})}})}),Object(I.jsx)(de.a,{}),Object(I.jsx)("p",{style:{color:f.text.primary},children:Object(I.jsx)(i.b,{id:"Juicebox projects use <0>ENS names</0> as handles. Setting a handle involves 2 transactions:",components:{0:Object(I.jsx)("a",{href:"https://ens.domains/",target:"_blank",rel:"noopener noreferrer"})}})}),Object(I.jsx)("br",{}),Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"1. Set ENS name"})}),Object(I.jsx)("p",{style:{color:f.text.primary},children:Object(I.jsx)(i.b,{id:"Choose an ENS name to use as the project's handle. Subdomains are allowed and will be included in the handle. Handles won't include the \".eth\" extension.<0/><1/>juicebox.eth = @juicebox<2/>dao.juicebox.eth = @dao.juicebox",components:{0:Object(I.jsx)("br",{}),1:Object(I.jsx)("br",{}),2:Object(I.jsx)("br",{})}})}),s?Object(I.jsxs)("div",{children:[Object(I.jsx)("strong",{children:"ENS Name:"})," ",h,".eth",Object(I.jsx)("br",{}),Object(I.jsx)("br",{}),Object(I.jsx)(D.a,{onClick:()=>a(!1),type:"primary",children:Object(I.jsx)(i.b,{id:"Change ENS name"})})]}):Object(I.jsxs)(ue.a,{form:c,onFinish:function(){b(!0);const e=c.getFieldValue("ensName");g({ensName:e},{onDone:()=>b(!1)})},children:[Object(I.jsx)(be.a.ENSName,{name:"ensName",hideLabel:!0}),Object(I.jsx)(D.a,{htmlType:"submit",loading:l,type:"primary",children:Object(I.jsx)(i.b,{id:"Set ENS name"})})]}),Object(I.jsx)(de.a,{}),Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"2. Set text record"})}),Object(I.jsx)("p",{style:{color:f.text.primary},children:Object(I.jsx)(i.b,{id:'Set a text record for {0} with the key <0>"juicebox"</0> and the value <1>"{projectId}"</1> (this project\'s ID). You can do this on the <2>ENS app</2>, or use the button below (as long as your connected wallet owns or controls that ENS name).',values:{0:o?Object(I.jsxs)("strong",{children:[o,".eth"]}):"that ENS name",projectId:r},components:{0:Object(I.jsx)("strong",{}),1:Object(I.jsx)("strong",{}),2:Object(I.jsx)("a",{href:h?`https://app.ens.domains/name/${h}/details`:"https://app.ens.domains",target:"_blank",rel:"noopener noreferrer"})}})}),r&&v.data===r?Object(I.jsxs)(D.a,{type:"primary",disabled:!0,children:[Object(I.jsx)(re.a,{})," ",Object(I.jsx)(i.b,{id:"Text record is set"})]}):Object(I.jsx)(D.a,{loading:O,type:"primary",disabled:!h,onClick:function(){p(!0),C({ensName:null!==h&&void 0!==h?h:""},{onDone:()=>p(!1)})},children:Object(I.jsx)(i.b,{id:"Set text record for {0}",values:{0:null!==(n=h+".eth")&&void 0!==n?n:"ENS name"}})}),!h&&Object(I.jsx)("p",{style:{color:f.text.secondary},children:"Choose an ENS name before setting the text record"})]})}function me({visible:e,onClose:t}){const{handle:n}=Object(j.useContext)(d.a),{theme:{colors:o}}=Object(j.useContext)(u.a),[r,c]=Object(j.useState)(!1),[s,a]=Object(j.useState)(!1),[l,b]=Object(j.useState)(!1),[O,x]=Object(j.useState)(),[p,m]=Object(j.useState)(),v=O&&p,h=o.text.tertiary,f={marginBottom:15};return Object(I.jsxs)(te.a,{visible:e,onOk:t,onCancel:t,okButtonProps:{hidden:!v},cancelButtonProps:{hidden:v},okText:ee.a._("Done"),cancelText:ee.a._("Close, I'll do these later"),children:[Object(I.jsx)("h2",{children:Object(I.jsx)(i.b,{id:"Project launch successful"})}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Congratulations on launching your project! The next steps are optional and can be completed at any time."})}),Object(I.jsxs)("div",{children:[Object(I.jsx)(ce.a,{prefix:"1",heading:Object(I.jsx)(i.b,{id:"Set a project handle (optional)"}),description:Object(I.jsx)(i.b,{id:"Set a unique name that will be visible in your project's URL, and that will allow your project to appear in search results."}),onClick:()=>b(!0),disabled:!!n,icon:n?Object(I.jsx)(re.a,{style:{color:h}}):void 0,primaryColor:n?h:void 0,style:f}),Object(I.jsx)(ce.a,{prefix:"2",heading:Object(I.jsx)(i.b,{id:"Issue an ERC-20 token (optional)"}),description:Object(I.jsx)(i.b,{id:"Create your own ERC-20 token to represent stake in your project. Contributors will receive these tokens when they pay your project."}),onClick:()=>c(!0),disabled:O,icon:O?Object(I.jsx)(re.a,{style:{color:h}}):void 0,primaryColor:O?h:void 0,style:f}),Object(I.jsx)(ce.a,{prefix:"3",heading:Object(I.jsx)(i.b,{id:"Create a payable address (optional)"}),description:Object(I.jsx)(i.b,{id:"Create an Ethereum address for your project. Enables direct payments without going through your project's Juicebox page."}),onClick:()=>a(!0),disabled:p,icon:p?Object(I.jsx)(re.a,{style:{color:h}}):void 0,primaryColor:p?h:void 0,style:f})]}),Object(I.jsx)(pe,{visible:l,onFinish:()=>b(!1)}),Object(I.jsx)(se.a,{visible:r,useIssueTokensTx:oe,onClose:()=>c(!1),onConfirmed:()=>x(!0)}),Object(I.jsx)(ae.a,{visible:s,onClose:()=>a(!1),useDeployProjectPayerTx:ie,onConfirmed:()=>m(!0)})]})}var ve=n(703),he=n(1132),fe=n(645),ye=n(646),ge=n(647),Ce=n(648),ke=n(83),we=n(271),Se=n(122),Te=n(108),Ie=n(97),Re=n(126),Pe=n(145),Ee=n(84);function De({visible:e,onCancel:t}){const[n,o]=Object(j.useState)(),[r,c]=Object(j.useState)(),[s,a]=Object(j.useState)(),{projectId:l}=Object(j.useContext)(d.a);Object(j.useEffect)((()=>{Ee.a.getBlockNumber().then((e=>{o(e),c(e)}))}),[]);const u=Object(j.useCallback)((async()=>{if(void 0===r||!l)return;a(!0);const e=[[ee.a._("Amount paid"),ee.a._("Date"),ee.a._("Payer"),ee.a._("Beneficiary"),ee.a._("Note")]];try{const t=await Object(Pe.e)({entity:"payEvent",keys:["caller","beneficiary","amount","timestamp","note"],orderBy:"timestamp",orderDirection:"desc",block:{number:r},where:[{key:"projectId",value:l},{key:"cv",value:"2"}]});if(!t)throw Object(Re.a)(ee.a._("Error loading payments")),new Error("No data.");t.forEach((t=>{var n;let i=new Date(1e3*(null!==(n=t.timestamp)&&void 0!==n?n:0)).toUTCString();i.includes(",")&&(i=i.split(",")[1]),e.push([Object(G.e)(t.amount),i,t.caller,t.beneficiary,t.note])}));const n="data:text/csv;charset=utf-8,"+e.map((e=>e.join(","))).join("\n"),i=encodeURI(n),o=document.createElement("a");o.setAttribute("href",i),o.setAttribute("download",`project-${l}_payments-block${r}.csv`),document.body.appendChild(o),o.click(),a(!1)}catch(t){console.error("Error downloading payments",t),a(!1)}}),[l,a,r]);return Object(I.jsx)(te.a,{visible:e,onCancel:t,onOk:u,okText:ee.a._("Download CSV"),okButtonProps:{type:"primary"},cancelText:ee.a._("Close"),confirmLoading:s,centered:!0,children:Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"Download CSV of payments"})}),Object(I.jsx)("label",{style:{display:"block",marginTop:20,marginBottom:5},children:Object(I.jsx)(i.b,{id:"Block number"})}),Object(I.jsx)(Ie.a,{value:null===r||void 0===r?void 0:r.toString(),onChange:e=>c(e?parseInt(e):void 0),accessory:Object(I.jsx)(Te.a,{content:ee.a._("Latest"),onClick:()=>c(n),disabled:r===n})})]})})}function Le({visible:e,onCancel:t}){const[n,o]=Object(j.useState)();return Object(I.jsxs)(te.a,{visible:e,onCancel:t,cancelText:ee.a._("Close"),okButtonProps:{hidden:!0},centered:!0,children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"Download CSV of project activity"})}),Object(I.jsx)("div",{style:{marginTop:20},children:Object(I.jsx)(D.a,{block:!0,onClick:()=>o(!0),children:"Payments"})})]}),Object(I.jsx)(De,{visible:n,onCancel:()=>o(!1)})]})}var Ae=n(47),Fe=n(51),Ne=n(109),Be=n(82),Me=n(77);function _e({event:e}){var t;const{theme:{colors:n}}=Object(j.useContext)(u.a),{data:o}=Object(Se.a)({entity:"distributeToPayoutSplitEvent",keys:["id","timestamp","txHash","amount","beneficiary","splitProjectId"],orderDirection:"desc",orderBy:"amount",where:null!==e&&void 0!==e&&e.id?{key:"distributePayoutsEvent",value:e.id}:void 0});return e?Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(I.jsx)("div",{style:Object(Me.c)(n),children:Object(I.jsx)(i.b,{id:"Distributed funds"})}),Object(I.jsxs)("div",{style:{textAlign:"right"},children:[Object(I.jsxs)("div",{style:Object(Me.c)(n),children:[e.timestamp&&Object(I.jsx)("span",{children:Object(Be.b)(1e3*e.timestamp)})," ",Object(I.jsx)(Ne.a,{value:e.txHash,type:"tx"})]}),Object(I.jsx)("div",{style:Object(Me.c)(n),children:Object(I.jsx)(i.b,{id:"called by <0/>",components:{0:Object(I.jsx)(Fe.a,{address:e.caller})}})})]})]}),Object(I.jsxs)("div",{style:{marginTop:5},children:[null===o||void 0===o?void 0:o.map((e=>Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",fontSize:"0.8rem"},children:[Object(I.jsxs)("div",{style:{fontWeight:500},children:[e.splitProjectId?Object(I.jsxs)("span",{children:["Project ",e.splitProjectId]}):Object(I.jsx)(Fe.a,{address:e.beneficiary}),":"]}),Object(I.jsxs)("div",{style:{color:n.text.secondary},children:[Object(I.jsx)(Ae.a,{currency:"ETH"}),Object(G.b)(e.amount,{precision:4})]})]},e.id))),(null===(t=e.beneficiaryDistributionAmount)||void 0===t?void 0:t.gt(0))&&Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",fontSize:null!==o&&void 0!==o&&o.length?"0.8rem":void 0},children:[Object(I.jsxs)("div",{style:{fontWeight:500},children:[Object(I.jsx)(Fe.a,{address:e.beneficiary}),":"]}),Object(I.jsxs)("div",{style:null!==o&&void 0!==o&&o.length?{color:n.text.secondary}:{fontWeight:500},children:[Object(I.jsx)(Ae.a,{currency:"ETH"}),Object(G.b)(e.beneficiaryDistributionAmount,{precision:4})]})]})]}),null!==o&&void 0!==o&&o.length?Object(I.jsxs)("div",{style:{color:n.text.primary,fontWeight:500,textAlign:"right"},children:[Object(I.jsx)(Ae.a,{currency:"ETH"}),Object(G.b)(e.distributedAmount,{precision:4})]}):null]}):null}var He=n(20),Ve=n(50);function Ue({event:e}){var t;const{theme:{colors:n}}=Object(j.useContext)(u.a),{tokenSymbol:o}=Object(j.useContext)(He.a),{data:r}=Object(Se.a)({entity:"distributeToReservedTokenSplitEvent",keys:["id","timestamp","txHash","beneficiary","tokenCount","projectId"],orderDirection:"desc",orderBy:"tokenCount",where:null!==e&&void 0!==e&&e.id?{key:"distributeReservedTokensEvent",value:e.id}:void 0},{});return e?Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(I.jsx)("div",{style:Object(Me.c)(n),children:Object(I.jsx)(i.b,{id:"Distributed reserved {0}",values:{0:Object(Ve.a)({tokenSymbol:o,capitalize:!1,plural:!0})}})}),Object(I.jsxs)("div",{style:{textAlign:"right"},children:[Object(I.jsxs)("div",{style:Object(Me.c)(n),children:[e.timestamp&&Object(I.jsx)("span",{children:Object(Be.b)(1e3*e.timestamp)})," ",Object(I.jsx)(Ne.a,{value:e.txHash,type:"tx"})]}),Object(I.jsx)("div",{style:Object(Me.c)(n),children:Object(I.jsx)(i.b,{id:"called by <0/>",components:{0:Object(I.jsx)(Fe.a,{address:e.caller})}})})]})]}),Object(I.jsxs)("div",{style:{marginTop:5},children:[null===r||void 0===r?void 0:r.map((e=>Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[Object(I.jsxs)("div",{style:{fontWeight:500,fontSize:"0.8rem"},children:[Object(I.jsx)(Fe.a,{address:e.beneficiary}),":"]}),Object(I.jsx)("div",{style:r.length>1?{color:n.text.secondary,fontSize:"0.8rem"}:{fontWeight:500},children:Object(G.b)(e.tokenCount,{precision:0})})]},e.id))),(null===(t=e.beneficiaryTokenCount)||void 0===t?void 0:t.gt(0))&&Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[Object(I.jsxs)("div",{style:{fontWeight:500},children:[Object(I.jsx)(Fe.a,{address:e.beneficiary}),":"]}),Object(I.jsx)("div",{style:{color:n.text.secondary},children:Object(G.b)(e.beneficiaryTokenCount,{precision:0})})]})]}),null!==r&&void 0!==r&&r.length&&(null===r||void 0===r?void 0:r.length)>1?Object(I.jsx)("div",{style:{color:n.text.primary,fontWeight:500,textAlign:"right"},children:Object(G.b)(e.tokenCount,{precision:0})}):null]}):null}function Je(){const[e,t]=Object(j.useState)(),[n,o]=Object(j.useState)("all"),{theme:{colors:c}}=Object(j.useContext)(u.a),{projectId:s}=Object(j.useContext)(d.a),a=Object(j.useMemo)((()=>{const e=[{key:"cv",value:"2"},{key:"mintTokensEvent",value:null},{key:"useAllowanceEvent",value:null}];let t;switch(s&&e.push({key:"projectId",value:s}),n){case"deployERC20":t="deployedERC20Event";break;case"pay":t="payEvent";break;case"projectCreate":t="projectCreateEvent";break;case"redeem":t="redeemEvent";break;case"distributePayouts":t="distributePayoutsEvent";break;case"distributeTokens":t="distributeReservedTokensEvent"}return t&&e.push({key:t,operator:"not",value:null}),e}),[s,n]),{data:l,fetchNextPage:b,hasNextPage:O,isLoading:x,isFetchingNextPage:p}=Object(Se.b)({pageSize:50,entity:"projectEvent",keys:["id",{entity:"payEvent",keys:["amount","timestamp","beneficiary","note","id","txHash"]},{entity:"deployedERC20Event",keys:["symbol","txHash","timestamp","id"]},{entity:"tapEvent",keys:["id","timestamp","txHash","caller","beneficiary","beneficiaryTransferAmount","netTransferAmount"]},{entity:"redeemEvent",keys:["id","amount","beneficiary","txHash","timestamp","returnAmount"]},{entity:"projectCreateEvent",keys:["id","txHash","timestamp","caller"]},{entity:"distributePayoutsEvent",keys:["id","timestamp","txHash","caller","beneficiary","beneficiaryDistributionAmount","distributedAmount","memo"]},{entity:"distributeReservedTokensEvent",keys:["id","timestamp","txHash","caller","beneficiary","beneficiaryTokenCount","tokenCount"]}],orderDirection:"desc",orderBy:"timestamp",where:a}),m=Object(j.useMemo)((()=>null===l||void 0===l?void 0:l.pages.map((e=>e.map((e=>{let t;return e.payEvent&&(t=Object(I.jsx)(ye.a,{event:e.payEvent})),e.redeemEvent&&(t=Object(I.jsx)(Ce.a,{event:e.redeemEvent})),e.projectCreateEvent&&(t=Object(I.jsx)(ge.a,{event:e.projectCreateEvent})),e.deployedERC20Event&&(t=Object(I.jsx)(fe.a,{event:e.deployedERC20Event})),e.distributePayoutsEvent&&(t=Object(I.jsx)(_e,{event:e.distributePayoutsEvent})),e.distributeReservedTokensEvent&&(t=Object(I.jsx)(Ue,{event:e.distributeReservedTokensEvent})),e.useAllowanceEvent,t?Object(I.jsx)("div",{style:{marginBottom:20,paddingBottom:20,borderBottom:"1px solid "+c.stroke.tertiary},children:t},e.id):null}))))),[c,l]),v=Object(j.useMemo)((()=>{var e,t;const n=null!==(e=null===l||void 0===l||null===(t=l.pages)||void 0===t?void 0:t.reduce(((e,t)=>e+t.length),0))&&void 0!==e?e:0;return x||p?Object(I.jsx)("div",{children:Object(I.jsx)(ke.a,{})}):0!==n||x?O?Object(I.jsx)("div",{style:{textAlign:"center",color:c.text.secondary,cursor:"pointer"},onClick:()=>b(),children:Object(I.jsx)(i.b,{id:"Load more"})}):Object(I.jsx)("div",{style:{textAlign:"center",padding:10,color:c.text.secondary},children:Object(I.jsx)(i.b,{id:"{count} total",values:{count:n}})}):Object(I.jsx)("div",{style:{color:c.text.secondary,paddingTop:20,borderTop:"1px solid "+c.stroke.tertiary},children:Object(I.jsx)(i.b,{id:"No activity yet"})})}),[l,x,p,O,b,c]);return Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",marginBottom:20},children:[Object(I.jsx)(we.a,{text:ee.a._("Activity"),style:{margin:0}}),Object(I.jsxs)(r.b,{direction:"horizontal",align:"center",size:"small",children:[Object(I.jsx)(D.a,{type:"text",icon:Object(I.jsx)(ve.a,{}),onClick:()=>t(!0)}),Object(I.jsxs)(he.a,{className:"small",style:{width:200},value:n,onChange:e=>o(e),children:[Object(I.jsx)(he.a.Option,{value:"all",children:Object(I.jsx)(i.b,{id:"All events"})}),Object(I.jsx)(he.a.Option,{value:"pay",children:Object(I.jsx)(i.b,{id:"Paid"})}),Object(I.jsx)(he.a.Option,{value:"redeem",children:Object(I.jsx)(i.b,{id:"Redeemed"})}),Object(I.jsx)(he.a.Option,{value:"distributePayouts",children:Object(I.jsx)(i.b,{id:"Distributed Funds"})}),Object(I.jsx)(he.a.Option,{value:"distributeTokens",children:Object(I.jsx)(i.b,{id:"Distributed Tokens"})}),Object(I.jsx)(he.a.Option,{value:"deployERC20",children:Object(I.jsx)(i.b,{id:"ERC20 Deployed"})}),Object(I.jsx)(he.a.Option,{value:"projectCreate",children:Object(I.jsx)(i.b,{id:"Project Created"})})]})]})]}),m,v,Object(I.jsx)(Le,{visible:e,onCancel:()=>t(!1)})]})}var ze=n(506),We=n(644),qe=n(1701),Ge=n(663),Ye=n(275),$e=n(123),Xe=n(643);function Ke({amount:e,currency:t,precision:n=2}){return void 0===e?null:null!==t&&void 0!==t&&t.eq(q.a)||null!==t&&void 0!==t&&t.eq(q.c)?Object(I.jsx)($e.a,{amount:e,precision:n,padEnd:!0}):null!==t&&void 0!==t&&t.eq(q.e)?Object(I.jsx)(Xe.a,{amount:e,precision:n,padEnd:!0}):null}function Qe({style:e}){const{theme:t}=Object(j.useContext)(u.a),{colors:n}=t,{ETHBalance:o,balanceInDistributionLimitCurrency:r,distributionLimitCurrency:c,loading:{balanceInDistributionLimitCurrencyLoading:s}}=Object(j.useContext)(d.a);return Object(I.jsx)(Ye.a,{loading:s,statLabel:Object(I.jsx)(i.b,{id:"In treasury"}),statLabelTip:Object(I.jsx)(i.b,{id:"This project's balance in the Juicebox contract."}),statValue:Object(I.jsxs)("div",{style:{...P.a,color:n.text.brand.primary,marginLeft:10},children:[(null===c||void 0===c?void 0:c.eq(q.e))&&Object(I.jsxs)("span",{style:Object(P.b)(t),children:[Object(I.jsx)($e.a,{amount:o,precision:4,padEnd:!0})," "]}),Object(I.jsx)(Ke,{amount:null!==r&&void 0!==r?r:M.a.from(0),currency:null!==c&&void 0!==c?c:M.a.from(q.a)})]}),style:e})}var Ze=n(78);function et({style:e}){const{theme:t}=Object(j.useContext)(u.a),{colors:n}=t,{distributionLimit:o,usedDistributionLimit:r,distributionLimitCurrency:c,loading:{distributionLimitLoading:s}}=Object(j.useContext)(d.a),a=Object(P.b)(t);return Object(I.jsx)(Ye.a,{style:e,loading:s,statLabel:Object(I.jsx)(i.b,{id:"Distributed"}),statLabelTip:Object(I.jsx)(i.b,{id:"The amount that has been distributed from the Juicebox balance in this funding cycle, out of the current distribution limit. No more than the distribution limit can be distributed in a single funding cycle\u2014any remaining ETH in Juicebox is overflow, until the next cycle begins."}),statValue:null!==o&&void 0!==o&&o.gt(0)?Object(I.jsxs)("div",{style:{...a,color:n.text.primary},children:[Object(I.jsx)(Ke,{amount:r,currency:c})," ",Object(I.jsxs)(I.Fragment,{children:["/"," ",o.eq(w.c)?Object(I.jsx)(i.b,{id:"NO LIMIT"}):Object(I.jsx)(Ke,{amount:o,currency:c})]})]}):Object(I.jsx)("div",{style:{...a,textAlign:"right"},children:Object(I.jsx)(Ze.a,{tip:Object(I.jsx)(i.b,{id:"The distribution limit for this funding cycle is 0, meaning all funds in Juicebox are currently considered overflow. Overflow can be redeemed by token holders, but not distributed."}),label:Object(I.jsx)(i.b,{id:"100% overflow"})})})})}var tt=n(387);function nt({style:e}){const{projectOwnerAddress:t}=Object(j.useContext)(d.a),{data:n,isLoading:o}=Object(tt.a)(t);return Object(I.jsx)(Ye.a,{loading:o,statLabel:Object(I.jsx)(i.b,{id:"In wallet"}),statLabelTip:Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"The balance of the project owner's wallet."})})," ",Object(I.jsx)(Ne.a,{value:t,type:"address"})]}),statValue:Object(I.jsx)("span",{style:P.a,children:Object(I.jsx)($e.a,{amount:n,precision:2,padEnd:!0})}),style:e})}function it(){const{balanceInDistributionLimitCurrency:e,distributionLimit:t,projectId:n,totalVolume:i,isPreviewMode:o,primaryTerminal:c,loading:{distributionLimitLoading:s}}=Object(j.useContext)(d.a),{theme:{colors:a}}=Object(j.useContext)(u.a),{data:l,loading:b}=Object(qe.a)({terminal:c,projectId:n}),O=!o&&b||s;return Object(I.jsxs)(r.b,{direction:"vertical",style:{display:"flex"},children:[Object(I.jsx)(Ge.a,{totalVolume:i,color:a.text.primary}),Object(I.jsx)(Qe,{}),Object(I.jsx)(et,{}),Object(I.jsx)(ze.a,{loading:O,title:!1,paragraph:{rows:1,width:["100%"]},active:!0,children:!O&&t?Object(I.jsx)(We.a,{targetAmount:t,balanceInTargetCurrency:e,overflowAmountInTargetCurrency:l}):null}),Object(I.jsx)(nt,{})]})}var ot=n(977),rt=n(103),ct=n(611),st=n(273),at=n(1702),lt=n(86);function dt(e,t){return Object(m.a)({contract:x.a.JBTokenStore,functionName:"balanceOf",args:e&&t?[e,M.a.from(t).toHexString()]:null,valueDidChange:lt.b})}const jt=({projectId:e,handle:t,style:n,precision:i})=>{const{theme:{colors:o}}=Object(j.useContext)(u.a),{data:r}=Object(at.a)({projectId:e}),c=Object(st.a)(r),{userAddress:s}=Object(j.useContext)(O.a),{data:a}=dt(s,e);return Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...n},children:[Object(I.jsx)("span",{children:void 0!==c?Object(I.jsxs)(I.Fragment,{children:[Object(G.b)(a,{precision:null!==i&&void 0!==i?i:0})," ",Object(Ve.a)({tokenSymbol:c,plural:!0})]}):"--"}),t&&Object(I.jsx)(ct.a,{style:{color:o.text.tertiary},projectId:e,handle:t})]})};var ut=n(665),bt=n(1138),Ot=n(702),xt=n(701),pt=n(101);const mt=({type:e,onClick:t})=>{const n="project"===e?"Project":"ERC-20";return Object(I.jsx)(D.a,{style:{marginRight:20,width:100},type:"text",icon:Object(I.jsx)(bt.a,{}),onClick:t,children:n})},vt=({value:e,onChange:t})=>{var n,i,o,r,c;const[s,a]=Object(j.useState)(null!==(n=null===e||void 0===e?void 0:e.input)&&void 0!==n?n:""),[l,d]=Object(j.useState)(null!==(i=null===e||void 0===e?void 0:e.type)&&void 0!==i?i:"erc20"),u=n=>{null===t||void 0===t||t({input:s,type:l,...e,...n})},b=e=>{d(e),u({type:e,input:""})};return Object(I.jsxs)("div",{style:{display:"inline-flex",width:"100%"},children:[Object(I.jsx)(mt,{type:null!==(o=null===e||void 0===e?void 0:e.type)&&void 0!==o?o:l,onClick:()=>{const t=e=>"erc20"===e?"project":"erc20";null!==e&&void 0!==e&&e.type?b(t(e.type)):b(t(l))}}),Object(I.jsx)(A.a,{type:"text",placeholder:"erc20"===(null!==(r=null===e||void 0===e?void 0:e.type)&&void 0!==r?r:l)?ne.a:"Project ID",value:null!==(c=null===e||void 0===e?void 0:e.input)&&void 0!==c?c:s,onChange:e=>{a(s),u({input:e.target.value})}})]})};function ht({form:e}){return Object(I.jsx)(L.a,{form:e,children:Object(I.jsx)(L.a.List,{name:"tokenRefs",children:(e,{add:t,remove:n})=>Object(I.jsxs)(I.Fragment,{children:[e.map((({key:e,name:t})=>Object(I.jsxs)(c.a,{children:[Object(I.jsx)(s.a,{flex:"auto",children:Object(I.jsx)(L.a.Item,{name:[t,"assetInput"],rules:[{validator:(e,t)=>null!==t&&void 0!==t&&t.input.length?Promise.resolve():Promise.reject("Value is "),validateTrigger:"onCreate",message:"Value is required",required:!0}],children:Object(I.jsx)(vt,{})})}),Object(I.jsx)(s.a,{flex:"none",children:Object(I.jsx)(pt.a,{title:ee.a._("Untrack token"),children:Object(I.jsx)(D.a,{type:"text",style:{marginLeft:10},icon:Object(I.jsx)(Ot.a,{}),block:!0,onClick:()=>n(t)})})})]},e))),Object(I.jsx)(L.a.Item,{children:Object(I.jsx)(D.a,{type:"dashed",onClick:()=>t(),block:!0,icon:Object(I.jsx)(xt.a,{}),children:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Add token"})})})})]})})})}function ft({owner:e,projectMetadata:t,projectName:n,hasEditPermissions:o,visible:c,onCancel:s,storeCidTx:a}){var l;const[d,u]=Object(j.useState)(),[b,O]=Object(j.useState)(),[x]=Object(je.useForm)();return Object(j.useEffect)((()=>{var e;const n=(null!==(e=null===t||void 0===t?void 0:t.tokens)&&void 0!==e?e:[{type:"erc20",value:""}]).map((e=>({...e})));x.setFieldsValue({tokenRefs:n.map((e=>({assetInput:{input:e.value,type:e.type}})))})}),[x,t,d]),Object(I.jsx)(te.a,{visible:c,onCancel:s,footer:Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:20},children:[o?Object(I.jsx)(D.a,{type:"text",size:"small",icon:Object(I.jsx)(ot.a,{}),onClick:()=>u(!0),children:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Edit tracked assets"})})}):Object(I.jsx)("div",{}),Object(I.jsx)(D.a,{onClick:s,children:Object(I.jsx)(i.b,{id:"Done"})})]}),children:Object(I.jsxs)("div",{children:[Object(I.jsx)("h2",{children:Object(I.jsx)(i.b,{id:"Assets"})}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Other assets in this project's owner's wallet."})}),Object(I.jsxs)(r.b,{direction:"vertical",style:{width:"100%",marginTop:20},children:[Object(I.jsx)(jt,{projectId:E.a.JUICEBOX_DAO}),null===t||void 0===t||null===(l=t.tokens)||void 0===l?void 0:l.map((t=>"erc20"===t.type?Object(I.jsx)(ut.a,{wallet:e,tokenAddress:t.value},t.value):Object(I.jsx)(jt,{projectId:M.a.from(t.value).toNumber()})))]}),Object(I.jsxs)(te.a,{title:ee.a._("Edit tracked assets"),visible:d,onCancel:()=>u(!1),cancelText:ee.a._("Cancel"),width:600,confirmLoading:b,onOk:async function(){if(!n)return;await x.validateFields(),O(!0);const e=x.getFieldsValue().tokenRefs.map((e=>e.assetInput)).map((e=>({value:e.input,type:e.type}))),i=await Object(rt.j)({...t,tokens:e.filter((e=>e.type))},n);i.IpfsHash?a({cid:i.IpfsHash},{onDone:()=>{O(!1),u(!1),x.resetFields()}}):O(!1)},okText:ee.a._("Save tracked assets"),children:[Object(I.jsx)("p",{style:{marginBottom:40},children:Object(I.jsx)(i.b,{id:"Display ERC-20 and other Juicebox project tokens that this project owner holds."})}),Object(I.jsx)(ht,{form:x})]})]})})}var yt=n(251),gt=n(634),Ct=n(195),kt=n(538),wt=n(150),St=n(1134),Tt=n(250),It=n(466),Rt=n(519),Pt=n(165),Et=n(526),Dt=n(1703);function Lt({fundingCycle:e,fundingCycleMetadata:t,distributionLimit:n,distributionLimitCurrency:o}){const{theme:{colors:r}}=Object(j.useContext)(u.a),{tokenSymbol:c}=Object(j.useContext)(d.a);if(!e)return null;const s=Object(It.b)({timeSeconds:e.duration.toNumber(),fullWords:!0}),a=Object(Be.a)(e.start.mul(1e3)),l=Object(Be.a)(e.start.add(e.duration).mul(1e3)),b=Object(Rt.a)(e.ballot),O=Object(W.d)(e),x=Object(Ve.a)({tokenSymbol:c,capitalize:!1,plural:!0}),p=()=>{var n;const o=Object(G.c)(Object(w.l)(null!==(n=Object(w.u)(null===e||void 0===e?void 0:e.weight,null===t||void 0===t?void 0:t.reservedRate.toNumber(),Object(Y.parseEther)("1"),"reserved"))&&void 0!==n?n:""));return Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"{reservedRate} {tokenSymbolPlural}/ETH ({0}%)",values:{0:Object(w.n)(null===t||void 0===t?void 0:t.reservedRate),reservedRate:o,tokenSymbolPlural:x}})})},m=()=>{var n;const o=Object(G.c)(Object(w.l)(null!==(n=Object(w.u)(null===e||void 0===e?void 0:e.weight,null===t||void 0===t?void 0:t.reservedRate.toNumber(),Object(Y.parseEther)("1"),"payer"))&&void 0!==n?n:""));return Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"{payerRate} {tokenSymbolPlural}/ETH",values:{payerRate:o,tokenSymbolPlural:x}})})},v=Object(Pt.a)();return Object(I.jsxs)("div",{children:[Object(I.jsxs)(St.b,{labelStyle:{fontWeight:600},size:"small",column:{xs:1,sm:1,md:1,lg:1,xl:1,xxl:2},contentStyle:{marginRight:"0.5rem"},children:[Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"Distribution limit"}),children:Object(I.jsx)("span",{style:{whiteSpace:"nowrap"},children:Object(I.jsx)(Dt.a,{distributionLimit:n,currencyName:Object(q.b)(null===o||void 0===o?void 0:o.toNumber())})})}),Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"Duration"}),children:e.duration.gt(0)?s:Object(I.jsx)(Tt.a,{showWarning:!0,tooltipTitle:v.duration,children:Object(I.jsx)(i.b,{id:"Not set"})})}),e.duration.gt(0)&&Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"Start"}),children:a}),e.duration.gt(0)&&Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"End"}),children:l}),Object(I.jsxs)(St.b.Item,{label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Discount rate"}),tip:Et.a}),children:[Object(w.j)(e.discountRate),"%"]}),Object(I.jsx)(St.b.Item,{span:2,label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Redemption rate"}),tip:Et.b}),children:null!==t&&void 0!==t&&t.redemptionRate?Object(I.jsxs)("span",{children:[Object(w.m)(null===t||void 0===t?void 0:t.redemptionRate),"%"]}):null}),Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Mint rate"}),tip:Object(I.jsx)(i.b,{id:"<0>Total project tokens minted</0> when 1 ETH is contributed. This can change over time according to the discount rate and reserved tokens amount of future funding cycles.",components:{0:Object(I.jsx)("strong",{})}})}),span:2,contentStyle:{minWidth:"10em"},children:Object(I.jsx)(i.b,{id:"{0} tokens/ETH",values:{0:Object(G.c)(Object(w.l)(null===e||void 0===e?void 0:e.weight.toString()))}})}),Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Contributor rate"}),tip:Object(I.jsx)(i.b,{id:"Newly minted {tokenSymbolPlural} <0>received by contributors</0> per ETH they contribute to the treasury.",values:{tokenSymbolPlural:x},components:{0:Object(I.jsx)("strong",{})}})}),span:2,contentStyle:{minWidth:"10em"},children:Object(I.jsx)(m,{})}),Object(I.jsx)(St.b.Item,{span:2,label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Reserved {tokenSymbolPlural}",values:{tokenSymbolPlural:x}}),tip:Object(I.jsx)(i.b,{id:"Amount of newly minted project tokens <0>reserved for the project</0> when 1 ETH is contributed. The project owner is allocated all reserved tokens by default, but they can also be allocated to other wallet addresses.",components:{0:Object(I.jsx)("strong",{})}})}),children:Object(I.jsx)(Tt.a,{showWarning:O.metadataReservedRate,tooltipTitle:v.metadataReservedRate,children:Object(I.jsx)(p,{})})}),Object(I.jsx)(St.b.Item,{span:2,label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Payments"})}),children:null!==t&&void 0!==t&&t.pausePay?Object(I.jsx)(i.b,{id:"Paused"}):Object(I.jsx)(i.b,{id:"Enabled"})}),Object(I.jsx)(St.b.Item,{span:2,label:Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Owner token minting"}),tip:Object(I.jsx)(i.b,{id:"Token minting allows the project owner to mint project tokens at any time."})}),children:Object(I.jsx)(Tt.a,{showWarning:null===t||void 0===t?void 0:t.allowMinting,tooltipTitle:Object(Pt.a)().allowMinting,children:null!==t&&void 0!==t&&t.allowMinting?Object(I.jsx)(i.b,{id:"Allowed"}):Object(I.jsx)(i.b,{id:"Disabled"})})})]}),Object(I.jsxs)("div",{children:[Object(I.jsxs)("span",{style:{fontWeight:600,color:r.text.secondary},children:[Object(I.jsx)(Ze.a,{label:Object(I.jsx)(i.b,{id:"Reconfiguration strategy"}),tip:Object(I.jsx)(i.b,{id:"Rules for determining how funding cycles can be reconfigured"})}),":"]})," ",Object(I.jsx)(Tt.a,{showWarning:O.ballot,tooltipTitle:v.ballot,children:b.name}),Object(I.jsx)("div",{style:{color:r.text.secondary},children:Object(I.jsxs)("div",{style:{fontSize:"0.7rem"},children:[Object(I.jsx)(i.b,{id:"Address: <0/>",components:{0:Object(I.jsx)(Ne.a,{value:b.address,type:"address"})}}),Object(I.jsx)("br",{}),b.description]})})]})]})}var At=n(633),Ft=n(1426),Nt=n(1482),Bt=n(125);function Mt({visible:e,onCancel:t,onConfirmed:n}){var o,c,s;const[a,l]=Object(j.useState)(),[b,O]=Object(j.useState)(),{balanceInDistributionLimitCurrency:x,distributionLimit:p,usedDistributionLimit:m,distributionLimitCurrency:v,payoutSplits:h,projectOwnerAddress:f}=Object(j.useContext)(d.a),{theme:{colors:g}}=Object(j.useContext)(u.a),[C,k]=Object(j.useState)(),S=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({amount:i,currency:o,memo:r=""},c)=>{var s;return e&&n&&null!==t&&void 0!==t&&t.JBETHPaymentTerminal&&i&&o?e(t.JBETHPaymentTerminal,"distributePayoutsOf",[n,i,o,X.a,0,r],c):(null===c||void 0===c||null===(s=c.onDone)||void 0===s||s.call(c),Promise.resolve(!1))}}(),T=Object(Nt.a)(),R=Object(Bt.a)();if(Object(j.useEffect)((()=>{var e;if(!p)return;const t=null!==(e=null===p||void 0===p?void 0:p.sub(null!==m&&void 0!==m?m:0))&&void 0!==e?e:0,n=null!==x&&void 0!==x&&x.gt(t)?t:x;O(Object(G.e)(n))}),[x,p,m]),!T)return null;const P=Object(q.b)(null===v||void 0===v?void 0:v.toNumber()),E=null!==(o=null===p||void 0===p?void 0:p.sub(null!==m&&void 0!==m?m:0))&&void 0!==o?o:M.a.from(0),D=null!==x&&void 0!==x&&x.gt(E)?E:x,A=Object(w.k)(T),N=Object(G.b)(D,{precision:4}),_=Object(G.b)(null!==(c=Object(w.i)(D,T))&&void 0!==c?c:0,{precision:4}),H=null!==(s=Object(w.g)(D,T))&&void 0!==s?s:M.a.from(0),V=Object(G.b)(H,{precision:4}),U=Object(G.b)(b?Object(w.g)(Object(G.f)(b),T):M.a.from(0));return Object(I.jsx)(B.a,{title:Object(I.jsx)(i.b,{id:"Distribute funds"}),visible:e,onOk:async function(){var e;if(!v||!b)return;if(!(null===(e=v.eq(q.e)?R.usdToWei(b):Object(G.f)(b))||void 0===e?void 0:e.sub(1e12)))return;l(!0),await S({amount:Object(G.f)(b),currency:v.toNumber()},{onDone:()=>{k(!0)},onConfirmed:()=>{l(!1),k(!1),null===n||void 0===n||n()}})||(l(!1),k(!1))},onCancel:()=>{O(void 0),null===t||void 0===t||t()},okButtonProps:{disabled:!b||"0"===b},confirmLoading:a,transactionPending:C,okText:ee.a._("Distribute funds"),connectWalletText:ee.a._("Connect wallet to distribute"),width:640,children:Object(I.jsxs)(r.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(I.jsx)(i.b,{id:"Total funds:"})," ",Object(I.jsxs)("div",{children:[Object(I.jsx)(Ae.a,{currency:P}),N]})]}),Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(I.jsx)("div",{children:Object(I.jsx)(i.b,{id:"JBX Fee ({feePercentage}%):",values:{feePercentage:A}})}),Object(I.jsxs)("div",{children:["- ",Object(I.jsx)(Ae.a,{currency:P}),_]})]}),Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500,borderTop:`1px solid ${g.stroke.tertiary}`},children:[Object(I.jsx)("div",{children:Object(I.jsx)(i.b,{id:"Available after fee:"})}),Object(I.jsxs)("div",{children:[Object(I.jsx)(Ae.a,{currency:P}),V]})]})]}),Object(I.jsx)(L.a,{layout:"vertical",children:Object(I.jsx)(L.a.Item,{label:Object(I.jsx)(i.b,{id:"Amount to distribute"}),style:{marginBottom:0},extra:Object(I.jsx)("div",{style:{color:g.text.primary,marginBottom:10},children:Object(I.jsx)(i.b,{id:"<0><1/>{netDistributionAmount}</0> after {feePercentage}% JBX fee",values:{netDistributionAmount:U,feePercentage:A},components:{0:Object(I.jsx)("span",{style:{fontWeight:500}}),1:Object(I.jsx)(Ae.a,{currency:P})}})}),children:Object(I.jsx)(Ie.a,{placeholder:"0",value:b,onChange:e=>O(e),accessory:Object(I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(I.jsx)("span",{style:{marginRight:8,color:g.text.primary},children:Object(q.b)(null===v||void 0===v?void 0:v.toNumber())}),Object(I.jsx)(Te.a,{content:Object(I.jsx)(i.b,{id:"MAX"}),onClick:()=>O(Object(G.e)(D))})]})})})}),Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"Payout recipients"})}),0===(null===h||void 0===h?void 0:h.length)?Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"There are no payouts defined for this funding cycle. The project owner will receive all available funds."})}):null,Object(I.jsx)(Ft.a,{totalValue:H,currency:v,splits:null!==h&&void 0!==h?h:[],projectOwnerAddress:f,showSplitValues:!0})]}),Object(I.jsxs)("p",{style:{fontSize:"0.8rem"},children:[Object(I.jsx)(F.a,{})," ",Object(I.jsx)(i.b,{id:"Recipients will receive payouts in ETH."})]})]})})}var _t=n(1704);const Ht={beneficiary:void 0,percent:0,preferClaimed:void 0,lockedUntil:void 0,projectId:void 0,allocator:void 0};var Vt=n(1331),Ut=n(1483),Jt=n(325),zt=n(1357);const Wt=({domain:e})=>{const{transactor:t,contracts:n}=Object(j.useContext)(y.a),{projectId:i}=Object(j.useContext)(d.a);return({groupedSplits:o},r)=>{const c={group:o.group,splits:o.splits.map(zt.a)};var s;return t&&i&&null!==n&&void 0!==n&&n.JBSplitsStore&&e?t(n.JBSplitsStore,"set",[i,e,[c]],r):(null===r||void 0===r||null===(s=r.onDone)||void 0===s||s.call(r),Promise.resolve(!1))}},qt=({splits:e})=>{var t;const{userAddress:n}=Object(j.useContext)(O.a),{distributionLimit:i,distributionLimitCurrency:o}=Object(j.useContext)(d.a),r=100-Object(Vt.e)(e),c=Object(j.useMemo)((()=>({...Ht,beneficiary:n,percent:Object(w.t)(r).toNumber()})),[r,n]),s=null!==(t=Object(q.b)(null===o||void 0===o?void 0:o.toNumber()))&&void 0!==t?t:"ETH",a=null===i||void 0===i?void 0:i.eq(w.c);return Object(I.jsx)(_t.a,{split:c,splits:e,distributionLimit:a?void 0:Object(G.b)(i,{thousandsSeparator:""}),currencyName:s,isLocked:!0,isProjectOwner:!0})},Gt=e=>{const t=(new Date).valueOf()/1e3,{payoutSplits:n}=Object(j.useContext)(d.a),i=void 0!==(null===n||void 0===n?void 0:n.find((t=>Object(Jt.isEqual)(t,e))));return e.lockedUntil&&e.lockedUntil>t&&i},Yt=()=>Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Reconfigure payouts as percentages of your distribution limit."})}),$t=()=>{const{theme:{colors:e}}=Object(j.useContext)(u.a);return Object(I.jsx)("p",{children:Object(I.jsxs)(r.b,{size:"small",children:[Object(I.jsx)(F.a,{style:{color:e.text.warn}}),Object(I.jsx)(i.b,{id:"Changes to payouts will take effect immediately."})]})})},Xt=({style:e})=>{const{fundingCycle:t,distributionLimit:n,distributionLimitCurrency:o,loading:{distributionLimitLoading:r,fundingCycleLoading:c}}=Object(j.useContext)(d.a),s=Object(k.g)(),a=Object(q.b)(null===o||void 0===o?void 0:o.toNumber()),l=null===n||void 0===n?void 0:n.eq(w.c),u=r&&c;return Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...e},children:[Object(I.jsx)(ze.a,{loading:u,paragraph:{rows:1,width:["80%"]},title:!1,active:!0,children:Object(I.jsxs)("b",{children:[Object(I.jsx)(i.b,{id:"Cycle #{0} -",values:{0:null===t||void 0===t?void 0:t.number.toString()}})," ",l?ee.a._("No limit (infinite)"):Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(i.b,{id:"Distribution limit: <0/>{0}",values:{0:Object(G.b)(n)},components:{0:Object(I.jsx)(Ae.a,{currency:a})}})})]})}),Object(I.jsx)(D.a,{size:"small",icon:Object(I.jsx)(ot.a,{}),onClick:()=>{s.push({search:"?reconfigModalOpen=true&fundingDrawerOpen=true"}),s.go(0)},children:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Reconfigure payouts and limit"})})})]})},Kt=({visible:e,onOk:t,onCancel:n})=>{var o,c;const{theme:{colors:s}}=Object(j.useContext)(u.a),{payoutSplits:a,fundingCycle:l,distributionLimitCurrency:b,distributionLimit:O}=Object(j.useContext)(d.a),x=Wt({domain:null===l||void 0===l||null===(o=l.configuration)||void 0===o?void 0:o.toString()}),[p,m]=Object(j.useState)(!1),v=null!==(c=Object(q.b)(null===b||void 0===b?void 0:b.toNumber()))&&void 0!==c?c:"ETH",[h,f]=Object(j.useState)([]);Object(j.useEffect)((()=>{f(null!==a&&void 0!==a?a:[])}),[a,e]);const y=Object(j.useMemo)((()=>h.filter((e=>Gt(e)))),[h]),g=Object(j.useMemo)((()=>h.filter((e=>!Gt(e)))),[h]),[C,k]=Object(j.useState)(!1),S=Object(j.useMemo)((()=>Object(Vt.e)(h)),[h]),T=S>100,R=100-S>0&&(null===O||void 0===O?void 0:O.gt(0)),P=Object(j.useCallback)((async e=>{if(T)return;m(!0);await x({groupedSplits:{group:J.a,splits:e}},{onConfirmed:()=>{m(!1),t()},onError:()=>m(!1)})||m(!1)}),[t,x,T]),E=Object(j.useCallback)((e=>{f(e)}),[]),L=Object(j.useCallback)(((e,t,n)=>{var i;const o=null===O||void 0===O?void 0:O.eq(w.c);return Object(I.jsx)(_t.a,{editInputMode:"Percentage",split:e,splits:h,distributionLimit:o?void 0:Object(G.b)(O,{thousandsSeparator:""}),currencyName:v,isLocked:n,onSplitsChanged:E,onSplitDelete:e=>{const t=Object(Jt.filter)(g,(t=>t.beneficiary!==e.beneficiary));E(t.concat(y))}},null!==(i=e.beneficiary)&&void 0!==i?i:t)}),[O,h,v,E,g,y]);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(te.a,{visible:e,confirmLoading:p,title:"Edit payouts",okText:"Save payouts",cancelText:p?"Close":"Cancel",onOk:()=>P(h),onCancel:n,width:720,children:[Object(I.jsxs)("div",{children:[Object(I.jsx)(Yt,{}),Object(I.jsx)($t,{})]}),Object(I.jsx)(Xt,{style:{marginTop:32,marginBottom:16}}),Object(I.jsxs)(r.b,{direction:"vertical",style:{width:"100%",minHeight:0},size:"large",children:[Object(I.jsx)(r.b,{style:{width:"100%"},direction:"vertical",size:"small",children:g.map(((e,t)=>L(e,t)))}),y?Object(I.jsx)(r.b,{style:{width:"100%"},direction:"vertical",size:"small",children:y.map(((e,t)=>L(e,t,!0)))}):null,R?Object(I.jsx)(qt,{splits:h}):null,T&&Object(I.jsx)("span",{style:{color:s.text.failure},children:Object(I.jsx)(i.b,{id:"Sum of percentages cannot exceed 100%."})}),Object(I.jsx)("div",{style:{display:"flex",justifyContent:"space-between",color:s.text.secondary},children:Object(I.jsx)("div",{style:{color:S>100?s.text.warn:s.text.secondary},children:Object(I.jsx)(i.b,{id:"Total: {0}%",values:{0:S.toFixed(2)}})})}),Object(I.jsx)(D.a,{type:"dashed",onClick:()=>{k(!0)},block:!0,children:Object(I.jsx)(i.b,{id:"Add payout"})})]})]}),Object(I.jsx)(Ut.a,{visible:C,onSplitsChanged:E,mode:"Add",splits:h,currencyName:v,onClose:()=>k(!1)})]})};function Qt({hideDistributeButton:e,payoutSplits:t,distributionLimitCurrency:n,distributionLimit:o,fundingCycleDuration:c}){const{usedDistributionLimit:s,projectOwnerAddress:a,balanceInDistributionLimitCurrency:l,isPreviewMode:u,loading:b}=Object(j.useContext)(d.a),O=Object(Nt.a)(),[x,p]=Object(j.useState)(),[m,f]=Object(j.useState)(!1),y=b.ETHBalanceLoading||b.distributionLimitLoading||b.balanceInDistributionLimitCurrencyLoading||b.usedDistributionLimitLoading,g=Object(It.b)({timeSeconds:null===c||void 0===c?void 0:c.toNumber(),fullWords:!0}),C=null===c||void 0===c?void 0:c.gt(0),k=h(v.SET_SPLITS);return Object(I.jsxs)(Ct.a,{children:[Object(I.jsxs)(r.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[e?null:Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[Object(I.jsx)(ze.a,{loading:y,active:!0,title:!1,paragraph:{rows:2,width:["60%","60%"]},children:Object(I.jsx)(At.a,{hasFundingTarget:null===o||void 0===o?void 0:o.gt(0),currency:Object(q.b)(null===n||void 0===n?void 0:n.toNumber()),projectBalanceInCurrency:l,targetAmount:null!==o&&void 0!==o?o:M.a.from(0),distributedAmount:null!==s&&void 0!==s?s:M.a.from(0),feePercentage:O?Object(w.k)(O):void 0,ownerAddress:a})}),Object(I.jsx)(D.a,{type:"ghost",size:"small",onClick:()=>p(!0),disabled:u,children:Object(I.jsx)(i.b,{id:"Distribute funds"})})]}),Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[Object(I.jsx)(Ze.a,{label:Object(I.jsx)("h4",{style:{display:"inline-block"},children:Object(I.jsx)(i.b,{id:"Funding distribution"})}),tip:Object(I.jsx)(i.b,{id:"Available funds can be distributed according to the payouts below{0}.",values:{0:C?` every ${g}`:null}})}),k&&Object(I.jsx)(D.a,{size:"small",onClick:()=>f(!0),icon:Object(I.jsx)(ot.a,{}),style:{marginBottom:"1rem"},children:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Edit payouts"})})})]}),t?Object(I.jsx)(Ft.a,{splits:t,currency:n,totalValue:o,projectOwnerAddress:a,showSplitValues:!(null!==o&&void 0!==o&&o.eq(w.c)),valueFormatProps:{precision:4}}):null]})]}),Object(I.jsx)(Mt,{visible:x,onCancel:()=>p(!1),onConfirmed:()=>window.location.reload()}),Object(I.jsx)(Kt,{visible:m,onCancel:()=>f(!1),onOk:()=>f(!1)})]})}function Zt({projectId:e,reservedRate:t}){return Object(m.a)({contract:x.a.JBController,functionName:"reservedTokenBalanceOf",args:e&&t?[e,t]:null})}function en({visible:e,onCancel:t,onConfirmed:n}){const{tokenSymbol:o,reservedTokensSplits:c,projectOwnerAddress:s,fundingCycleMetadata:a,projectId:l}=Object(j.useContext)(d.a),[u,b]=Object(j.useState)(),[O,x]=Object(j.useState)(),p=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({memo:i=""},o)=>{var r;return e&&n&&null!==t&&void 0!==t&&t.JBController?(console.log(t.JBController,222222222222),e(t.JBController,"distributeReservedTokensOf",[n,i],o)):(null===o||void 0===o||null===(r=o.onDone)||void 0===r||r.call(o),Promise.resolve(!1))}}(),{data:m}=Zt({projectId:l,reservedRate:null===a||void 0===a?void 0:a.reservedRate});const v=Object(G.b)(m,{precision:0}),h=Object(Ve.a)({tokenSymbol:o,capitalize:!1,plural:!0}),f=Object(Ve.a)({tokenSymbol:o,capitalize:!0,plural:!1});return Object(I.jsx)(B.a,{title:Object(I.jsx)(i.b,{id:"Distribute reserved {tokenTextPlural}",values:{tokenTextPlural:h}}),visible:e,onOk:()=>async function(){b(!0),await p({},{onDone:()=>{x(!0)},onConfirmed:()=>{b(!1),x(!1),null===n||void 0===n||n()}})||(b(!1),x(!1))}(),okText:ee.a._("Distribute {tokenTextPlural}",{tokenTextPlural:h}),connectWalletText:ee.a._("Connect wallet to distribute"),confirmLoading:u,transactionPending:O,onCancel:t,okButtonProps:{disabled:!(null!==m&&void 0!==m&&m.gt(0))},width:640,centered:!0,children:Object(I.jsxs)(r.b,{direction:"vertical",style:{width:"100%"},size:"large",children:[Object(I.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:Object(I.jsx)(i.b,{id:"Reserved {tokenTextPlural}: <0>{reservedTokensFormatted} {tokenTextPlural}</0>",values:{tokenTextPlural:h,reservedTokensFormatted:v},components:{0:Object(I.jsx)("span",{})}})}),Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"{tokenTextSingular} recipients",values:{tokenTextSingular:f}})}),0===(null===c||void 0===c?void 0:c.length)?Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"There are no reserved token recipients defined for this funding cycle. The project owner will receive all available tokens."})}):null,Object(I.jsx)(Ft.a,{splits:null!==c&&void 0!==c?c:[],projectOwnerAddress:s,totalValue:m,valueSuffix:h,showSplitValues:!0,valueFormatProps:{precision:0}})]})]})})}var tn=n(363);const nn=({visible:e,onOk:t,onCancel:n})=>{var o,r;const{reservedTokensSplits:c,fundingCycleMetadata:s,fundingCycle:a}=Object(j.useContext)(d.a),l=null===s||void 0===s?void 0:s.reservedRate,u=Wt({domain:null===a||void 0===a||null===(o=a.configuration)||void 0===o?void 0:o.toString()}),[b,O]=Object(j.useState)([]),[x,p]=Object(j.useState)(!1);Object(j.useEffect)((()=>{c&&O(c)}),[c]);const m=Object(j.useMemo)((()=>{var e;return null!==(e=null===b||void 0===b?void 0:b.map((e=>Object(w.q)(e.percent))).reduce(((e,t)=>e+t),0))&&void 0!==e?e:0}),[b])>100,v=Object(j.useCallback)((async()=>{if(m)return;p(!0);await u({groupedSplits:{group:J.b,splits:null!==b&&void 0!==b?b:[]}},{onConfirmed:()=>{p(!1),t()},onError:()=>p(!1)})||(Object(Re.a)("Token allocation edit failed"),p(!1))}),[b,t,u,m]);return Object(I.jsxs)(te.a,{visible:e,confirmLoading:x,title:ee.a._("Edit reserved token allocation"),okText:ee.a._("Save token allocation"),cancelText:x?ee.a._("Close"):ee.a._("Cancel"),width:720,onOk:()=>v(),onCancel:n,okButtonProps:{disabled:m},children:[Object(I.jsx)(tn.a,{style:{marginBottom:"1rem"},children:Object(I.jsx)(i.b,{id:"Changes to your reserved token allocation will take effect immediately."})}),Object(I.jsx)(L.a,{layout:"vertical",children:Object(I.jsx)(be.a.ProjectTicketMods,{mods:b.map(zt.b),onModsChanged:e=>O(e.map(zt.c)),formItemProps:{label:Object(I.jsx)(i.b,{id:"Reserved token allocation"}),extra:Object(I.jsx)(i.b,{id:"Allocate a portion of your project's reserved tokens to other Ethereum wallets or Juicebox projects."})},reservedRate:null!==(r=null===l||void 0===l?void 0:l.toNumber())&&void 0!==r?r:0})})]})};function on({hideDistributeButton:e,reservedTokensSplits:t,reservedRate:n}){const{tokenSymbol:o,tokenAddress:c,projectOwnerAddress:s,projectId:a,isPreviewMode:l}=Object(j.useContext)(d.a),{theme:{colors:b}}=Object(j.useContext)(u.a),[O,x]=Object(j.useState)(),[p,m]=Object(j.useState)(!1),{data:f,loading:y}=Zt({projectId:a,reservedRate:n}),g=h(v.SET_SPLITS),C={fontSize:".7rem",fontWeight:500,cursor:"default",color:b.text.secondary},k=Object(Ve.a)({tokenSymbol:o,capitalize:!1,plural:!0}),S=Object(Ve.a)({tokenSymbol:o,capitalize:!0,plural:!1});return Object(I.jsxs)(Ct.a,{children:[Object(I.jsxs)(r.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[e?null:Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"10px"},children:[Object(I.jsxs)("div",{style:{marginRight:"3rem"},children:[Object(I.jsx)(ze.a,{active:!0,loading:!l&&y,paragraph:{rows:1,width:20},title:!1,style:{display:"inline"},children:Object(I.jsx)("span",{style:{fontSize:"1rem",fontWeight:500},children:Object(G.b)(f,{precision:0})})})," ",Object(I.jsx)(Ze.a,{style:{...C,whiteSpace:"nowrap"},label:Object(I.jsx)("span",{style:{textTransform:"uppercase"},children:Object(I.jsx)(i.b,{id:"{tokensText} reserved",values:{tokensText:k}})}),tip:Object(I.jsx)(i.b,{id:"The amount of tokens this project has reserved. These tokens can be distributed to reserved token beneficiaries."})}),c&&c!==ne.a?Object(I.jsxs)("div",{style:C,children:[S," contract address:"," ",Object(I.jsx)(Fe.a,{address:c})]}):null]}),Object(I.jsx)(D.a,{type:"ghost",size:"small",onClick:()=>x(!0),disabled:l,children:Object(I.jsx)(i.b,{id:"Distribute {tokensText}",values:{tokensText:k}})})]}),Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[Object(I.jsx)(Ze.a,{label:Object(I.jsxs)("h4",{style:{display:"inline-block"},children:[Object(I.jsx)(i.b,{id:"Reserved {tokensText}",values:{tokensText:k}})," (",Object(w.n)(n),"%)"]}),tip:Object(I.jsx)(i.b,{id:"A project can reserve a percentage of tokens minted from every payment it receives. Reserved tokens can be distributed according to the allocation below at any time."})}),g&&null!==n&&void 0!==n&&n.gt(0)?Object(I.jsx)(D.a,{size:"small",onClick:()=>m(!0),icon:Object(I.jsx)(ot.a,{}),style:{marginBottom:"1rem"},children:Object(I.jsx)("span",{children:Object(I.jsx)(i.b,{id:"Edit allocation"})})}):null]}),t?Object(I.jsx)(Ft.a,{splits:t,projectOwnerAddress:s,totalValue:void 0,reservedRate:parseFloat(Object(w.n)(n))}):null]})]}),Object(I.jsx)(en,{visible:O,onCancel:()=>x(!1),onConfirmed:()=>window.location.reload()}),Object(I.jsx)(nn,{visible:p,onOk:()=>m(!1),onCancel:()=>m(!1)})]})}function rn({expandCard:e}){const{fundingCycle:t,payoutSplits:n,distributionLimitCurrency:i,distributionLimit:o,reservedTokensSplits:r,fundingCycleMetadata:c}=Object(j.useContext)(d.a);if(!t)return Object(I.jsx)(wt.a,{});const s=null===c||void 0===c?void 0:c.reservedRate;return Object(I.jsxs)("div",{children:[Object(I.jsx)(Ct.a,{children:Object(I.jsx)(kt.a,{fundingCycleNumber:t.number,fundingCycleDetails:Object(I.jsx)(Lt,{fundingCycle:t,fundingCycleMetadata:c,distributionLimit:o,distributionLimitCurrency:i}),fundingCycleDurationSeconds:t.duration,fundingCycleStartTime:t.start,isFundingCycleRecurring:!0,fundingCycleRiskCount:Object(W.a)(t),expand:e})}),Object(I.jsx)(Qt,{payoutSplits:n,distributionLimitCurrency:i,distributionLimit:o,fundingCycleDuration:t.duration}),Object(I.jsx)(on,{reservedTokensSplits:r,reservedRate:s})]})}var cn=n(175),sn=n(394),an=n(208),ln=n(976),dn=n(1428),jn=n(1981),un=n(1982),bn=n(1983),On=n(1427),xn=n(75);function pn({visible:e,onFinish:t}){const[n]=Object(je.useForm)(),[o,r]=Object(j.useState)(),{projectMetadata:c}=Object(j.useContext)(d.a),{colors:s}=Object(j.useContext)(u.a).theme,a=C();const l=Object(j.useCallback)((()=>{var e,t,i,o,r,s,a,l;n.setFieldsValue({name:null!==(e=null===c||void 0===c?void 0:c.name)&&void 0!==e?e:"",infoUri:null!==(t=null===c||void 0===c?void 0:c.infoUri)&&void 0!==t?t:"",logoUri:null!==(i=null===c||void 0===c?void 0:c.logoUri)&&void 0!==i?i:"",description:null!==(o=null===c||void 0===c?void 0:c.description)&&void 0!==o?o:"",twitter:null!==(r=null===c||void 0===c?void 0:c.twitter)&&void 0!==r?r:"",discord:null!==(s=null===c||void 0===c?void 0:c.discord)&&void 0!==s?s:"",payButton:null!==(a=null===c||void 0===c?void 0:c.payButton)&&void 0!==a?a:"",payDisclosure:null!==(l=null===c||void 0===c?void 0:c.payDisclosure)&&void 0!==l?l:""})}),[null===c||void 0===c?void 0:c.name,null===c||void 0===c?void 0:c.infoUri,null===c||void 0===c?void 0:c.logoUri,null===c||void 0===c?void 0:c.description,null===c||void 0===c?void 0:c.twitter,null===c||void 0===c?void 0:c.discord,null===c||void 0===c?void 0:c.payDisclosure,null===c||void 0===c?void 0:c.payButton,n]);return Object(j.useEffect)((()=>{l()}),[l]),Object(I.jsxs)(le.a,{visible:e,...xe.a,onClose:t,children:[Object(I.jsx)("h3",{children:Object(I.jsx)(i.b,{id:"Reconfigure project details"})}),Object(I.jsx)("p",{style:{color:s.text.primary},children:Object(I.jsx)(i.b,{id:"Project details reconfigurations will create a separate transaction."})}),Object(I.jsx)("br",{}),Object(I.jsx)(On.a,{form:n,onFinish:async function(){r(!0);const e=n.getFieldsValue(!0),i=await Object(rt.j)({name:e.name,description:e.description,logoUri:e.logoUri,infoUri:e.infoUri,twitter:e.twitter,discord:e.discord,payButton:e.payButton.substring(0,xn.a),payDisclosure:e.payDisclosure});i.IpfsHash?a({cid:i.IpfsHash},{onDone:()=>r(!1),onConfirmed:()=>{t&&t(),n.resetFields()}}):r(!1)},hideProjectHandle:!0,loading:o})]})}function mn(){const{fundingCycle:e}=Object(j.useContext)(d.a);if(!e)return null;const t=e.number.toNumber(),n=Object(Rt.a)(e.ballot),o=n.durationSeconds,r=e.duration.toNumber(),c=Object(It.f)(e.start.add(r));return r&&0!==r?void 0===o?Object(I.jsx)(i.b,{id:"Changes will take effect according to the project's custom ballot contract."}):o>c?Object(I.jsx)(i.b,{id:"Changes you make will take effect according to your <0>{0}</0> reconfiguration rule (the first funding cycle following <1>{1}</1> from now).",values:{0:n.name,1:Object(It.b)({timeSeconds:M.a.from(o),fullWords:!0})},components:{0:Object(I.jsx)("strong",{}),1:Object(I.jsx)("strong",{})}}):Object(I.jsx)(i.b,{id:"Any changes you make will take effect in <0>funding cycle #{0}</0>. The current funding cycle (#{currentFCNumber}) won't be altered.",values:{0:t+1,currentFCNumber:t},components:{0:Object(I.jsx)("strong",{})}}):Object(I.jsx)(i.b,{id:"You don't have a funding cycle duration. Changes you make will take effect immediately."})}var vn=n(359);const hn=({editingProjectData:e,exit:t})=>{const{editingPayoutGroupedSplits:n,editingReservedTokensGroupedSplits:i,editingFundingCycleMetadata:o,editingFundingCycleData:r,editingFundAccessConstraints:c}=e,s=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({fundingCycleData:i,fundingCycleMetadata:o,fundAccessConstraints:r,groupedSplits:c=[],mustStartAtOrAfter:s="1"},a)=>{var l;return e&&n&&null!==t&&void 0!==t&&t.JBController?e(t.JBController,"reconfigureFundingCyclesOf",[n,i,o,s,c,r,""],a):(null===a||void 0===a||null===(l=a.onDone)||void 0===l||l.call(a),Promise.resolve(!1))}}(),[a,l]=Object(j.useState)(!1);return{reconfigureLoading:a,reconfigureFundingCycle:Object(j.useCallback)((async()=>{if(l(!0),!(r&&o&&c))throw l(!1),new Error("Error deploying project.");await s({fundingCycleData:r,fundingCycleMetadata:o,fundAccessConstraints:c,groupedSplits:[n,i]},{onDone(){console.info("Reconfigure transaction executed. Awaiting confirmation...")},onConfirmed(){l(!1),t()}})||l(!1)}),[c,r,o,n,i,t,s])}};var fn=n(361);function yn({title:e,reconfigureHasChanges:t,onClick:n}){const{colors:i,radii:o}=Object(j.useContext)(u.a).theme;return Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",cursor:"pointer",padding:10,fontWeight:500,borderRadius:o.sm,border:"1px solid "+(t?i.stroke.action.primary:i.stroke.action.secondary)},onClick:n,children:[Object(I.jsx)("div",{children:e}),Object(I.jsx)("div",{children:Object(I.jsx)(ln.a,{})})]})}i.b;function gn({visible:e,onOk:t,onCancel:n,hideProjectDetails:o}){const c=Object(k.h)(),s=new URLSearchParams(c.search),a=Boolean(s.get("fundingDrawerOpen")),{initialEditingData:l}=(e=>{var t,n;const[i,o]=Object(j.useState)(),{contracts:r}=Object(j.useContext)(y.a),c=Object(fn.a)(),{projectId:s,primaryTerminal:a,fundingCycle:l,payoutSplits:u,reservedTokensSplits:b,distributionLimit:O,distributionLimitCurrency:x}=Object(j.useContext)(d.a),{data:p}=f({projectId:s}),[m]=null!==p&&void 0!==p?p:[],{data:v}=Object(U.a)({projectId:s,splitGroup:J.a,domain:null===m||void 0===m||null===(t=m.configuration)||void 0===t?void 0:t.toString()}),{data:h}=Object(U.a)({projectId:s,splitGroup:J.b,domain:null===m||void 0===m||null===(n=m.configuration)||void 0===n?void 0:n.toString()}),{data:g}=Object(H.a)({projectId:s,configuration:null===m||void 0===m?void 0:m.configuration.toString(),terminal:a}),[C,k]=null!==g&&void 0!==g?g:[],w=null!==m&&void 0!==m&&m.number.gt(0)?m:l,S=null!==m&&void 0!==m&&m.number.gt(0)?v:u,T=null!==m&&void 0!==m&&m.number.gt(0)?h:b;let I=O;null!==w&&void 0!==w&&w.duration.gt(0)&&C&&(I=C);let R=x;return null!==w&&void 0!==w&&w.duration.gt(0)&&k&&(R=k),Object(j.useEffect)((()=>{if(!e||!w)return;let t;if(I){var n,i,s;const e=null!==(n=null===(i=R)||void 0===i?void 0:i.toNumber())&&void 0!==n?n:q.c;t={terminal:null!==(s=null===r||void 0===r?void 0:r.JBETHPaymentTerminal.address)&&void 0!==s?s:"",token:X.a,distributionLimit:Object(G.e)(I),distributionLimitCurrency:e===q.a?q.c.toString():e.toString(),overflowAllowance:"0",overflowAllowanceCurrency:"0"}}const a=t?[t]:[];c(an.f.setFundAccessConstraints(t?[t]:[]));const l=Object(yt.e)(w);c(an.f.setFundingCycleData(Object(yt.e)(w)));const d=w.metadata?Object(yt.f)(Object(W.b)(w.metadata)):an.d;null!==w&&void 0!==w&&w.metadata&&c(an.f.setFundingCycleMetadata(Object(yt.f)(Object(W.b)(w.metadata)))),c(an.f.setPayoutSplits(null!==S&&void 0!==S?S:[])),c(an.f.setReservedTokensSplits(null!==T&&void 0!==T?T:[])),o({fundAccessConstraints:a,fundingCycleData:l,fundingCycleMetadata:d,payoutGroupedSplits:{payoutGroupedSplits:null!==S&&void 0!==S?S:[],reservedTokensGroupedSplits:null!==T&&void 0!==T?T:[]}})}),[r,w,S,T,I,R,l,e,c]),{initialEditingData:i}})(e),u=(()=>{const{payoutGroupedSplits:e,reservedTokensGroupedSplits:t}=Object(vn.a)((e=>e.editingV2Project));return{editingPayoutGroupedSplits:e,editingReservedTokensGroupedSplits:t,editingFundingCycleMetadata:Object(vn.e)(),editingFundingCycleData:Object(vn.d)(),editingFundAccessConstraints:Object(vn.c)()}})(),{fundingHasSavedChanges:b,fundingDrawerHasSavedChanges:O,tokenDrawerHasSavedChanges:x,rulesDrawerHasSavedChanges:p}=(({editingProjectData:e,initialEditingData:t})=>{const{editingPayoutGroupedSplits:n,editingReservedTokensGroupedSplits:i,editingFundingCycleMetadata:o,editingFundingCycleData:r,editingFundAccessConstraints:c}=e;return{fundingHasSavedChanges:Object(j.useMemo)((()=>{if(!t)return!1;const e={fundAccessConstraints:c.map(yt.d),fundingCycleMetadata:Object(yt.f)(o),fundingCycleData:Object(yt.e)(r),payoutGroupedSplits:{payoutGroupedSplits:n.splits,reservedTokensGroupedSplits:i.splits}};return!Object(Jt.isEqual)(t,e)}),[c,r,o,n,i,t]),fundingDrawerHasSavedChanges:Object(j.useMemo)((()=>{var e,i,o,s;const a=Object(yt.e)(r),l=c.length?Object(yt.d)(null===c||void 0===c?void 0:c[0]):void 0,d=n.splits;if(!l||!t)return!1;const j=a.duration!==t.fundingCycleData.duration,u=l.distributionLimit!==(null===(e=t.fundAccessConstraints)||void 0===e?void 0:e[0].distributionLimit),b=l.distributionLimitCurrency!==(null===(i=t.fundAccessConstraints)||void 0===i?void 0:i[0].distributionLimitCurrency),O=!Object(Jt.isEqual)(d,null!==(o=null===(s=t.payoutGroupedSplits)||void 0===s?void 0:s.payoutGroupedSplits)&&void 0!==o?o:[]);return j||u||b||O}),[c,r,n.splits,t]),tokenDrawerHasSavedChanges:Object(j.useMemo)((()=>{var e;const n=Object(yt.e)(r),s=Object(yt.f)(o),a=c.length?Object(yt.d)(null===c||void 0===c?void 0:c[0]):void 0,l=i.splits;if(!a||!t)return!1;const d=s.reservedRate!==t.fundingCycleMetadata.reservedRate,j=!Object(Jt.isEqual)(l,null!==(e=t.payoutGroupedSplits.reservedTokensGroupedSplits)&&void 0!==e?e:[]),u=n.discountRate!==t.fundingCycleData.discountRate,b=s.redemptionRate!==t.fundingCycleMetadata.redemptionRate;return d||j||u||b}),[c,r,o,i.splits,t]),rulesDrawerHasSavedChanges:Object(j.useMemo)((()=>{const e=Object(yt.e)(r),n=Object(yt.f)(o);if(!(c.length?Object(yt.d)(null===c||void 0===c?void 0:c[0]):void 0)||!t)return!1;const i=n.pausePay!==t.fundingCycleMetadata.pausePay,s=n.allowMinting!==t.fundingCycleMetadata.allowMinting,a=e.ballot!==t.fundingCycleData.ballot;return i||s||a}),[c,r,o,t])}})({editingProjectData:u,initialEditingData:l}),{reconfigureLoading:m,reconfigureFundingCycle:v}=hn({editingProjectData:u,exit:t}),[h,g]=Object(j.useState)(!1),[C,w]=Object(j.useState)(!1),[S,T]=Object(j.useState)(a),[R,P]=Object(j.useState)(!1),[E,D]=Object(j.useState)(!1),L=()=>{T(!1),P(!1),D(!1)},[A,F]=Object(j.useState)(!1),N=()=>F(!1),B=Object(j.useCallback)((()=>{if(!b)return n();F(!0)}),[b,n]);return Object(I.jsxs)(te.a,{title:Object(I.jsx)(i.b,{id:"Project configuration"}),visible:e,onOk:v,onCancel:B,okText:ee.a._("Deploy funding cycle configuration"),okButtonProps:{disabled:!b,style:{marginBottom:"15px"}},confirmLoading:m,width:650,style:{paddingBottom:20,paddingTop:20},centered:!0,destroyOnClose:!0,children:[Object(I.jsxs)(r.b,{direction:"vertical",size:"middle",style:{width:"100%",marginBottom:40},children:[!o&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h4",{style:{marginBottom:0},children:Object(I.jsx)(i.b,{id:"Edit project details"})}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Changes to project details will take effect immediately."})})]}),!o&&Object(I.jsx)(yn,{reconfigureHasChanges:!1,title:ee.a._("Project handle"),onClick:()=>g(!0)}),!o&&Object(I.jsx)(yn,{reconfigureHasChanges:!1,title:ee.a._("Other details"),onClick:()=>w(!0)}),Object(I.jsx)(de.a,{}),Object(I.jsx)("h4",{style:{marginBottom:0},children:Object(I.jsx)(i.b,{id:"Reconfigure upcoming funding cycles"})}),Object(I.jsx)("p",{children:Object(I.jsx)(mn,{})}),Object(I.jsx)(yn,{title:ee.a._("Distribution limit, duration and payouts"),reconfigureHasChanges:O,onClick:()=>T(!0)}),Object(I.jsx)(yn,{title:ee.a._("Token"),reconfigureHasChanges:x,onClick:()=>P(!0)}),Object(I.jsx)(yn,{title:ee.a._("Rules"),reconfigureHasChanges:p,onClick:()=>D(!0)})]}),Object(I.jsx)($,{payoutSplits:u.editingPayoutGroupedSplits.splits,reserveSplits:u.editingReservedTokensGroupedSplits.splits,fundingCycleMetadata:u.editingFundingCycleMetadata,fundingCycleData:u.editingFundingCycleData,fundAccessConstraints:u.editingFundAccessConstraints}),o?null:Object(I.jsx)(pn,{visible:C,onFinish:()=>w(!1)}),o?null:Object(I.jsx)(pe,{visible:h,onFinish:()=>g(!1)}),Object(I.jsx)(jn.a,{visible:S,onClose:L}),Object(I.jsx)(un.a,{visible:R,onClose:L}),Object(I.jsx)(bn.a,{visible:E,onClose:L}),Object(I.jsx)(dn.a,{visible:A,onOk:()=>{N(),n()},onCancel:N})]})}function Cn({hideProjectDetails:e,triggerButton:t}){var n,i,o;const r=Object(k.h)(),c=new URLSearchParams(r.search),s=Boolean(c.get("reconfigModalOpen")),a=Object(k.g)(),l=Object(cn.c)(),{projectId:u,fundingCycle:b,primaryTerminal:O}=Object(j.useContext)(d.a),[x,p]=Object(j.useState)(!1),m=Object(j.useRef)();function v(){m.current=Object(sn.b)(),p(!0)}s&&void 0===m.current&&(a.replace(Object(T.a)({projectId:u})),v());const{data:h}=f({projectId:u}),[y]=null!==h&&void 0!==h?h:[];let g;g=null===b||void 0===b||!b.duration||null!==b&&void 0!==b&&b.duration.eq(0)?b:y;const{data:C}=Object(H.a)({projectId:u,configuration:null===(n=g)||void 0===n?void 0:n.configuration.toString(),terminal:O}),[w,S]=null!==C&&void 0!==C?C:[],{data:R}=Object(U.a)({projectId:u,splitGroup:J.a,domain:null===(i=g)||void 0===i||null===(o=i.configuration)||void 0===o?void 0:o.toString()});return Object(j.useEffect)((()=>{var e,t;(C&&(l(an.f.setDistributionLimit(Object(G.e)(w))),l(an.f.setDistributionLimitCurrency(S.toNumber().toString()))),null!==(e=g)&&void 0!==e&&e.duration)&&l(an.f.setDuration(null===(t=g)||void 0===t?void 0:t.duration.toNumber().toString()));R&&l(an.f.setPayoutSplits(R))}),[C,l,g,w,S,R]),Object(I.jsxs)("div",{style:{textAlign:"right"},children:[t?t(v):Object(I.jsx)(pt.a,{title:ee.a._("Reconfigure project and funding details"),placement:"bottom",children:Object(I.jsx)(D.a,{onClick:v,icon:Object(I.jsx)(ot.a,{}),type:"text"})}),m.current&&Object(I.jsx)(cn.a,{store:m.current,children:Object(I.jsx)(gn,{visible:x,onOk:function(){p(!1),window.location.reload()},onCancel:()=>p(!1),hideProjectDetails:e})})]})}let kn;!function(e){e[e.active=0]="active",e[e.approved=1]="approved",e[e.failed=2]="failed"}(kn||(kn={}));const wn=()=>{const{projectId:e,fundingCycle:t}=Object(j.useContext)(d.a),{data:n}=function({projectId:e}){return Object(m.a)({contract:x.a.JBController,functionName:"latestConfiguredFundingCycleOf",args:e?[e]:null})}({projectId:e}),[i,o,r]=null!==n&&void 0!==n?n:[],c=i&&t&&t.number.eq(i.number),{data:s}=f({projectId:c?e:void 0}),[a,l]=null!==s&&void 0!==s?s:[],u=r===kn.failed;return(c||u)&&a?[a,l]:[i,o,r]};function Sn({expandCard:e}){var t,n;const{projectId:i,primaryTerminal:o}=Object(j.useContext)(d.a),[r,c,s]=wn(),{data:a}=Object(U.a)({projectId:i,splitGroup:J.a,domain:null===r||void 0===r||null===(t=r.configuration)||void 0===t?void 0:t.toString()}),{data:l}=Object(U.a)({projectId:i,splitGroup:J.b,domain:null===r||void 0===r||null===(n=r.configuration)||void 0===n?void 0:n.toString()}),{data:u}=Object(H.a)({projectId:i,configuration:null===r||void 0===r?void 0:r.configuration.toString(),terminal:o}),[b,O]=null!==u&&void 0!==u?u:[];if(!r)return Object(I.jsx)(wt.a,{});const x=null===c||void 0===c?void 0:c.reservedRate;return Object(I.jsxs)("div",{children:[Object(I.jsx)(Ct.a,{children:Object(I.jsx)(kt.a,{fundingCycleNumber:r.number,fundingCycleDetails:Object(I.jsx)(Lt,{fundingCycle:r,fundingCycleMetadata:c,distributionLimit:b,distributionLimitCurrency:O}),fundingCycleDurationSeconds:r.duration,fundingCycleStartTime:r.start,isFundingCycleRecurring:!0,fundingCycleRiskCount:Object(W.a)(r),expand:e,ballotState:s,ballotStrategyAddress:r.ballot})}),Object(I.jsx)(Qt,{payoutSplits:a,distributionLimitCurrency:O,distributionLimit:b,fundingCycleDuration:r.duration,hideDistributeButton:!0}),Object(I.jsx)(on,{reservedTokensSplits:l,reservedRate:x,hideDistributeButton:!0})]})}var Tn=n(1147),In=n(225),Rn=n.n(In),Pn=n(1705);function En({fundingCycle:e,numFundingCycles:t,index:n,onClick:o}){var c;const{projectId:s,primaryTerminal:a}=Object(j.useContext)(d.a),{theme:{colors:l}}=Object(j.useContext)(u.a),{data:b}=Object(H.a)({projectId:s,configuration:null===e||void 0===e||null===(c=e.configuration)||void 0===c?void 0:c.toString(),terminal:a}),{data:O}=Object(Pn.a)({projectId:s,terminal:a,fundingCycleNumber:null===e||void 0===e?void 0:e.number}),[x,p]=null!==b&&void 0!==b?b:[],m=null===x||void 0===x?void 0:x.eq(w.c),v=!x||(null===x||void 0===x?void 0:x.eq(0)),h=n<t-1;return Object(I.jsxs)("div",{role:"button",onClick:o,style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",cursor:"pointer",...h?{paddingBottom:20,borderBottom:"1px solid "+l.stroke.tertiary}:{}},children:[Object(I.jsxs)(r.b,{align:"baseline",children:[Object(I.jsxs)("h3",{children:["#",e.number.toString()]}),Object(I.jsxs)("div",{style:{fontSize:".8rem",marginLeft:10},children:[Object(I.jsx)(Ae.a,{currency:Object(q.b)(null===p||void 0===p?void 0:p.toNumber())}),m||v?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(i.b,{id:"{0} withdrawn",values:{0:Object(G.b)(O,{precision:2})}})}):Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(i.b,{id:"{0}/{1} withdrawn",values:{0:Object(G.b)(O,{precision:2}),1:Object(G.b)(x,{precision:2})}})})]})]}),Object(I.jsxs)(r.b,{align:"baseline",style:{fontSize:".8rem"},children:[Object(Be.b)(e.start.add(e.duration).mul(1e3).toNumber()),Object(I.jsx)(Tn.a,{})]})]},e.number.toString())}function Dn(){var e;const{projectId:t,fundingCycle:n,primaryTerminal:o}=Object(j.useContext)(d.a),{contracts:c}=Object(j.useContext)(y.a),[s,a]=Object(j.useState)(),[l,u]=Object(j.useState)([]),b=void 0!==s?l[s]:void 0,{data:O}=Object(H.a)({projectId:t,configuration:null===b||void 0===b||null===(e=b.configuration)||void 0===e?void 0:e.toString(),terminal:o}),[x,p]=null!==O&&void 0!==O?O:[];if(Object(j.useEffect)((()=>{(async()=>{if(!t||!n)return[];let e=[await(null===c||void 0===c?void 0:c.JBFundingCycleStore.get(t,n.configuration))],i=n.basedOn;for(;!i.eq(M.a.from(0));){const n=await(null===c||void 0===c?void 0:c.JBFundingCycleStore.get(t,i));n&&(e=[n].concat(e),i=n.basedOn)}const o=(({firstFCOfEachConfiguration:e,currentFundingCycle:t})=>{const n=[];return e.forEach(((i,o)=>{n.push(i);const r=i.start,c=o<e.length-1?e[o+1].start:t.start,s=i.duration,a=i.discountRate;let l;l=s&&!s.eq(0)?c.sub(r).div(s).toNumber():0;const d=o===e.length-1;let j=0,u=i.weight,b=i.start,O=i.number;const x=i;for(;j<l&&(d||j!==l-1);){const e=u.sub(u.mul(Object(w.j)(a)).div(100)),t=b.add(s),i=O.add(1),o={duration:x.duration,weight:e,discountRate:x.discountRate,ballot:x.ballot,number:i,configuration:x.configuration,start:t,metadata:x.metadata};u=e,b=t,O=i,j++,n.push(o)}})),n})({firstFCOfEachConfiguration:e,currentFundingCycle:n});return o.slice(0,-1).reverse()})().then((e=>{u(e)}))}),[c,t,n]),!t||!n||null===n||void 0===n||!n.number)return null;const m=l.length>=n.number.toNumber()-1,v=()=>Object(I.jsx)(r.b,{direction:"vertical",size:"large",style:{width:"100%",maxHeight:"80vh",overflow:"scroll"},children:l.length?l.map(((e,t)=>Object(I.jsx)(En,{fundingCycle:e,numFundingCycles:l.length,index:t,onClick:()=>a(t)},e.configuration.toString()))):Object(I.jsx)("div",{children:Object(I.jsx)(i.b,{id:"No past funding cycles"})})});return Object(I.jsxs)("div",{children:[Object(I.jsx)(v,{}),m?null:Object(I.jsx)(ke.a,{}),b&&Object(I.jsx)(Rn.a,{visible:Boolean(b),width:600,title:`Cycle #${b.number.toString()}`,onCancel:()=>a(void 0),onOk:()=>a(void 0),cancelButtonProps:{hidden:!0},okText:ee.a._("Done"),children:Object(I.jsx)(Lt,{fundingCycle:b,fundingCycleMetadata:Object(W.b)(b.metadata),distributionLimit:x,distributionLimitCurrency:p})})]})}function Ln(){return Object(I.jsxs)(r.b,{direction:"vertical",style:{width:"100%"},children:[Object(I.jsx)(we.a,{text:Object(I.jsx)(i.b,{id:"Funding cycle"}),tip:Object(I.jsx)(i.b,{id:"A project's lifetime is defined in funding cycles. If a funding target is set, the project can withdraw no more than the target for the duration of the cycle."}),style:{marginBottom:10}}),Object(I.jsx)(Ct.a,{children:Object(I.jsx)(i.b,{id:"No active funding cycle."})})]})}function An({expandCard:e}){const{theme:{colors:t}}=Object(j.useContext)(u.a),{fundingCycle:n,isPreviewMode:o,loading:{fundingCycleLoading:r},projectId:c}=Object(j.useContext)(d.a),s=h(v.RECONFIGURE),{data:a,loading:l}=f({projectId:c}),[b]=a||[];if(r||l&&!o||!n||!b&&!o)return Object(I.jsx)(ke.a,{});if(n.number.eq(0)&&null!==b&&void 0!==b&&b.number.eq(0))return Object(I.jsx)(Ln,{});const O=({text:e})=>n&&Object(W.a)(n)?Object(I.jsx)(pt.a,{title:Object(I.jsx)(i.b,{id:"This funding cycle may pose risks to contributors. Check the funding cycle details before paying this project."}),children:Object(I.jsxs)("span",{children:[e,Object(I.jsx)(F.a,{style:{color:t.text.warn,marginLeft:4}})]})}):e,x=Object(yt.e)(n),p=[n.number.gt(0)&&{key:"current",label:O({text:ee.a._("Current")}),content:Object(I.jsx)(rn,{expandCard:e})},!o&&(Object(W.f)(x)||n.number.eq(0))&&{key:"upcoming",label:O({text:ee.a._("Upcoming")}),content:Object(I.jsx)(Sn,{expandCard:e})},{key:"history",label:O({text:ee.a._("History")}),content:Object(I.jsx)(Ct.a,{children:Object(I.jsx)(Dn,{})})}].filter(Boolean);return Object(I.jsx)(gt.a,{tabs:p,reconfigureButton:s?Object(I.jsx)(Cn,{hideProjectDetails:!0,triggerButton:e=>Object(I.jsx)(D.a,{size:"small",onClick:e,icon:Object(I.jsx)(ot.a,{}),children:Object(I.jsx)("span",{children:Object(W.f)(x)?Object(I.jsx)(i.b,{id:"Reconfigure upcoming"}):Object(I.jsx)(i.b,{id:"Reconfigure"})})})}):null})}var Fn=n(1133),Nn=n(277);var Bn=n(649);function Mn(){const{userAddress:e}=Object(j.useContext)(O.a),{projectId:t}=Object(j.useContext)(d.a);return Object(m.a)({contract:x.a.JBTokenStore,functionName:"unclaimedBalanceOf",args:e&&t?[e,M.a.from(t).toHexString()]:null,valueDidChange:lt.b})}var _n=n(651),Hn=n(664),Vn=n(652);function Un({tokenAmount:e}){const{projectId:t,fundingCycle:n,fundingCycleMetadata:i,primaryTerminalCurrentOverflow:o,totalTokenSupply:r,ballotState:c}=Object(j.useContext)(d.a),{data:s}=Zt({projectId:t,reservedRate:null===i||void 0===i?void 0:i.reservedRate});if(!n)return;const a=s?null===r||void 0===r?void 0:r.add(s):r;if(!i||null===a||void 0===a||!a.gt(0)||!e)return M.a.from(0);const l=c===Vn.b.Active?i.ballotRedemptionRate:i.redemptionRate,u=Object(G.f)(e),b=a&&o?o.mul(u).div(a):M.a.from(0),O=l.add(u.mul(M.a.from(w.e).sub(l)).div(a));return b.mul(O).div(w.e)}const Jn={display:"flex",justifyContent:"space-between",alignItems:"baseline"};function zn({visible:e,onCancel:t,onConfirmed:n}){const{theme:{colors:o}}=Object(j.useContext)(u.a),{userAddress:c}=Object(j.useContext)(O.a),{tokenSymbol:s,fundingCycle:a,primaryTerminalCurrentOverflow:l,projectId:b,totalTokenSupply:x,distributionLimitCurrency:p,fundingCycleMetadata:m}=Object(j.useContext)(d.a),[v,h]=Object(j.useState)(),[f,g]=Object(j.useState)(),[C,k]=Object(j.useState)(),[S]=Object(je.useForm)(),{data:T}=dt(c,b),R=Un({tokenAmount:Object(G.e)(T)}),P=Un({tokenAmount:v}),E=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{userAddress:n}=Object(j.useContext)(O.a),{projectId:i}=Object(j.useContext)(d.a);return({redeemAmount:o,minReturnedTokens:r},c)=>{var s;return e&&n&&i&&null!==t&&void 0!==t&&t.JBETHPaymentTerminal?e(null===t||void 0===t?void 0:t.JBETHPaymentTerminal,"redeemTokensOf",[n,i,o,ne.a,r,n,"",0],c):(null===c||void 0===c||null===(s=c.onDone)||void 0===s||s.call(c),Promise.resolve(!1))}}();if(!a||!m)return null;const D=Object(G.a)(T,x),A=null!==p&&void 0!==p&&p.eq(q.e)?null===P||void 0===P?void 0:P.mul(1e3).div(1005):P,F=Object(Ve.a)({tokenSymbol:s,capitalize:!1,plural:!0,includeTokenWord:!0}),N=Object(Ve.a)({tokenSymbol:s,capitalize:!1,plural:!0});let M;M=null!==l&&void 0!==l&&l.gt(0)?ee.a._("Redeem {tokensTextLong} for ETH",{tokensTextLong:F}):ee.a._("Burn {tokensTextLong}",{tokensTextLong:F});const _=Object(G.b)(A,{precision:8})||"--";return Object(I.jsx)(B.a,{transactionPending:C,title:M,visible:e,confirmLoading:f,onOk:()=>{(async()=>{await S.validateFields(),A&&(g(!0),E({redeemAmount:Object(G.f)(v),minReturnedTokens:A},{onDone:()=>{k(!0),h(void 0)},onConfirmed:()=>{k(!1),g(!1),null===n||void 0===n||n()}}))})()},onCancel:()=>{h(void 0),null===t||void 0===t||t()},okText:M,okButtonProps:{disabled:!v||0===parseInt(v)},width:540,centered:!0,children:Object(I.jsxs)(r.b,{direction:"vertical",style:{width:"100%"},children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("p",{style:Jn,children:Object(I.jsx)(i.b,{id:"Redemption rate: <0>{0}%</0>",values:{0:Object(w.m)(m.redemptionRate)},components:{0:Object(I.jsx)("span",{})}})}),Object(I.jsx)("p",{style:Jn,children:Object(I.jsx)(i.b,{id:"{0} balance: <0><1>{1} {tokensTextShort}</1><2>({share}% of supply)</2></0>",values:{0:Object(Ve.a)({tokenSymbol:s,capitalize:!0}),1:Object(G.b)(null!==T&&void 0!==T?T:0,{precision:0}),tokensTextShort:N,share:D},components:{0:Object(I.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"}}),1:Object(I.jsx)("div",{}),2:Object(I.jsx)("div",{style:{cursor:"default",fontSize:"0.8rem",fontWeight:500,color:o.text.tertiary}})}})}),Object(I.jsx)("p",{style:Jn,children:Object(I.jsx)(i.b,{id:"Currently worth: <0><1/>{0}</0>",values:{0:Object(G.b)(R,{precision:4})},components:{0:Object(I.jsx)("span",{}),1:Object(I.jsx)(Ae.a,{currency:"ETH"})}})})]}),Object(I.jsx)("p",{children:null!==l&&void 0!==l&&l.gt(0)?Object(I.jsx)(i.b,{id:"Tokens can be redeemed for a portion of this project's ETH overflow, according to the redemption rate of the current funding cycle. <0>Tokens are burned when they are redeemed.</0>",components:{0:Object(I.jsx)("span",{style:{fontWeight:500,color:o.text.warn}})}}):Object(I.jsx)("span",{style:{fontWeight:500,color:o.text.warn},children:Object(I.jsx)(i.b,{id:"<0>This project has no overflow</0>, so you will not receive any ETH for burning tokens.",components:{0:Object(I.jsx)("strong",{})}})})}),Object(I.jsxs)("div",{children:[Object(I.jsx)(L.a,{form:S,children:Object(I.jsx)(Ie.a,{min:0,step:.001,placeholder:"0",value:v,accessory:Object(I.jsx)(Te.a,{content:ee.a._("MAX"),onClick:()=>h(Object(G.e)(T))}),formItemProps:{rules:[{validator:()=>{const e=Object(G.f)(null!==v&&void 0!==v?v:0);return e.eq(0)?Promise.reject(ee.a._("Required")):e.gt(null!==T&&void 0!==T?T:0)?Promise.reject(ee.a._("Balance exceeded")):Promise.resolve()}}]},disabled:null===T||void 0===T?void 0:T.eq(0),onChange:e=>h(e)})}),null!==l&&void 0!==l&&l.gt(0)?Object(I.jsx)("div",{style:{fontWeight:500,marginTop:20},children:null!==p&&void 0!==p&&p.eq(q.e)?Object(I.jsx)(i.b,{id:"You will receive minimum {minReturnedTokensFormatted} ETH",values:{minReturnedTokensFormatted:_}}):Object(I.jsx)(i.b,{id:"You will receive {minReturnedTokensFormatted} ETH",values:{minReturnedTokensFormatted:_}})}):null]})]})})}var Wn=n(5),qn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},Gn=n(21),Yn=function(e,t){return j.createElement(Gn.a,Object(Wn.a)(Object(Wn.a)({},e),{},{ref:t,icon:qn}))};Yn.displayName="WarningOutlined";var $n=j.forwardRef(Yn);function Xn({visible:e,onCancel:t,onConfirmed:n}){const[o,c]=Object(j.useState)(),[s,a]=Object(j.useState)(),[l,b]=Object(j.useState)(),{theme:{colors:x}}=Object(j.useContext)(u.a),{tokenSymbol:p,tokenAddress:m}=Object(j.useContext)(d.a),v=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{userAddress:n}=Object(j.useContext)(O.a),{projectId:i}=Object(j.useContext)(d.a);return({claimAmount:o},r)=>{var c;return e&&n&&i&&null!==t&&void 0!==t&&t.JBTokenStore?e(null===t||void 0===t?void 0:t.JBTokenStore,"claimFor",[n,i,o.toHexString()],r):(null===r||void 0===r||null===(c=r.onDone)||void 0===c||c.call(r),Promise.resolve(!1))}}(),{data:h}=Mn();Object(j.useLayoutEffect)((()=>{b(Object(G.e)(h))}),[h]);const f=!!m&&m!==ne.a,g=Object(Ve.a)({tokenSymbol:p,plural:!0,includeTokenWord:!0}),C=Object(Ve.a)({tokenSymbol:p,plural:!0});return Object(I.jsx)(B.a,{title:ee.a._("Claim {tokenTextShort} as ERC-20 tokens",{tokenTextShort:C}),connectWalletText:ee.a._("Connect wallet to claim"),visible:e,onOk:function(){l&&!Object(G.f)(l).eq(0)&&(c(!0),v({claimAmount:Object(G.f)(l)},{onDone:()=>{a(!0),c(!1)},onConfirmed:()=>{a(!1),null===n||void 0===n||n()}}))},okText:ee.a._("Claim {tokenTextShort}",{tokenTextShort:C}),confirmLoading:o,transactionPending:s,okButtonProps:{disabled:Object(G.f)(l).eq(0)},onCancel:t,width:600,centered:!0,children:Object(I.jsxs)(r.b,{direction:"vertical",size:"large",children:[!f&&Object(I.jsxs)("div",{style:{padding:10,background:x.background.l1},children:[Object(I.jsx)($n,{})," ",Object(I.jsx)(i.b,{id:"Tokens cannot be claimed because no ERC-20 token has been issued for this project. ERC-20 tokens must be issued by the project owner."})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Claiming {tokenTextLong} will convert your {tokenTextShort} balance to ERC-20 tokens and mint them to your wallet.",values:{tokenTextLong:g,tokenTextShort:C}})}),Object(I.jsx)("p",{style:{fontWeight:600},children:Object(I.jsx)(i.b,{id:"If you're unsure if you need to claim, you probably don't."})}),Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"You can redeem your {tokenTextLong} for overflow without claiming them. You can transfer your unclaimed {tokenTextLong} to another address from the Tools menu, which can be accessed from the wrench icon in the upper right hand corner of this project.",values:{tokenTextLong:g}})})]}),Object(I.jsxs)(St.b,{size:"small",layout:"horizontal",column:1,children:[Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"Your unclaimed {tokenTextLong}",values:{tokenTextLong:g}}),children:Object(G.b)(h,{precision:8})}),f&&p&&Object(I.jsx)(St.b.Item,{label:Object(I.jsx)(i.b,{id:"{tokenSymbol} ERC-20 address",values:{tokenSymbol:p}}),children:Object(I.jsx)(Fe.a,{address:m})})]}),Object(I.jsx)(L.a,{layout:"vertical",children:Object(I.jsx)(L.a.Item,{label:ee.a._("Amount of ERC-20 tokens to claim"),children:Object(I.jsx)(Ie.a,{min:0,max:parseFloat(Object(G.e)(h)),disabled:!f,placeholder:"0",value:l,accessory:Object(I.jsx)(Te.a,{content:ee.a._("MAX"),onClick:()=>b(Object(G.e)(h))}),onChange:e=>b(e)})})})]})})}var Kn=n(459),Qn=n(53);function Zn({visible:e,onCancel:t,onConfirmed:n}){const{tokenSymbol:o,tokenAddress:r}=Object(j.useContext)(d.a),c=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({value:i,beneficiary:o,preferClaimed:r,memo:c},s)=>{var a;if(!e||!t||!n)return null===s||void 0===s||null===(a=s.onDone)||void 0===a||a.call(s),Promise.resolve(!1);const l=t.JBController,d=[n,i.toHexString(),o,null!==c&&void 0!==c?c:"",r,!0];return e(l,"mintTokensOf",d,s)}}(),[s]=Object(je.useForm)(),[a,l]=Object(j.useState)("0"),[u,b]=Object(j.useState)(),[O,x]=Object(j.useState)();const p=o&&r&&r!==ne.a,m=Object(Ve.a)({tokenSymbol:o,capitalize:!1,plural:!0}),v=Object(Ve.a)({tokenSymbol:o,capitalize:!0,plural:!1});return Object(I.jsxs)(B.a,{visible:e,title:ee.a._("Mint {tokensTokenLower}",{tokensTokenLower:m}),onOk:async function(){const e=s.getFieldValue("beneficary");Object(Qn.isAddress)(e)&&(b(!0),await s.validateFields(),c({value:Object(G.f)(a),beneficiary:e,preferClaimed:s.getFieldValue("preferClaimed"),memo:s.getFieldValue("memo")},{onDone:()=>{b(!1),x(!0)},onConfirmed:()=>{s.resetFields(),l("0"),x(!1),null===n||void 0===n||n()}}))},confirmLoading:u,transactionPending:O,onCancel:t,okText:ee.a._("Mint {tokensTokenLower}",{tokensTokenLower:m}),children:[Object(I.jsx)("div",{style:{marginBottom:20},children:Object(I.jsx)(i.b,{id:"Note: Tokens can be minted manually when allowed in the current funding cycle. This can be changed by the project owner for upcoming cycles."})}),Object(I.jsxs)(L.a,{layout:"vertical",form:s,children:[Object(I.jsx)(L.a.Item,{label:ee.a._("Tokens receiver"),name:"beneficary",rules:[{required:!0,validator:(e,t)=>t&&Object(Qn.isAddress)(t)?Promise.resolve():Promise.reject("Not a valid ETH address")}],children:Object(I.jsx)(A.a,{placeholder:ne.a})}),Object(I.jsx)(Ie.a,{formItemProps:{label:ee.a._("{tokensTokenUpper} amount",{tokensTokenUpper:v}),extra:ee.a._("The amount of tokens to mint to the receiver."),rules:[{required:!0}]},value:a,onChange:e=>l(null!==e&&void 0!==e?e:"0")}),Object(I.jsx)("br",{}),Object(I.jsx)(L.a.Item,{label:"Memo",name:"memo",children:Object(I.jsx)(A.a,{placeholder:"Memo included on-chain (optional)"})}),Object(I.jsx)(L.a.Item,{name:"preferClaimed",label:ee.a._("Mint as ERC-20"),valuePropName:"checked",extra:p?ee.a._("Enabling this will mint {tokenSymbol} ERC-20 tokens. Otherwise, unclaimed {tokenSymbol} tokens will be minted, which can be claimed later as ERC-20 by the receiver.",{tokenSymbol:o}):ee.a._("ERC-20 tokens can only be minted once an ERC-20 token has been issued for this project."),initialValue:!1,children:Object(I.jsx)(Kn.a,{disabled:!p})})]})]})}function ei(){const[e,t]=Object(j.useState)(!1),{theme:{colors:n}}=Object(j.useContext)(u.a),{tokenAddress:o,tokenSymbol:c,isPreviewMode:s,totalTokenSupply:a,fundingCycleMetadata:l,projectId:b,primaryTerminalCurrentOverflow:x,projectMetadata:p,cv:f}=Object(j.useContext)(d.a),{userAddress:y}=Object(j.useContext)(O.a),{data:g}=function(e,t){return Object(m.a)({contract:Object(Nn.a)(e),functionName:"balanceOf",args:t?[t]:null,valueDidChange:lt.b})}(o,y),{data:C}=Mn(),[k,w]=Object(j.useState)(!1),S={width:128},T=o!==ne.a,R=h(v.ISSUE),P=Object(Ve.a)({tokenSymbol:c,capitalize:!1,plural:!0}),{data:E}=dt(y,b),L=Object(G.a)(E,a)||"0",A=!T&&R&&!s,F=Object(G.b)(null!==g&&void 0!==g?g:0,{precision:0}),N=Object(G.b)(null!==C&&void 0!==C?C:0,{precision:0}),B={display:"flex",flexWrap:"wrap",gap:5,justifyContent:"space-between",width:"100%"},M=Boolean(null===x||void 0===x?void 0:x.gt(0)),_=Boolean(h(v.MINT)),H=Boolean(null===l||void 0===l?void 0:l.allowMinting);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(r.b,{direction:"vertical",size:"large",children:Object(I.jsx)(Fn.a,{title:Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(I.jsx)(we.a,{text:Object(I.jsx)(i.b,{id:"Tokens"}),tip:Object(I.jsx)(i.b,{id:"{0} are distributed to anyone who pays this project. If the project has set a funding target, tokens can be redeemed for a portion of the project's overflow whether or not they have been claimed yet.",values:{0:Object(Ve.a)({tokenSymbol:c,capitalize:!0,plural:!0,includeTokenWord:!0})}})}),A&&Object(I.jsx)("div",{style:{marginBottom:20},children:Object(I.jsx)(Bn.a,{useIssueTokensTx:oe,onCompleted:()=>window.location.reload()})})]}),valueRender:()=>Object(I.jsxs)(St.b,{layout:"horizontal",column:1,size:"small",children:[T&&c&&Object(I.jsx)(St.b.Item,{label:ee.a._("Project token"),labelStyle:S,children:Object(I.jsx)("div",{style:B,children:Object(I.jsxs)("div",{children:[c," (",Object(I.jsx)(Fe.a,{address:o}),")"]})})}),Object(I.jsx)(St.b.Item,{label:ee.a._("Total supply"),labelStyle:S,children:Object(I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",width:"100%",gap:5,flexWrap:"wrap"},children:[Object(G.b)(a,{precision:0})," ",P,Object(I.jsx)(D.a,{size:"small",onClick:()=>w(!0),disabled:s,children:Object(I.jsx)(i.b,{id:"Holders"})})]})}),y?Object(I.jsx)(St.b.Item,{label:ee.a._("Your balance"),labelStyle:S,style:{paddingBottom:"0.5rem"},children:Object(I.jsxs)("div",{style:B,children:[Object(I.jsxs)("div",{children:[T&&Object(I.jsxs)("div",{children:[F," ",P]}),Object(I.jsx)("div",{children:T?Object(I.jsx)(i.b,{id:"{unclaimedBalanceFormatted} {tokenText} claimable",values:{unclaimedBalanceFormatted:N,tokenText:P}}):Object(I.jsxs)(I.Fragment,{children:[N," ",P]})}),Object(I.jsx)("div",{style:{cursor:"default",fontSize:"0.8rem",fontWeight:500,color:n.text.tertiary},children:Object(I.jsx)(i.b,{id:"{userOwnershipPercentage}% of total supply",values:{userOwnershipPercentage:L}})})]}),Object(I.jsx)(D.a,{size:"small",onClick:()=>t(!0),disabled:s,children:Object(I.jsx)(i.b,{id:"Manage {tokenText}",values:{tokenText:P}})})]})}):null]})})}),Object(I.jsx)(_n.a,{visible:e,onCancel:()=>t(!1),projectAllowsMint:H,userHasMintPermission:_,hasOverflow:M,tokenSymbol:c,tokenAddress:o,RedeemModal:zn,ClaimTokensModal:Xn,MintModal:Zn}),Object(I.jsx)(Hn.a,{projectId:b,projectName:null===p||void 0===p?void 0:p.name,tokenSymbol:c,tokenAddress:o,cv:f,totalTokenSupply:a,visible:k,onCancel:()=>w(!1)})]})}var ti=n(653),ni=n(390),ii=n(1136),oi=n(392);var ri=n(368),ci=n(654),si=n(667);function ai({visible:e,weiAmount:t,onSuccess:n,onCancel:o}){var c;const{userAddress:s,onSelectWallet:a}=Object(j.useContext)(O.a),{fundingCycle:l,fundingCycleMetadata:u,projectMetadata:b,projectId:x,tokenAddress:p,tokenSymbol:m}=Object(j.useContext)(d.a),v=Object(Bt.a)(),h=function(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({memo:i,preferClaimedTokens:o,beneficiary:r,value:c},s)=>{var a;return e&&n&&null!==t&&void 0!==t&&t.JBETHPaymentTerminal&&r?e(null===t||void 0===t?void 0:t.JBETHPaymentTerminal,"pay",[n,c,X.a,r,0,o,i||"",0],{...s,value:c}):(null===s||void 0===s||null===(a=s.onDone)||void 0===a||a.call(s),Promise.resolve(!1))}}(),[f,g]=Object(j.useState)(),[C,k]=Object(j.useState)(!1),[S,T]=Object(j.useState)(!1),[R,P]=Object(j.useState)(""),[E,D]=Object(j.useState)(),[A]=Object(je.useForm)(),F=v.weiToUsd(t);if(!l||!x||!b)return null;const N=null===u||void 0===u||null===(c=u.reservedRate)||void 0===c?void 0:c.toNumber(),M=Object(w.u)(null===l||void 0===l?void 0:l.weight,N,t,"payer"),_=Object(w.u)(null===l||void 0===l?void 0:l.weight,N,t,"reserved"),H=l?Object(W.a)(l):void 0,V=p&&p!==ne.a;return Object(I.jsx)(B.a,{transactionPending:E,title:ee.a._("Pay {0}",{0:b.name}),visible:e,onOk:async function(){if(!t)return;await A.validateFields();const e=A.getFieldValue("beneficiary"),i=e||s;!s&&a&&a(),g(!0),await h({memo:R,preferClaimedTokens:C,beneficiary:i,value:t},{onConfirmed(){g(!1),D(!1),null===n||void 0===n||n()},onDone(){D(!0)}})||(g(!1),D(!1))},okText:ee.a._("Pay"),connectWalletText:ee.a._("Connect wallet to pay"),onCancel:o,confirmLoading:f,width:640,centered:!0,children:Object(I.jsxs)(r.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(I.jsx)("p",{children:Object(I.jsx)(i.b,{id:"Paying <0>{0}</0> is not an investment \u2014 it's a way to support the project. Any value or utility of the tokens you receive is determined by <1>{1}</1>.",values:{0:b.name,1:b.name},components:{0:Object(I.jsx)("strong",{}),1:Object(I.jsx)("strong",{})}})}),b.payDisclosure&&Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:Object(I.jsx)(i.b,{id:"Notice from {0}:",values:{0:b.name}})}),Object(I.jsx)(ri.a,{description:b.payDisclosure})]}),H&&l?Object(I.jsx)(ci.a,{unsafeProperties:Object(W.d)(l)}):null,Object(I.jsxs)(St.b,{column:1,bordered:!0,children:[Object(I.jsxs)(St.b.Item,{label:ee.a._("Pay amount"),className:"content-right",children:[Object(G.c)(F)," ",Object(q.b)(q.e)," (",Object(G.b)(t)," ",Object(q.b)(q.c),")"]}),Object(I.jsxs)(St.b.Item,{label:ee.a._("{0} for you",{0:Object(Ve.a)({capitalize:!0,plural:!0})}),className:"content-right",children:[Object(I.jsx)("div",{children:Object(G.b)(M,{precision:0})}),Object(I.jsx)("div",{children:s?Object(I.jsx)(i.b,{id:"To: <0/>",components:{0:Object(I.jsx)(Fe.a,{address:s})}}):null})]}),Object(I.jsx)(St.b.Item,{label:ee.a._("{0} reserved",{0:Object(Ve.a)({tokenSymbol:m,capitalize:!0,plural:!0})}),className:"content-right",children:Object(G.b)(_,{precision:0})})]}),Object(I.jsxs)(L.a,{form:A,layout:"vertical",children:[Object(I.jsx)(si.a,{value:R,onChange:P}),Object(I.jsx)(L.a.Item,{children:Object(I.jsx)(oi.a,{text:ee.a._("Add image"),onSuccess:e=>{e&&P(R.length?R+" "+e:e)}})}),Object(I.jsx)(L.a.Item,{label:Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(i.b,{id:"Custom token beneficiary"}),Object(I.jsx)(Kn.a,{checked:S,onChange:T,style:{marginLeft:10}})]}),extra:Object(I.jsx)(i.b,{id:"Mint tokens to a custom address."}),style:{marginBottom:"1rem"}}),S&&Object(I.jsx)(be.a.EthAddress,{defaultValue:void 0,name:"beneficiary",onAddressChange:e=>{A.setFieldsValue({beneficiary:e})},formItemProps:{rules:[{validator:()=>{const e=A.getFieldValue("beneficiary");return e?Object(Qn.isAddress)(e)?Promise.resolve():Promise.reject(ee.a._("Invalid address")):Promise.reject(ee.a._("Address required"))}}]}}),V&&Object(I.jsx)(L.a.Item,{label:ee.a._("Receive ERC-20"),children:Object(I.jsxs)(r.b,{align:"start",children:[Object(I.jsx)(ii.a,{style:{padding:20},checked:C,onChange:e=>k(e.target.checked)}),Object(I.jsx)("label",{htmlFor:"preferClaimed",children:Object(I.jsx)(i.b,{id:"Check this to mint this project's ERC-20 tokens to your wallet. Leave unchecked to have your token balance tracked by Juicebox, saving gas on this transaction. You can always claim your ERC-20 tokens later."})})]})})]})]})})}function li({payAmount:e,payInCurrency:t,onError:n,disabled:o,wrapperStyle:r}){var c;const{projectMetadata:s,fundingCycleMetadata:a,isArchived:l}=Object(j.useContext)(d.a),[u,b]=Object(j.useState)(!1),[O,x]=Object(j.useState)(!1),p=Object(ni.a)({currency:t,amount:e});if(!a)return null;const m=null!==s&&void 0!==s&&null!==(c=s.payButton)&&void 0!==c&&c.length?s.payButton:ee.a._("Pay");let v;l?v=ee.a._("This project is archived and can't be paid."):a.pausePay&&(v=ee.a._("Payments are paused for the current funding cycle."));const h=Boolean(v)||o;return Object(I.jsxs)("div",{style:{textAlign:"center",...r},children:[Object(I.jsx)(pt.a,{visible:!!h&&void 0,title:v,className:"block",children:Object(I.jsx)(D.a,{style:{width:"100%"},type:"primary",onClick:()=>{if(null!==p&&void 0!==p&&p.eq(0))return null===n||void 0===n?void 0:n();x(!0)},disabled:h,children:m})}),t===q.e&&Object(I.jsxs)("div",{style:{fontSize:".7rem"},children:[Object(I.jsx)(i.b,{id:"Paid as <0/>",components:{0:Object(I.jsx)(Ae.a,{currency:"ETH"})}}),Object(G.b)(p)||"0"]}),Object(I.jsx)(ti.a,{visible:O,onOk:()=>{x(!1),b(!0)},onCancel:()=>x(!1)}),Object(I.jsx)(ai,{visible:u,onSuccess:()=>window.location.reload(),onCancel:()=>b(!1),weiAmount:p})]})}var di=n(658),ji=n(1148);function ui(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n}=Object(j.useContext)(d.a);return({value:i},o)=>{var r;return e&&n&&null!==t&&void 0!==t&&t.JBETHPaymentTerminal?e(null===t||void 0===t?void 0:t.JBETHPaymentTerminal,"addToBalanceOf",[n,i,X.a,"",0],{...o,value:i}):(null===o||void 0===o||null===(r=o.onDone)||void 0===r||r.call(o),Promise.resolve(!1))}}function bi(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{projectId:n,projectOwnerAddress:i}=Object(j.useContext)(d.a);return({newOwnerAddress:o},r)=>{var c;return e&&n&&null!==t&&void 0!==t&&t.JBProjects?e(t.JBProjects,"safeTransferFrom(address,address,uint256)",[i,o,n],r):(null===r||void 0===r||null===(c=r.onDone)||void 0===c||c.call(r),Promise.resolve(!1))}}function Oi(){const{transactor:e,contracts:t}=Object(j.useContext)(y.a),{userAddress:n}=Object(j.useContext)(O.a),{projectId:i}=Object(j.useContext)(d.a);return({amount:o,to:r},c)=>{var s;return e&&i&&null!==t&&void 0!==t&&t.JBTokenStore?e(t.JBTokenStore,"transferFrom",[n,i,r,o.toHexString()],c):(null===c||void 0===c||null===(s=c.onDone)||void 0===s||s.call(c),Promise.resolve(!1))}}var xi=n(612);function pi(){const{projectId:e,tokenSymbol:t,projectOwnerAddress:n}=Object(j.useContext)(d.a),{theme:{colors:o}}=Object(j.useContext)(u.a),[r,c]=Object(j.useState)(!1),s=h(v.RECONFIGURE),{data:a}=Mn();return Object(I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(I.jsxs)("span",{style:{color:o.text.tertiary,paddingRight:10},children:[e&&Object(I.jsx)(i.b,{id:"ID: {projectId}",values:{projectId:e}})," ",Object(I.jsx)(pt.a,{title:ee.a._("This project uses the V2 version of the Juicebox contracts."),children:Object(I.jsx)(xi.a,{versionText:"V2"})})]}),Object(I.jsx)(di.a,{visible:r,onClose:()=>c(!1),unclaimedTokenBalance:a,tokenSymbol:t,ownerAddress:n,useTransferProjectOwnershipTx:bi,useTransferUnclaimedTokensTx:Oi,useAddToBalanceTx:ui,useSetProjectUriTx:()=>{},useEditV2ProjectDetailsTx:C,useDeployProjectPayerTx:ie}),Object(I.jsxs)("div",{style:{display:"flex"},children:[Object(I.jsx)(pt.a,{title:ee.a._("Tools"),placement:"bottom",children:Object(I.jsx)(D.a,{onClick:()=>c(!0),icon:Object(I.jsx)(ji.a,{}),type:"text"})}),s&&Object(I.jsx)(Cn,{})]})]})}const mi=40,vi=Object(j.lazy)((()=>Promise.all([n.e(12),n.e(20)]).then(n.bind(null,2847)))),hi=({onClick:e})=>{const{theme:t}=Object(j.useContext)(u.a),n=Object(P.b)(t);return Object(I.jsxs)("span",{style:{...n,cursor:"pointer"},onClick:e,children:[Object(I.jsx)(i.b,{id:"All assets"})," ",Object(I.jsx)(o.a,{})]})};function fi({singleColumnLayout:e,expandFundingCycleCard:t}){const{createdAt:n,projectId:i,projectMetadata:o,fundingCycle:u,fundingCycleMetadata:O,isPreviewMode:x,tokenSymbol:p,tokenAddress:m,cv:y,isArchived:g,projectOwnerAddress:P,handle:D}=Object(j.useContext)(d.a),L=h(v.RECONFIGURE),[A,F]=Object(j.useState)(),{data:N}=f({projectId:i}),[B]=N||[],M=C(),_=Object(k.h)(),H=new URLSearchParams(_.search),V=Boolean(H.get("newDeploy")),U=Object(k.g)(),J=Object(b.a)(),z=h(v.RECONFIGURE),W=Object(S.a)(P),[q,G]=Object(j.useState)(V),[Y,$]=Object(j.useState)(!1),X=e?24:12,K=null===u||void 0===u?void 0:u.number.gt(0),Q=null===B||void 0===B?void 0:B.number.gt(0);if(void 0===i)return null;return Object(I.jsxs)(r.b,{direction:"vertical",size:mi,style:{width:"100%"},children:[K||Q||!L?null:Object(I.jsx)(Z,{}),Object(I.jsx)(l.a,{metadata:o,actions:x?void 0:Object(I.jsx)(pi,{}),isArchived:g,handle:D,onClickSetHandle:W?()=>F(!0):void 0}),!x&&!1===K&&!1===Q&&Object(I.jsx)(R,{}),Object(I.jsxs)(c.a,{gutter:mi,align:"bottom",children:[Object(I.jsxs)(s.a,{md:X,xs:24,children:[Object(I.jsx)(it,{}),Object(I.jsx)("div",{style:{textAlign:"right"},children:Object(I.jsx)(hi,{onClick:()=>$(!0)})})]}),Object(I.jsx)(s.a,{md:X,xs:24,style:{marginTop:mi},children:Object(I.jsx)(a.a,{PayButton:li,reservedRate:null===O||void 0===O?void 0:O.reservedRate.toNumber(),weight:null===u||void 0===u?void 0:u.weight,weightingFn:w.u,tokenSymbol:p,tokenAddress:m,disabled:x||![E.a.MOON_MARS].includes(i)&&!K})})]}),Object(I.jsxs)(c.a,{gutter:mi,children:[Object(I.jsx)(s.a,{md:X,xs:24,children:Object(I.jsxs)(r.b,{direction:"vertical",size:mi,style:{width:"100%"},children:[x?null:Object(I.jsx)(vi,{style:{height:240},createdAt:n,projectId:i,cv:null!==y&&void 0!==y?y:"2"}),Object(I.jsx)(ei,{}),Object(I.jsx)(An,{expandCard:t})]})}),x?null:Object(I.jsx)(s.a,{md:X,xs:24,style:{marginTop:J?mi:0},children:Object(I.jsx)(Je,{})})]}),Object(I.jsx)(me,{visible:q,onClose:()=>{U.replace(Object(T.a)({projectId:i})),G(!1)}}),Object(I.jsx)(ft,{owner:P,projectMetadata:o,projectName:null===o||void 0===o?void 0:o.name,hasEditPermissions:z,visible:Y,onCancel:()=>$(!1),storeCidTx:M}),W&&!D&&Object(I.jsx)(pe,{visible:A,onFinish:()=>F(!1)})]})}},1981:function(e,t,n){"use strict";n.d(t,"a",(function(){return re}));var i=n(7),o=n(1429),r=n(1484),c=n(1428),s=n(3),a=n(106),l=n(90),d=n(0),j=n(13),u=n(361),b=n(208),O=n(261),x=n(359),p=n(1357),m=n(1207),v=n(358),h=n(43),f=n(182),y=n(466),g=n(11),C=n(156),k=n(383),w=n(181),S=n(2848),T=n(1703),I=n(264),R=n(1331),P=n(31),E=n(85),D=n(325),L=n(222),A=n(1704),F=n(1483),N=n(510),B=n(98),M=n(97),_=n(108),H=n(78),V=n(1);function U({visible:e,onClose:t,setDistributionLimit:n,currencyName:o,onCurrencyChange:r}){const[c]=Object(B.useForm)();return Object(V.jsx)(N.a,{visible:e,onCancel:t,title:Object(V.jsx)(H.a,{label:i.a._("Set a distribution limit"),tip:i.a._("This is the maximum amount of funds that can leave the treasury each funding cycle.")}),onOk:function(){c.validateFields(),n(c.getFieldValue("distributionLimit")),t()},children:Object(V.jsx)(a.a,{form:c,children:Object(V.jsx)(M.a,{placeholder:"0",onChange:e=>c.setFieldsValue({distributionLimit:e}),name:"distributionLimit",formItemProps:{rules:[{required:!0}],extra:Object(V.jsx)(H.a,{label:i.a._("Set this to the sum of all your payouts"),tip:Object(V.jsx)(s.b,{id:"Each payout will receive their percent of this total each funding cycle if there is enough in the treasury. Otherwise, they will receive their percent of whatever is in the treasury."})})},min:0,accessory:Object(V.jsx)(_.a,{withArrow:!0,content:o,onClick:()=>{r("ETH"===o?"USD":"ETH")}})})})})}var J=n(274),z=n(339);function W({style:e}){return Object(V.jsxs)(J.a,{header:Object(V.jsx)(s.b,{id:"How do I decide?"}),style:e,children:[Object(V.jsx)("p",{children:Object(V.jsx)(s.b,{id:"Use <0>Amounts</0> when you want to configure a <1>distribution limit</1>. Treasury funds that exceed the distribution limit are called <2>overflow</2>. Token holders can redeem (burn) their tokens for a portion of the overflow. <3>Learn more</3>.",components:{0:Object(V.jsx)("strong",{}),1:Object(V.jsx)("strong",{}),2:Object(V.jsx)("strong",{}),3:Object(V.jsx)(h.a,{href:Object(z.a)("dev/learn/glossary/overflow")})}})}),Object(V.jsx)("p",{children:Object(V.jsx)(s.b,{id:"Use <0>Percentages</0> when you want to configure an <1>infinite distribution limit.</1> With an infinite distribution limit, your project reserves all funds for itself. Your project won't have overflow, so tokens can never be redeemed for ETH. <2>Learn more</2>.",components:{0:Object(V.jsx)("strong",{}),1:Object(V.jsx)("strong",{}),2:Object(V.jsx)(h.a,{href:Object(z.a)("dev/learn/glossary/overflow")})}})})]})}function q({distributionLimit:e,setDistributionLimit:t,currencyName:n,onCurrencyChange:o,editableSplits:r,lockedSplits:c,onSplitsChanged:u,formItemProps:b}){const{theme:{colors:O}}=Object(d.useContext)(j.a),{userAddress:x}=Object(d.useContext)(P.a),p=!e||Object(g.f)(e).eq(f.c),[m,v]=Object(d.useState)(!1),[h,y]=Object(d.useState)(p?"percent":"amount"),[C,k]=Object(d.useState)(!1),N=c.concat(r),B=Object(d.useCallback)(((i,c,s)=>{if(!i)return;const a=0===r.length||1===r.length&&0===c;return Object(V.jsx)(A.a,{split:i,splits:N,distributionLimit:e,setDistributionLimit:t,onSplitsChanged:u,onCurrencyChange:a?o:void 0,currencyName:n,isLocked:s,onSplitDelete:n=>{let i=N;if(!p&&1!==N.length){const o=Object(R.d)({currentDistributionLimit:e,newSplitAmount:0,editingSplitPercent:n.percent}).toString();i=Object(R.a)({splits:r,oldDistributionLimit:e,newDistributionLimit:o}),t(o)}1===N.length&&t("0");const o=Object(D.filter)(i,(e=>e.beneficiary!==n.beneficiary));u(o)}})}),[r,N,e,t,u,o,n,p]);if(Object(d.useEffect)((()=>{y(p?"percent":"amount")}),[p]),!N)return null;const M=Object(R.e)(N)>100,_=100-Object(R.e)(N);let H;function J(){return Object(V.jsx)(A.a,{split:H,splits:N,distributionLimit:e,setDistributionLimit:t,onSplitsChanged:u,onCurrencyChange:o,currencyName:n,isLocked:p,isProjectOwner:!0})}return _&&(H={beneficiary:x,percent:Object(f.t)(_).toNumber()}),Object(V.jsxs)(a.a.Item,{...b,style:{...null===b||void 0===b?void 0:b.style,display:"block",marginBottom:0},children:[Object(V.jsxs)(w.b,{direction:"vertical",style:{width:"100%",minHeight:0},size:"large",children:[Object(V.jsxs)(a.a.Item,{style:{marginBottom:0},children:[Object(V.jsx)("p",{style:{color:O.text.primary},children:Object(V.jsx)(s.b,{id:"Choose how you would like to configure your payouts."})}),Object(V.jsx)(W,{style:{marginBottom:"1rem"}}),Object(V.jsx)(S.a.Group,{onChange:e=>{const n=e.target.value;"percent"===n?(t(Object(g.e)(f.c)),y(n)):"amount"===n&&(r.length?k(!0):(t("0"),y(n)),_&&100!==_&&r.push(H))},value:h,children:Object(V.jsxs)(w.b,{direction:"vertical",children:[Object(V.jsxs)(S.a,{value:"amount",children:[Object(V.jsx)(s.b,{id:"Amounts"}),Object(V.jsx)("p",{style:{fontWeight:400,fontSize:"0.8rem"},children:Object(V.jsx)(s.b,{id:"Distribute a specific amount of funds to entities each funding cycle. Your distribution limit will equal the <0>sum of all payout amounts.</0>",components:{0:Object(V.jsx)("strong",{})}})})]}),Object(V.jsxs)(S.a,{value:"percent",children:[Object(V.jsx)(s.b,{id:"Percentages"}),Object(V.jsx)("p",{style:{fontWeight:400,fontSize:"0.8rem"},children:Object(V.jsx)(s.b,{id:"Distribute a percentage of all funds received to entities. Your distribution limit will be <0>infinite</0>.",components:{0:Object(V.jsx)("strong",{})}})})]})]})})]}),Object(V.jsx)(w.b,{style:{width:"100%"},direction:"vertical",size:"small",children:r.map(((e,t)=>B(e,t)))}),c?Object(V.jsx)(w.b,{style:{width:"100%"},direction:"vertical",size:"small",children:c.map(((e,t)=>B(e,t,!0)))}):null,M?Object(V.jsx)("span",{style:{color:O.text.failure,fontWeight:600},children:Object(V.jsx)(s.b,{id:"Sum of percentages cannot exceed 100%."})}):_>0&&"0"!==e?Object(V.jsx)(J,{}):null,Object(V.jsx)(a.a.Item,{extra:Object(V.jsxs)(w.b,{size:"small",children:[Object(V.jsx)(s.b,{id:"Payouts to Ethereum addresses incur a 2.5% JBX membership fee"}),Object(V.jsx)(I.a,{tip:Object(V.jsx)(s.b,{id:"When distributing, payouts to Ethereum addresses incur a 2.5% JBX membership fee. Payouts to other Juicebox projects don't incur fees. Your project will receive (the <0>JuiceboxDAO</0> token) in return at the current issuance rate.",components:{0:Object(V.jsx)(E.b,{to:Object(L.a)({projectId:1})})}})})]}),children:Object(V.jsx)(l.a,{type:"dashed",onClick:()=>{v(!0)},block:!0,children:Object(V.jsx)(s.b,{id:"Add payout"})})}),Object(V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(V.jsx)("span",{style:{color:O.text.primary},children:Object(V.jsx)(s.b,{id:"Distribution Limit <0/>:",components:{0:Object(V.jsx)(I.a,{tip:i.a._("The maximum amount of funds that can be distributed from the treasury each funding cycle."),placement:"topLeft",iconStyle:{marginRight:5}})}})}),Object(V.jsx)("span",{children:Object(V.jsx)("strong",{children:Object(V.jsx)(T.a,{distributionLimit:Object(g.f)(e),currencyName:n,showTooltip:!0})})})]})]}),Object(V.jsx)(F.a,{visible:m,onSplitsChanged:u,mode:"Add",splits:N,distributionLimit:e,setDistributionLimit:t,currencyName:n,onCurrencyChange:o,onClose:()=>v(!1)}),Object(V.jsx)(U,{visible:C,onClose:()=>k(!1),setDistributionLimit:t,currencyName:n,onCurrencyChange:o})]})}var G=n(152),Y=n(535),$=n(517),X=n.n($),K=n(1269),Q=n(523),Z=n(1132);const ee=["days","hours","minutes","seconds"],te=e=>{switch(e){case"seconds":return i.a._("Seconds");case"hours":return i.a._("Hours");case"minutes":return i.a._("Minutes");default:return i.a._("Days")}};function ne({defaultDurationUnit:e}){return Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsx)(a.a.Item,{name:"duration",label:Object(V.jsx)(s.b,{id:"Funding cycle duration"}),style:{width:"100%"},required:!0,children:Object(V.jsx)(M.a,{placeholder:"30",min:1,style:{paddingRight:15}})}),Object(V.jsx)(a.a.Item,{name:"durationUnit",label:Object(V.jsx)("span",{}),children:Object(V.jsx)(Z.a,{className:"medium",style:{minWidth:125,height:32},defaultValue:e,children:ee.map((e=>Object(V.jsx)(Z.a.Option,{value:e,children:te(e)},e)))})})]})}function ie(){return Object(V.jsx)(J.a,{header:Object(V.jsx)(s.b,{id:"What are automated funding cycles?"}),children:Object(V.jsxs)("div",{children:[Object(V.jsx)("p",{children:Object(V.jsx)(s.b,{id:"Automated funding cycles enable the following characteristics:"})}),Object(V.jsxs)("ol",{style:{marginBottom:0},children:[Object(V.jsx)("li",{children:Object(V.jsx)(s.b,{id:"<0>Recurring funding cycles</0>. For example, distribute funds from your project's treasury every week.",components:{0:Object(V.jsx)("strong",{})}})}),Object(V.jsx)("li",{children:Object(V.jsx)(s.b,{id:"<0>Discount rate</0>, to reduce your project token's issuance rate (tokens per ETH) each funding cycle.",components:{0:Object(V.jsx)("strong",{})}})})]})]})})}function oe({onFormUpdated:e,onFinish:t,isCreate:n}){var i;const{theme:o,theme:{colors:r}}=Object(d.useContext)(j.a),{contracts:c}=Object(d.useContext)(O.a),{payoutSplits:w}=Object(d.useContext)(G.a),S=Object(u.a)(),[T]=a.a.useForm(),{fundAccessConstraints:I,fundingCycleData:P,payoutGroupedSplits:E}=Object(x.a)((e=>e.editingV2Project)),D=Object(m.c)(I),[L,A]=Object(d.useState)([]),[F,N]=Object(d.useState)([]),[B,M]=Object(d.useState)("0"),[_,H]=Object(d.useState)(v.c),[U,J]=Object(d.useState)(!1),W=Object(d.useMemo)((()=>{var e,t;return{durationSeconds:P?P.duration:"0",distributionLimit:null!==(e=null===D||void 0===D?void 0:D.distributionLimit)&&void 0!==e?e:"0",distributionLimitCurrency:parseInt(null!==(t=null===D||void 0===D?void 0:D.distributionLimitCurrency)&&void 0!==t?t:v.c.toString()),payoutSplits:E.splits}}),[P,D,E]),{editableSplits:$,lockedSplits:Z}=Object(d.useMemo)((()=>{var e,t;const i=(new Date).valueOf()/1e3,o=e=>e.lockedUntil&&e.lockedUntil>i&&!n&&(e=>{let t=!1;return null===w||void 0===w||w.forEach((n=>{X()(n,e)&&(t=!0)})),t})(e);return{lockedSplits:null!==(e=null===L||void 0===L?void 0:L.filter((e=>o(e))))&&void 0!==e?e:[],editableSplits:null!==(t=null===L||void 0===L?void 0:L.filter((e=>!o(e))))&&void 0!==t?t:[]}}),[L,n,w]);Object(d.useLayoutEffect)((()=>N($)),[$]);const ee=Object(d.useCallback)((()=>{var e,t;const n=null!==(e=null===D||void 0===D?void 0:D.distributionLimit)&&void 0!==e?e:"0",i=parseInt(null!==(t=null===D||void 0===D?void 0:D.distributionLimitCurrency)&&void 0!==t?t:v.c.toString()),o=P?parseInt(P.duration):0;J(o>0);const r=Object(y.a)(o);T.setFieldsValue({durationUnit:r,duration:Object(y.e)({duration:o,unit:r}).toString()});const c=null===E||void 0===E?void 0:E.splits;M(n),H(i),A(null!==c&&void 0!==c?c:[])}),[T,P,D,E]),te=Object(d.useCallback)((async e=>{var n,i;if(!c)throw new Error("Failed to save funding configuration.");const o={terminal:c.JBETHPaymentTerminal.address,token:K.a,distributionLimit:null!==B&&void 0!==B?B:Object(g.e)(f.c),distributionLimitCurrency:null!==(n=null===_||void 0===_?void 0:_.toString())&&void 0!==n?n:v.c,overflowAllowance:"0",overflowAllowanceCurrency:"0"},r=null!==e&&void 0!==e&&e.duration?parseInt(null===e||void 0===e?void 0:e.duration):0,s=null!==(i=null===e||void 0===e?void 0:e.durationUnit)&&void 0!==i?i:"days",a=Object(y.d)({duration:r,unit:s}).toString();S(b.f.setFundAccessConstraints(o?[o]:[])),S(b.f.setPayoutSplits(Z.concat(F).map(p.a))),S(b.f.setDuration(null!==a&&void 0!==a?a:"0")),a&&"0"!==a||S(b.f.setDiscountRate(b.c.discountRate)),B&&"0"!==B||(S(b.f.setRedemptionRate(b.d.redemptionRate)),S(b.f.setBallotRedemptionRate(b.d.ballotRedemptionRate))),null===t||void 0===t||t()}),[F,Z,c,S,B,_,t]);Object(d.useLayoutEffect)((()=>{ee()}),[ee]);const oe=Object(d.useCallback)((()=>{const t=T.getFieldValue("duration"),n=T.getFieldValue("durationUnit"),i=U?Object(y.d)({duration:t,unit:n}).toString():"0",o=Z.concat(F).map(p.a),r=W.durationSeconds!==i||W.distributionLimit!==B||W.distributionLimitCurrency!==_||!X()(W.payoutSplits,o);null===e||void 0===e||e(r)}),[U,F,T,W,Z,e,_,B]);return Object(d.useEffect)((()=>{oe()}),[oe]),Object(V.jsxs)(a.a,{form:T,onValuesChange:oe,layout:"vertical",onFinish:te,children:[Object(V.jsxs)("div",{style:{padding:"2rem",marginBottom:10,...Object(Q.a)(o),color:r.text.primary},children:[Object(V.jsx)(k.a,{checked:U,onChange:e=>{J(e),e||T.setFieldsValue({duration:"0"}),T.setFieldsValue({duration:f.a.toString()})},style:{marginBottom:"1rem"},children:Object(V.jsx)(s.b,{id:"Automate funding cycles"})}),U?null:Object(V.jsx)(C.a,{children:Object(V.jsx)(s.b,{id:"With no funding cycles, the project's owner can start a new funding cycle (Funding Cycle #2) on-demand. <0>Learn more.</0>",components:{0:Object(V.jsx)(h.a,{href:Object(z.a)("dev/learn/risks")})}})}),U&&Object(V.jsx)(ne,{defaultDurationUnit:T.getFieldValue("durationUnit")}),Object(V.jsx)("div",{children:Object(V.jsx)(ie,{})})]}),Object(V.jsxs)("div",{style:{padding:"2rem",marginBottom:10,...Object(Q.a)(o),color:r.text.primary},children:[Object(V.jsx)("h3",{style:{color:r.text.primary},children:Object(V.jsx)(s.b,{id:"Payouts"})}),Object(V.jsx)(q,{distributionLimit:B,setDistributionLimit:M,currencyName:null!==(i=Object(v.b)(_))&&void 0!==i?i:"ETH",onCurrencyChange:e=>H(Object(v.f)(e)),editableSplits:F,lockedSplits:Z,onSplitsChanged:e=>{N(e),T.setFieldsValue({totalSplitsPercentage:Object(R.e)(e)})}}),Object(V.jsx)(Y.a,{name:"totalSplitsPercentage",rules:[{validator:()=>T.getFieldValue("totalSplitsPercentage")>100?Promise.reject():Promise.resolve()}]})]}),Object(V.jsx)(a.a.Item,{style:{marginTop:"2rem"},children:Object(V.jsx)(l.a,{htmlType:"submit",type:"primary",children:Object(V.jsx)(s.b,{id:"Save funding configuration"})})})]})}function re({visible:e,onClose:t,isCreate:n}){const{handleDrawerCloseClick:s,emitDrawerClose:a,setFormUpdated:l,unsavedChangesModalVisible:d,closeModal:j}=Object(r.a)(t);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(o.a,{title:i.a._("Funding"),visible:e,onClose:s,children:Object(V.jsx)(oe,{onFinish:a,onFormUpdated:l,isCreate:n})}),Object(V.jsx)(c.a,{visible:d,onOk:()=>{j(),a()},onCancel:j})]})}},1982:function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var i=n(3),o=n(7),r=n(363),c=n(1429),s=n(1484),a=n(1428),l=n(106),d=n(181),j=n(90),u=n(13),b=n(361),O=n(359),x=n(0),p=n(73),m=n(1357),v=n(208),h=n(156),f=n(1);function y({hideLabel:e,initialValue:t,reservedTokensSplits:n,onReservedTokensSplitsChange:o,style:r={},onChange:c,issuanceRate:s}){const[a,l]=Object(x.useState)(t),d=!(void 0===a||a.toString()===v.d.reservedRate),[j,u]=Object(x.useState)(d),b=parseInt(v.d.reservedRate);return Object(f.jsxs)("div",{style:r,children:[Object(f.jsx)(p.a.ProjectReserved,{value:a,onChange:e=>{l(e),c(e)},checked:j,onToggled:e=>{u(e),e||(l(b),c(b))},hideLabel:e,issuanceRate:s}),d&&j||n.length?Object(f.jsxs)(f.Fragment,{children:[!d&&Object(f.jsx)(h.a,{children:Object(f.jsx)(i.b,{id:"Reserved rate is 0% but has reserved token allocation. Consider adding a reserved rate that is greater than zero, or remove the token allocation."})}),Object(f.jsx)(p.a.ProjectTicketMods,{mods:n.map((e=>Object(m.b)(e))),onModsChanged:e=>{const t=e.map((e=>Object(m.c)(e)));o(t)},formItemProps:{label:Object(f.jsx)(i.b,{id:"Reserved token allocation (optional)"}),extra:Object(f.jsx)(i.b,{id:"Allocate a portion of your project's reserved tokens to other Ethereum wallets or Juicebox projects."})},reservedRate:null!==a&&void 0!==a?a:0})]}):null]})}var g=n(325),C=n(535),k=n(182),w=n(16),S=n(1207),T=n(383),I=n(196),R=n(11),P=n(631),E=n(526),D=n(1331),L=n(98),A=n(523),F=n(97),N=n(78);function B({value:e,onChange:t,hasDuration:n,isCreate:o}){const{theme:{colors:r}}=Object(x.useContext)(u.a);return Object(f.jsx)("div",{style:{display:"flex"},children:Object(f.jsx)(l.a.Item,{label:Object(f.jsx)(N.a,{label:o?Object(f.jsx)(i.b,{id:"Initial mint rate"}):Object(f.jsx)(i.b,{id:"Mint rate"}),tip:n&&o?Object(f.jsx)(i.b,{id:"The number of project tokens minted when 1 ETH is contributed in the first funding cycle."}):Object(f.jsx)(i.b,{id:"The number of project tokens minted when 1 ETH is contributed."})}),style:{width:"100%"},required:!0,children:Object(f.jsx)(F.a,{min:1,max:k.d,accessory:Object(f.jsx)("span",{style:{color:r.text.primary,marginRight:20},children:Object(f.jsx)(i.b,{id:"tokens per ETH contributed"})}),value:e,onChange:t,style:{paddingRight:15}})})})}function M({hasDuration:e,initialIssuanceRate:t,discountRatePercent:n,isCreate:o}){const{theme:{colors:c}}=Object(x.useContext)(u.a),s=.01*n,a=Object(g.round)(t-t*s,4),l=Object(g.round)(a-a*s,4);return Object(f.jsxs)("div",{style:{fontSize:"0.9rem"},children:[!e&&Object(f.jsx)(h.a,{children:Object(f.jsx)(i.b,{id:"Disabled when your project's funding cycle has no duration."})}),Object(f.jsx)("p",{children:E.a}),n>0&&o&&Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(r.a,{style:{marginTop:20,backgroundColor:c.background.l1},children:[Object(f.jsx)("p",{children:Object(f.jsx)(i.b,{id:"Contributors will receive <0>{discountRatePercent}%</0> more tokens for contributions they make this funding cycle compared to the next funding cycle.",values:{discountRatePercent:n},components:{0:Object(f.jsx)("strong",{})}})}),Object(f.jsx)("p",{children:Object(f.jsx)(i.b,{id:"The <0>issuance rate</0> of your second funding cycle will be <1>{0} tokens per 1 ETH</1>, then <2>{1} tokens per 1 ETH </2>for your third funding cycle, and so on.",values:{0:Object(R.c)(a),1:Object(R.c)(l)},components:{0:Object(f.jsx)("strong",{}),1:Object(f.jsx)("strong",{style:{whiteSpace:"nowrap"}}),2:Object(f.jsx)("strong",{style:{whiteSpace:"nowrap"}})}})})]})})]})}function _({onFormUpdated:e,onFinish:t,isCreate:n}){var o;const{theme:r,theme:{colors:c}}=Object(x.useContext)(u.a),[s]=Object(L.useForm)(),a=Object(b.a)(),{fundingCycleMetadata:h,fundingCycleData:g,reservedTokensGroupedSplits:R,fundAccessConstraints:E}=Object(O.a)((e=>e.editingV2Project)),F=Object(S.c)(E),N=Object(S.e)(F),_=Object(S.f)(g),H=_,V=Object(x.useMemo)((()=>{var e;return{reservedRate:null!==(e=h.reservedRate)&&void 0!==e?e:v.d.reservedRate,discountRate:H&&(null===g||void 0===g?void 0:g.discountRate)||v.c.discountRate,redemptionRate:N&&(null===h||void 0===h?void 0:h.redemptionRate)||v.d.redemptionRate,weight:null!==g&&void 0!==g&&g.weight?Object(k.l)(null===g||void 0===g?void 0:g.weight):k.b.toString()}}),[h.reservedRate,null===h||void 0===h?void 0:h.redemptionRate,H,null===g||void 0===g?void 0:g.discountRate,null===g||void 0===g?void 0:g.weight,N]),[U,J]=Object(x.useState)(V.reservedRate),[z,W]=Object(x.useState)(V.discountRate),[q,G]=Object(x.useState)(V.redemptionRate),[Y,$]=Object(x.useState)(V.weight),[X,K]=Object(x.useState)((null===g||void 0===g?void 0:g.discountRate)!==v.c.discountRate),[Q,Z]=Object(x.useState)((null===h||void 0===h?void 0:h.redemptionRate)!==v.d.redemptionRate),[ee,te]=Object(x.useState)(null===R||void 0===R?void 0:R.splits),ne=Object(x.useCallback)((async()=>{await s.validateFields();const e=ee.map((e=>Object(m.a)(e)));a(v.f.setWeight(Object(k.p)(null!==Y&&void 0!==Y?Y:k.b.toString()))),a(v.f.setDiscountRate(null!==z&&void 0!==z?z:"0")),a(v.f.setReservedRate(null!==U&&void 0!==U?U:"0")),a(v.f.setRedemptionRate(q)),a(v.f.setBallotRedemptionRate(q)),a(v.f.setReservedTokensSplits(e)),null===t||void 0===t||t()}),[a,ee,t,z,Y,U,q,s]);Object(x.useEffect)((()=>{const t=V.reservedRate!==U||V.discountRate!==z||V.redemptionRate!==q;null===e||void 0===e||e(t)}));const ie={color:c.text.tertiary},oe=parseFloat(Object(k.n)(w.a.from(U))),re=parseFloat(Object(k.j)(w.a.from(z))),ce=null!==(o=parseFloat(Y))&&void 0!==o?o:k.b,se=ce-.01*oe*ce;return Object(f.jsx)(l.a,{layout:"vertical",onFinish:ne,form:s,children:Object(f.jsxs)(d.b,{size:"middle",direction:"vertical",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)(B,{value:Y,onChange:e=>{$(null!==e&&void 0!==e?e:k.b.toString())},hasDuration:_,isCreate:Boolean(n)}),Object(f.jsx)(y,{initialValue:oe,onChange:e=>{var t;J(Object(k.s)(null!==(t=null===e||void 0===e?void 0:e.toString())&&void 0!==t?t:"0").toString())},style:{...Object(A.a)(r),padding:25,marginBottom:10},reservedTokensSplits:ee,onReservedTokensSplitsChange:te,issuanceRate:parseInt(Y)}),Object(f.jsx)(l.a.Item,{extra:Object(f.jsx)(M,{hasDuration:H,initialIssuanceRate:se,discountRatePercent:re,isCreate:n}),label:Object(f.jsxs)(T.a,{onChange:e=>{K(e),e||W(v.c.discountRate)},checked:X,disabled:!H,children:[Object(f.jsx)(i.b,{id:"Discount rate"}),!X&&H&&Object(f.jsxs)("span",{style:ie,children:[" ","(",v.c.discountRate,"%)"]})]}),style:{...Object(A.a)(r),padding:25,marginBottom:10},children:H&&X&&Object(f.jsx)(I.a,{max:20,sliderValue:re,suffix:"%",onChange:e=>{var t;return W(Object(k.h)(null!==(t=null===e||void 0===e?void 0:e.toString())&&void 0!==t?t:"0").toString())},step:.1})}),Object(f.jsx)(p.a.ProjectRedemptionRate,{label:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(i.b,{id:"Redemption rate"}),!Q&&N&&Object(f.jsxs)("span",{style:ie,children:[" ","(",P.a,"%)"]})]}),value:Object(k.m)(w.a.from(q)),onChange:e=>{var t;G(Object(k.r)(null!==(t=null===e||void 0===e?void 0:e.toString())&&void 0!==t?t:"0").toString())},style:{...Object(A.a)(r),padding:25,marginBottom:10},onToggled:Z,checked:Q,disabled:!N})]}),Object(f.jsx)(C.a,{name:"totalSplitsPercentage",rules:[{validator:()=>Object(D.e)(ee)>100?Promise.reject("Reserved allocations exceed 100%."):Promise.resolve()}]}),Object(f.jsx)(l.a.Item,{children:Object(f.jsx)(j.a,{htmlType:"submit",type:"primary",children:Object(f.jsx)(i.b,{id:"Save token configuration"})})})]})})}function H({visible:e,onClose:t,isCreate:n}){const{handleDrawerCloseClick:l,emitDrawerClose:d,setFormUpdated:j,unsavedChangesModalVisible:u,closeModal:b}=Object(s.a)(t);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(c.a,{title:o.a._("Project token"),visible:e,onClose:l,children:[Object(f.jsx)("p",{children:Object(f.jsx)(i.b,{id:"Design how your tokens should work."})}),Object(f.jsx)(r.a,{style:{marginBottom:"2rem"},children:Object(f.jsx)(i.b,{id:"Project tokens <0>aren't ERC-20 tokens</0> by default. Once you deploy your project, you can issue an ERC-20 for your holders to claim. This is <1>optional</1>.",components:{0:Object(f.jsx)("strong",{}),1:Object(f.jsx)("strong",{})}})}),Object(f.jsx)(_,{onFinish:d,onFormUpdated:j,isCreate:n})]}),Object(f.jsx)(a.a,{visible:u,onOk:()=>{b(),d()},onCancel:b})]})}},1983:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var i=n(7),o=n(1429),r=n(1484),c=n(1428),s=n(3),a=n(106),l=n(181),d=n(459),j=n(90),u=n(361),b=n(359),O=n(0),x=n(208),p=n(13),m=n(53),v=n(661),h=n(517),f=n.n(h),y=n(523),g=n(382),C=n(279),k=n(519),w=n(156),S=n(1);function T({showMintingWarning:e}){return Object(S.jsxs)(l.b,{direction:"vertical",children:[Object(S.jsx)(s.b,{id:"When enabled, the project owner can manually mint any amount of tokens to any address."}),e&&Object(S.jsx)(w.a,{children:Object(S.jsx)(s.b,{id:"Enabling token minting will appear risky to contributors."})})]})}function I({onFormUpdated:e,onFinish:t}){const{theme:n}=Object(O.useContext)(p.a),i=Object(u.a)(),{fundingCycleMetadata:o,fundingCycleData:r}=Object(b.a)((e=>e.editingV2Project)),c=Object(O.useMemo)((()=>{var e;return{pausePay:o.pausePay,allowMinting:o.allowMinting,ballotStrategy:Object(k.a)(null!==(e=r.ballot)&&void 0!==e?e:g.b.address)}}),[r,o]),[h,w]=Object(O.useState)(!1),[I,R]=Object(O.useState)(c.ballotStrategy),[P,E]=Object(O.useState)(c.pausePay),[D,L]=Object(O.useState)(c.allowMinting);Object(O.useEffect)((()=>{const t=c.allowMinting!==D||c.pausePay!==P||!f()(c.ballotStrategy,I);null===e||void 0===e||e(t)}),[e,c,P,D,I]);const A=Object(O.useCallback)((()=>{i(x.f.setPausePay(P)),i(x.f.setAllowMinting(D)),i(x.f.setBallot(I.address)),null===t||void 0===t||t()}),[i,t,I,P,D]),F={display:"flex",color:n.colors.text.primary,fontWeight:500},N=!I||!Object(m.isAddress)(I.address);return Object(S.jsx)(a.a,{layout:"vertical",onFinish:A,children:Object(S.jsxs)(l.b,{direction:"vertical",size:"large",children:[Object(S.jsxs)("div",{style:{...Object(y.a)(n),padding:"2rem"},children:[Object(S.jsx)(a.a.Item,{extra:Object(S.jsx)(s.b,{id:"When enabled, your project cannot receive direct payments."}),children:Object(S.jsxs)("div",{style:{...F},children:[Object(S.jsx)(d.a,{onChange:E,style:{marginRight:"0.5rem"},checked:P}),Object(S.jsx)(s.b,{id:"Pause payments"})]})}),Object(S.jsx)(a.a.Item,{extra:Object(S.jsx)(T,{showMintingWarning:h}),children:Object(S.jsxs)("div",{style:{...F},children:[Object(S.jsx)(d.a,{onChange:e=>{w(e),L(e)},style:{marginRight:"0.5rem"},checked:D}),Object(S.jsx)(s.b,{id:"Allow token minting"})]})})]}),Object(S.jsx)(a.a.Item,{style:{...Object(y.a)(n),padding:"2rem"},label:Object(S.jsx)(C.a,{children:Object(S.jsx)(s.b,{id:"Reconfiguration rules"})}),children:Object(S.jsx)(v.a,{ballotStrategies:Object(g.d)(),selectedStrategy:I,onChange:R})}),Object(S.jsx)(a.a.Item,{children:Object(S.jsx)(j.a,{htmlType:"submit",type:"primary",disabled:N,children:Object(S.jsx)(s.b,{id:"Save rules"})})})]})})}function R({visible:e,onClose:t}){const{handleDrawerCloseClick:n,emitDrawerClose:s,setFormUpdated:a,unsavedChangesModalVisible:l,closeModal:d}=Object(r.a)(t);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(o.a,{title:i.a._("Rules"),visible:e,onClose:n,children:Object(S.jsx)(I,{onFinish:s,onFormUpdated:a})}),Object(S.jsx)(c.a,{visible:l,onOk:()=>{d(),s()},onCancel:d})]})}},2848:function(e,t,n){"use strict";var i=n(4),o=n(2),r=n(0),c=n(613),s=n(6),a=n.n(s),l=n(166),d=n(52),j=n(151),u=r.createContext(null),b=u.Provider,O=u,x=r.createContext(null),p=x.Provider,m=n(116),v=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},h=function(e,t){var n,s=r.useContext(O),u=r.useContext(x),b=r.useContext(j.b),p=b.getPrefixCls,h=b.direction,f=r.useRef(),y=Object(l.a)(t,f),g=Object(r.useContext)(d.b).isFormItemInput,C=e.prefixCls,k=e.className,w=e.children,S=e.style,T=e.disabled,I=v(e,["prefixCls","className","children","style","disabled"]),R=p("radio",C),P="button"===((null===s||void 0===s?void 0:s.optionType)||u)?"".concat(R,"-button"):R,E=Object(o.a)({},I),D=r.useContext(m.b);E.disabled=T||D,s&&(E.name=s.name,E.onChange=function(t){var n,i;null===(n=e.onChange)||void 0===n||n.call(e,t),null===(i=null===s||void 0===s?void 0:s.onChange)||void 0===i||i.call(s,t)},E.checked=e.value===s.value,E.disabled=E.disabled||s.disabled);var L=a()("".concat(P,"-wrapper"),(n={},Object(i.a)(n,"".concat(P,"-wrapper-checked"),E.checked),Object(i.a)(n,"".concat(P,"-wrapper-disabled"),E.disabled),Object(i.a)(n,"".concat(P,"-wrapper-rtl"),"rtl"===h),Object(i.a)(n,"".concat(P,"-wrapper-in-form-item"),g),n),k);return r.createElement("label",{className:L,style:S,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},r.createElement(c.a,Object(o.a)({},E,{type:"radio",prefixCls:P,ref:y})),void 0!==w?r.createElement("span",null,w):null)},f=r.forwardRef(h);f.displayName="Radio";var y=f,g=n(8),C=n(276),k=n(93);var w=r.forwardRef((function(e,t){var n=r.useContext(j.b),c=n.getPrefixCls,s=n.direction,l=r.useContext(k.b),d=Object(C.a)(e.defaultValue,{value:e.value}),u=Object(g.a)(d,2),O=u[0],x=u[1];return r.createElement(b,{value:{onChange:function(t){var n=O,i=t.target.value;"value"in e||x(i);var o=e.onChange;o&&i!==n&&o(t)},value:O,disabled:e.disabled,name:e.name,optionType:e.optionType}},function(){var n,d=e.prefixCls,j=e.className,u=void 0===j?"":j,b=e.options,x=e.buttonStyle,p=void 0===x?"outline":x,m=e.disabled,v=e.children,h=e.size,f=e.style,g=e.id,C=e.onMouseEnter,k=e.onMouseLeave,w=c("radio",d),S="".concat(w,"-group"),T=v;b&&b.length>0&&(T=b.map((function(e){return"string"===typeof e||"number"===typeof e?r.createElement(y,{key:e.toString(),prefixCls:w,disabled:m,value:e,checked:O===e},e):r.createElement(y,{key:"radio-group-value-options-".concat(e.value),prefixCls:w,disabled:e.disabled||m,value:e.value,checked:O===e.value,style:e.style},e.label)})));var I=h||l,R=a()(S,"".concat(S,"-").concat(p),(n={},Object(i.a)(n,"".concat(S,"-").concat(I),I),Object(i.a)(n,"".concat(S,"-rtl"),"rtl"===s),n),u);return r.createElement("div",Object(o.a)({},function(e){return Object.keys(e).reduce((function(t,n){return!n.startsWith("data-")&&!n.startsWith("aria-")&&"role"!==n||n.startsWith("data-__")||(t[n]=e[n]),t}),{})}(e),{className:R,style:f,onMouseEnter:C,onMouseLeave:k,id:g,ref:t}),T)}())})),S=r.memo(w),T=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},I=function(e,t){var n=r.useContext(j.b).getPrefixCls,i=e.prefixCls,c=T(e,["prefixCls"]),s=n("radio",i);return r.createElement(p,{value:"button"},r.createElement(y,Object(o.a)({prefixCls:s},c,{type:"radio",ref:t})))},R=r.forwardRef(I),P=y;P.Button=R,P.Group=S;t.a=P}}]);
//# sourceMappingURL=13.def72972.chunk.js.map